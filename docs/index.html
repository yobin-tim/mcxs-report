<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yobin Timilsena">

<title>Macroeconometrics Research Report - Estimating the impact of monetary policy shocks on different housing indicators: A Bayesian SVAR Approach</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Macroeconometrics Research Report</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question">Research Question</a></li>
  <li><a href="#data-and-their-properties" id="toc-data-and-their-properties" class="nav-link" data-scroll-target="#data-and-their-properties">Data and their Properties</a>
  <ul class="collapse">
  <li><a href="#empirical-project-setup" id="toc-empirical-project-setup" class="nav-link" data-scroll-target="#empirical-project-setup">Empirical Project Setup</a></li>
  <li><a href="#choice-of-variables" id="toc-choice-of-variables" class="nav-link" data-scroll-target="#choice-of-variables">Choice of variables</a></li>
  <li><a href="#data-properties" id="toc-data-properties" class="nav-link" data-scroll-target="#data-properties">Data Properties</a>
  <ul class="collapse">
  <li><a href="#adf-tests" id="toc-adf-tests" class="nav-link" data-scroll-target="#adf-tests">ADF Tests</a></li>
  <li><a href="#acfpacf-plots" id="toc-acfpacf-plots" class="nav-link" data-scroll-target="#acfpacf-plots">ACF/PACF Plots</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#model-and-hypothesis" id="toc-model-and-hypothesis" class="nav-link" data-scroll-target="#model-and-hypothesis">Model and Hypothesis</a>
  <ul class="collapse">
  <li><a href="#identification" id="toc-identification" class="nav-link" data-scroll-target="#identification">Identification</a></li>
  <li><a href="#baseline-model" id="toc-baseline-model" class="nav-link" data-scroll-target="#baseline-model">Baseline Model</a>
  <ul class="collapse">
  <li><a href="#prior-distribution" id="toc-prior-distribution" class="nav-link" data-scroll-target="#prior-distribution">Prior distribution</a></li>
  <li><a href="#likelihood-function" id="toc-likelihood-function" class="nav-link" data-scroll-target="#likelihood-function">Likelihood Function</a></li>
  <li><a href="#posterior-distribution" id="toc-posterior-distribution" class="nav-link" data-scroll-target="#posterior-distribution">Posterior Distribution</a></li>
  <li><a href="#gibbs-sampling" id="toc-gibbs-sampling" class="nav-link" data-scroll-target="#gibbs-sampling">(Gibbs) Sampling</a></li>
  <li><a href="#simulation-run" id="toc-simulation-run" class="nav-link" data-scroll-target="#simulation-run">Simulation Run</a></li>
  <li><a href="#data-results" id="toc-data-results" class="nav-link" data-scroll-target="#data-results">Data Results</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#extended-model" id="toc-extended-model" class="nav-link" data-scroll-target="#extended-model">Extended Model</a>
  <ul class="collapse">
  <li><a href="#analysis-of-priors" id="toc-analysis-of-priors" class="nav-link" data-scroll-target="#analysis-of-priors">Analysis of priors</a></li>
  <li><a href="#extension-1-normal-gamma-prior-hyperparameter-estimation" id="toc-extension-1-normal-gamma-prior-hyperparameter-estimation" class="nav-link" data-scroll-target="#extension-1-normal-gamma-prior-hyperparameter-estimation">Extension 1: Normal-Gamma Prior Hyperparameter Estimation</a>
  <ul class="collapse">
  <li><a href="#prior-distribution-1" id="toc-prior-distribution-1" class="nav-link" data-scroll-target="#prior-distribution-1">Prior Distribution</a></li>
  <li><a href="#posterior-distribution-1" id="toc-posterior-distribution-1" class="nav-link" data-scroll-target="#posterior-distribution-1">Posterior Distribution</a></li>
  <li><a href="#gibbs-sampling-1" id="toc-gibbs-sampling-1" class="nav-link" data-scroll-target="#gibbs-sampling-1">(Gibbs) Sampling</a></li>
  <li><a href="#simulation-run-1" id="toc-simulation-run-1" class="nav-link" data-scroll-target="#simulation-run-1">Simulation Run</a></li>
  <li><a href="#data-results-1" id="toc-data-results-1" class="nav-link" data-scroll-target="#data-results-1">Data Results</a></li>
  </ul></li>
  <li><a href="#extension-2-inverse-normal-gamma-prior-hyperparameter-estimation" id="toc-extension-2-inverse-normal-gamma-prior-hyperparameter-estimation" class="nav-link" data-scroll-target="#extension-2-inverse-normal-gamma-prior-hyperparameter-estimation">Extension 2: Inverse Normal Gamma Prior Hyperparameter Estimation</a>
  <ul class="collapse">
  <li><a href="#prior-distribution-2" id="toc-prior-distribution-2" class="nav-link" data-scroll-target="#prior-distribution-2">Prior Distribution</a></li>
  <li><a href="#posterior-distribution-2" id="toc-posterior-distribution-2" class="nav-link" data-scroll-target="#posterior-distribution-2">Posterior Distribution</a></li>
  <li><a href="#gibbs-sampling-2" id="toc-gibbs-sampling-2" class="nav-link" data-scroll-target="#gibbs-sampling-2">(Gibbs) Sampling</a></li>
  <li><a href="#simulation-run-2" id="toc-simulation-run-2" class="nav-link" data-scroll-target="#simulation-run-2">Simulation Run</a></li>
  <li><a href="#data-results-2" id="toc-data-results-2" class="nav-link" data-scroll-target="#data-results-2">Data Results</a></li>
  </ul></li>
  <li><a href="#extension-3-stochastic-volatility" id="toc-extension-3-stochastic-volatility" class="nav-link" data-scroll-target="#extension-3-stochastic-volatility">Extension 3: Stochastic Volatility</a>
  <ul class="collapse">
  <li><a href="#gibbs-sampling-3" id="toc-gibbs-sampling-3" class="nav-link" data-scroll-target="#gibbs-sampling-3">(Gibbs) Sampling</a></li>
  <li><a href="#data-results-3" id="toc-data-results-3" class="nav-link" data-scroll-target="#data-results-3">Data Results</a></li>
  </ul></li>
  <li><a href="#analysis-of-posteriors" id="toc-analysis-of-posteriors" class="nav-link" data-scroll-target="#analysis-of-posteriors">Analysis of Posteriors</a></li>
  </ul></li>
  <li><a href="#empirical-investigation" id="toc-empirical-investigation" class="nav-link" data-scroll-target="#empirical-investigation">Empirical Investigation</a>
  <ul class="collapse">
  <li><a href="#baseline-model-1" id="toc-baseline-model-1" class="nav-link" data-scroll-target="#baseline-model-1">Baseline Model</a>
  <ul class="collapse">
  <li><a href="#impulse-response-functions-irfs" id="toc-impulse-response-functions-irfs" class="nav-link" data-scroll-target="#impulse-response-functions-irfs">Impulse Response Functions (IRFs)</a></li>
  <li><a href="#forecast-error-variance-decomposition" id="toc-forecast-error-variance-decomposition" class="nav-link" data-scroll-target="#forecast-error-variance-decomposition">Forecast Error Variance Decomposition</a></li>
  </ul></li>
  <li><a href="#extension-1-normal-gamma-hyperparameter-prior" id="toc-extension-1-normal-gamma-hyperparameter-prior" class="nav-link" data-scroll-target="#extension-1-normal-gamma-hyperparameter-prior">Extension 1: Normal-Gamma Hyperparameter Prior</a>
  <ul class="collapse">
  <li><a href="#impulse-response-functions" id="toc-impulse-response-functions" class="nav-link" data-scroll-target="#impulse-response-functions">Impulse Response Functions</a></li>
  <li><a href="#forecast-error-variance-decomposition-1" id="toc-forecast-error-variance-decomposition-1" class="nav-link" data-scroll-target="#forecast-error-variance-decomposition-1">Forecast Error Variance Decomposition</a></li>
  </ul></li>
  <li><a href="#extension-2-inverse-normal-gamma-2-prior" id="toc-extension-2-inverse-normal-gamma-2-prior" class="nav-link" data-scroll-target="#extension-2-inverse-normal-gamma-2-prior">Extension 2: Inverse Normal Gamma 2 Prior</a>
  <ul class="collapse">
  <li><a href="#impulse-response-functions-1" id="toc-impulse-response-functions-1" class="nav-link" data-scroll-target="#impulse-response-functions-1">Impulse Response Functions</a></li>
  <li><a href="#forecast-error-variance-decomposition-2" id="toc-forecast-error-variance-decomposition-2" class="nav-link" data-scroll-target="#forecast-error-variance-decomposition-2">Forecast Error Variance Decomposition</a></li>
  </ul></li>
  <li><a href="#extension-3-normal-gamma-prior-with-stochastic-volatility" id="toc-extension-3-normal-gamma-prior-with-stochastic-volatility" class="nav-link" data-scroll-target="#extension-3-normal-gamma-prior-with-stochastic-volatility">Extension 3: Normal Gamma Prior with Stochastic Volatility</a>
  <ul class="collapse">
  <li><a href="#impulse-response-functions-2" id="toc-impulse-response-functions-2" class="nav-link" data-scroll-target="#impulse-response-functions-2">Impulse Response Functions</a></li>
  <li><a href="#forecast-error-variance-decomposition-3" id="toc-forecast-error-variance-decomposition-3" class="nav-link" data-scroll-target="#forecast-error-variance-decomposition-3">Forecast Error Variance Decomposition</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a>
  <ul class="collapse">
  <li><a href="#baseline-model-2" id="toc-baseline-model-2" class="nav-link" data-scroll-target="#baseline-model-2">Baseline Model</a>
  <ul class="collapse">
  <li><a href="#forecast-error-variance-decomposition-fevd" id="toc-forecast-error-variance-decomposition-fevd" class="nav-link" data-scroll-target="#forecast-error-variance-decomposition-fevd">Forecast Error Variance Decomposition (FEVD)</a></li>
  <li><a href="#extended-model-1" id="toc-extended-model-1" class="nav-link" data-scroll-target="#extended-model-1">Extended Model</a></li>
  <li><a href="#extension-2" id="toc-extension-2" class="nav-link" data-scroll-target="#extension-2">Extension 2</a></li>
  <li><a href="#extension-3" id="toc-extension-3" class="nav-link" data-scroll-target="#extension-3">Extension 3</a></li>
  </ul></li>
  <li><a href="#code-snippets" id="toc-code-snippets" class="nav-link" data-scroll-target="#code-snippets">Code Snippets</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Estimating the impact of monetary policy shocks on different housing indicators: A Bayesian SVAR Approach</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Yobin Timilsena </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<blockquote class="blockquote">
<p><strong>Abstract.</strong> This project uses a Bayesian SVAR approach to estimate the effects of domestic and foreign monetary policy shocks on housing prices and the level of new housing construction in Australia. The identification relies on imposing exclusion-restrictions and the estimation process follows the <span class="citation" data-cites="waggoner2003a">D. F. Waggoner and Zha (<a href="#ref-waggoner2003a" role="doc-biblioref">2003</a>)</span> algorithm using the Gibbs sampler. I build three extensions of the baseline model – in the first two, I impose different types of hyperparameter prior distributions and estimate the hyperparameters of the priors of the model, while I incorporate common stochastic volatility in the third extension. I find that a positive domestic monetary policy shock reduces both the number of new houses and housing prices, while a positive foreign (US) monetary policy shock reduces the number of new houses but increases housing prices.</p>
<p><strong>Keywords.</strong> bsvars, impulse responses, quarto, R, housing price index, monetary policy shocks, stochastic volatility, normal-gamma mixture prior, normal-inverse gamma prior.</p>
</blockquote>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Monetary policy is one of the key instruments used by central banks to influence overall economic activity. In recent years, the housing market has become an increasingly important channel through which monetary policy affects the broader economy (<span class="citation" data-cites="AK_2017">Aliber and Kindleberger (<a href="#ref-AK_2017" role="doc-biblioref">2017</a>)</span>), particularly in Australia where around 57% of household wealth is tied up in the housing market (<span class="citation" data-cites="Sweeney_2023">Sweeney (<a href="#ref-Sweeney_2023" role="doc-biblioref">2023</a>)</span>). That number is thrice as big as the size of the super market in Australia and as such, understanding the relationship between monetary policy shocks and the housing market is crucial for policy-makers, investors, and households alike.</p>
<p>In this study, I aim to estimate the impact of monetary policy shocks on various housing indicators using a Structural Vector Autoregressive (SVAR) modelling approach with identification achieved through imposing exclusion restrictions. SVAR models are a popular econometric tool for investigating the dynamic interactions between macroeconomic variables. By applying this approach, I shed light on how changes in monetary policy impact different dimensions of the housing market. In particular, I find that a positive 25 basis point increase in the Australian Cash Rate reduces both the number of new houses and housing prices over the long run, while a positive foreign (US) monetary policy shock reduces the number of new houses but increases housing prices.</p>
</section>
<section id="research-question" class="level1">
<h1>Research Question</h1>
<p>The objective of this paper is to estimate and quantify the impact of monetary policy shocks on different indicators of the housing market such as housing prices, housing transactions/sales, and home loan rates within an economy. Understanding these effects is crucial in understanding how money affects a key factor of the real side of the economy. I formulate this question within a SVAR framework and make use of <span class="citation" data-cites="waggoner2003a">D. F. Waggoner and Zha (<a href="#ref-waggoner2003a" role="doc-biblioref">2003</a>)</span> algorithm to sample for posterior draws of the coefficient matrices. I further extend the model using common parameterisation of hierarchical priors and incorporating stochastic volatility, and estimate the model for better accuracy.</p>
</section>
<section id="data-and-their-properties" class="level1">
<h1>Data and their Properties</h1>
<section id="empirical-project-setup" class="level2">
<h2 class="anchored" data-anchor-id="empirical-project-setup">Empirical Project Setup</h2>
<p>This project website is being developed as a <strong>Quarto</strong> document and the empirical work in conducted using <code>R</code>. The necessary datasets are imported from the Reserve Bank of Australia (RBA) and the Australian Bureau of Statistics (ABS) websites using <code>readrba</code> and <code>readabs</code> respectively.</p>
</section>
<section id="choice-of-variables" class="level2">
<h2 class="anchored" data-anchor-id="choice-of-variables">Choice of variables</h2>
<p>I use the following variables to answer this question. I discuss the relevance of each variable.</p>
<ul>
<li><p><span class="math inline">\(\log(M1)\)</span>: represents the log of the money supply M1. Both conventional and unconventional monetary policy shocks can change the stock of money supply and its size affects real variables of the economy.</p></li>
<li><p><span class="math inline">\(\Delta CPI\)</span>: represents the year-on-year change in the Consumer Price Index (CPI). It is a measure of inflation in an economy and is affected by monetary policy shocks.</p></li>
<li><p><span class="math inline">\(\log(c)\)</span>: represents the log of consumption of the economy. Monetary policy shocks can alter people’s consumption-savings behaviour.</p></li>
<li><p><span class="math inline">\(\log(GDP)\)</span>: represents the log of the Gross Domestic Product (GDP). Including this along with the consumption helps differentiate the effect on the non-consumption aspect of the economy.</p></li>
<li><p><span class="math inline">\(loanrate\)</span>: represents the weighted average interest rates on owner-occupied home loans. This serves as a proxy for borrowing costs for households who save in the form of housing wealth.</p></li>
<li><p><span class="math inline">\(AUCR\)</span>: represents the Australian Cash Rate Target. This is the major monetary policy instrument available to the RBA.</p></li>
<li><p><span class="math inline">\(USFFR\)</span>: represents the Federal Funds Rate Maximum Target Rate. Monetary policy adopted in the US tend to ripple into other economies so this is a variable of interest. Another extension to this variable would be to include the Target rates of Australia’s largest trading partners.</p></li>
<li><p><span class="math inline">\(nhouses\)</span>: represents the number of new private dwellings (houses) approved for construction in Australia. Impact on housing prices might be dampened by the supply elasticity of housing captured by this variable. Moreover, macroeconomic conditions may determine the level of new construction projects undertaken domestically.</p></li>
<li><p><span class="math inline">\(PPI\)</span>: represents the Property Price Index in Australia. The index is normalized with respect to the property prices in 2011-2012 (=100). Tracking the effect of monetary policy on housing prices is a key object of interest.</p></li>
</ul>
<div class="cell">

</div>
<div class="cell">

</div>
<p>Below is a preview of the dataset used in this project.</p>
<div class="cell">
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["US FFR Max Target Rate"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["Nominal GDP (log)"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Aggregate Consumption (log)"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["% Change in CPI, yoy"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["RBA Target Cash Rate"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["M1 Money Supply (logs)"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Owner-occupied home loan rates"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Quantity of new homes (log)"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["House Price Index (log)"],"name":[9],"type":["dbl"],"align":["right"]}],"data":[{"1":"1.00","2":"5.319506","3":"5.115458","4":"2.6","5":"4.75","6":"5.430656","7":"6.57","8":"2.352517","9":"4.234107","_rn_":"2003 Q3"},{"1":"1.00","2":"5.342860","3":"5.128626","4":"2.4","5":"5.25","6":"5.464315","7":"7.07","8":"2.340940","9":"4.271095","_rn_":"2003 Q4"},{"1":"1.00","2":"5.367657","3":"5.151394","4":"2.0","5":"5.25","6":"5.453285","7":"7.07","8":"2.303784","9":"4.266896","_rn_":"2004 Q1"},{"1":"1.25","2":"5.386566","3":"5.170967","4":"2.5","5":"5.25","6":"5.487027","7":"7.07","8":"2.243790","9":"4.257030","_rn_":"2004 Q2"},{"1":"1.75","2":"5.401546","3":"5.176805","4":"2.3","5":"5.25","6":"5.496254","7":"7.07","8":"2.185827","9":"4.257030","_rn_":"2004 Q3"},{"1":"2.25","2":"5.416167","3":"5.188430","4":"2.5","5":"5.25","6":"5.529913","7":"7.07","8":"2.187062","9":"4.273884","_rn_":"2004 Q4"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">

</div>
</section>
<section id="data-properties" class="level2">
<h2 class="anchored" data-anchor-id="data-properties">Data Properties</h2>
<p>The dataset consists quarterly data from 2003 Q3 to 2021 Q4. The variables discussed above are illustrated in the figure below. Note that the logged variables trend upwards because they are expressed in their levels, while variables expressed in percentage change terms do not exhibit this behaviour.</p>
<div class="cell fig-cap-location-top">
<div class="cell-output-display">
<div id="fig-dataplot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-dataplot-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: Summary of variables</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">

</div>
<section id="adf-tests" class="level3">
<h3 class="anchored" data-anchor-id="adf-tests">ADF Tests</h3>
<p>I perform and display augmented Dickey-Fuller (ADF) test results on the variables. This test determines the order of integration of our variables. The null hypothesis of the test is that a selection set of time-series observations exhibit unit-root non-stationarity.</p>
<p>I report, for each variable, the difference level at which the ADF tests rejects the null that the series is non-stationary. It can be seen that most variables exhibit an order of integration 1. The variable for foreign monetary policy rate (the US Federal Funds rate) exhibits an order of integration 2 whereas house prices exhibits integration of order 0.</p>
<p>SVAR models generally incorporate an AR structure with multiple lags, so variables with lower orders of integration can be used as-is with these models.</p>
<div class="cell">
<details>
<summary>Code: ADF Tests</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>perform_adf_tests <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create an empty dataframe to store the results</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Variable =</span> <span class="fu">character</span>(), <span class="at">TestType =</span> <span class="fu">character</span>(), </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">TestStatistic =</span> <span class="fu">numeric</span>(), <span class="at">PValue =</span> <span class="fu">numeric</span>(), </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterate over each column in the dataframe</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (col <span class="cf">in</span> <span class="fu">colnames</span>(df)) {</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove NA values from the column</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    column_data <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(df[[col]])</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Perform ADF test for levels</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    adf_levels <span class="ot">&lt;-</span> tseries<span class="sc">::</span><span class="fu">adf.test</span>(<span class="fu">na.omit</span>(column_data), <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Check if p-value is less than or equal to 0.05</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (adf_levels<span class="sc">$</span>p.value <span class="sc">&lt;=</span> <span class="fl">0.05</span>) {</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>      results <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">data.frame</span>(<span class="at">Variable =</span> col, <span class="at">TestType =</span> <span class="st">"Levels"</span>, </span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">TestStatistic =</span> adf_levels<span class="sc">$</span>statistic,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">PValue =</span> adf_levels<span class="sc">$</span>p.value)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Perform ADF test for first difference</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>      adf_diff1 <span class="ot">&lt;-</span> tseries<span class="sc">::</span><span class="fu">adf.test</span>(<span class="fu">na.omit</span>(<span class="fu">diff</span>(column_data)), <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Check if p-value is less than 0.05</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (adf_diff1<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        results <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>          <span class="fu">data.frame</span>(<span class="at">Variable =</span> col, <span class="at">TestType =</span> <span class="st">"First Difference"</span>, </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>                     <span class="at">TestStatistic =</span> adf_diff1<span class="sc">$</span>statistic,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>                     <span class="at">PValue =</span> adf_diff1<span class="sc">$</span>p.value)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Perform ADF test for second difference</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        adf_diff2 <span class="ot">&lt;-</span> tseries<span class="sc">::</span><span class="fu">adf.test</span>(<span class="fu">na.omit</span>(<span class="fu">diff</span>(column_data, <span class="at">differences =</span> <span class="dv">2</span>)), <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>        results <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results,</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>            <span class="fu">data.frame</span>(<span class="at">Variable =</span> col, <span class="at">TestType =</span> <span class="st">"Second Difference"</span>, </span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>                       <span class="at">TestStatistic =</span> adf_diff2<span class="sc">$</span>statistic,</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>                       <span class="at">PValue =</span> adf_diff2<span class="sc">$</span>p.value)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return the results dataframe</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>adf_test_results <span class="ot">&lt;-</span> <span class="fu">perform_adf_tests</span>(df)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">paged_table</span>(adf_test_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Variable"],"name":[1],"type":["chr"],"align":["left"]},{"label":["TestType"],"name":[2],"type":["chr"],"align":["left"]},{"label":["TestStatistic"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["PValue"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"US FFR Max Target Rate","2":"Second Difference","3":"-4.029469","4":"0.01334623","_rn_":"Dickey-Fuller...1"},{"1":"Nominal GDP (log)","2":"First Difference","3":"-4.009039","4":"0.01417695","_rn_":"Dickey-Fuller...2"},{"1":"Aggregate Consumption (log)","2":"First Difference","3":"-4.558309","4":"0.01000000","_rn_":"Dickey-Fuller...3"},{"1":"% Change in CPI, yoy","2":"First Difference","3":"-4.630043","4":"0.01000000","_rn_":"Dickey-Fuller...4"},{"1":"RBA Target Cash Rate","2":"First Difference","3":"-4.021322","4":"0.01362264","_rn_":"Dickey-Fuller...5"},{"1":"M1 Money Supply (logs)","2":"First Difference","3":"-3.648050","4":"0.03540095","_rn_":"Dickey-Fuller...6"},{"1":"Owner-occupied home loan rates","2":"First Difference","3":"-4.061076","4":"0.01182868","_rn_":"Dickey-Fuller...7"},{"1":"Quantity of new homes (log)","2":"First Difference","3":"-3.858576","4":"0.02096680","_rn_":"Dickey-Fuller...8"},{"1":"House Price Index (log)","2":"Levels","3":"-3.622828","4":"0.03746317","_rn_":"Dickey-Fuller...9"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">

</div>
</section>
<section id="acfpacf-plots" class="level3">
<h3 class="anchored" data-anchor-id="acfpacf-plots">ACF/PACF Plots</h3>
<p>Next, I display the Autocorrelation Function (ACF) and Partial Autocorrelation Function (PACF) plots for our selection of variables below.</p>
<p>The Autocorrelation Function (ACF) measures the correlation between a time series and its lagged values. It calculates the correlation coefficient between the time series and its lagged values at different lags. The ACF helps identify the presence of any significant autocorrelation in the data, indicating the degree of dependence between observations at different time points. ACF can help identify long-term trends and seasonality in the time series by examining the pattern of autocorrelation at different lags.</p>
<p>The Partial Autocorrelation Function (PACF) measures the correlation between a time series and its lagged values, controlling for the intermediate lags. PACF is particularly useful for identifying the order of the autoregressive (AR) process in time series modeling, as it helps identify the lagged values that have a direct and significant influence on the current value.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/ACF-Plots-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">ACF Plots</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">

</div>
<div class="cell fig-cap-location-top">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/PACF-Plots-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">PACF Plots</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">

</div>
<p>The ACF plots for most variables show a gradually decreasing positive autocorrelation over time. The ACF for USFFR implies that policy decision reverse after about 10 quarters. The ACF for change in CPI and quantity of new both both indicate the presence of cycles in the data.</p>
<p>The PACF plots generally indicate that the first lag is really important in explaining the dynamics of the variables in our dataset.</p>
</section>
</section>
</section>
<section id="model-and-hypothesis" class="level1">
<h1>Model and Hypothesis</h1>
<p>I employ a structural VAR model to assess the impact of monetary policy shocks on different housing indicators. The SVAR model with <span class="math inline">\(p\)</span> lags can be written as <span class="math display">\[
\begin{align}
&amp;B_0Y_t = B_0 + B_1 Y_{t-1} + \dots + B_p Y_{t-p} + U_t\\
&amp;U_{t}| Y_{t-1} \dots Y_{t-p} \sim _{iid} ( 0_N, I_N)
\end{align}
\]</span> where <span class="math display">\[
Y_t =
            \begin{pmatrix}
                USFFR_t\\
                \log(GDP_t)\\
                \log(c_t)\\
                \Delta CPI_t\\
                AUCR_t\\
                \log(q_{\text{new homes}_t})\\
                \log(HPI_t)\\
                i_{\text{home loan}_t}\\
                \log(M1_t)
            \end{pmatrix}
\]</span></p>
<p><span class="math inline">\(B_0\)</span> is a <strong>structural matrix </strong> that captures the contemporaneous relationship between the variables in <span class="math inline">\(Y_t\)</span>. <span class="math inline">\(U_t\)</span> represents conditionally independent <strong>structural shocks</strong>.</p>
<p>In many cases, the structural model can be estimated utilizing the information from its corresponding RF model <span class="math display">\[
\begin{align}
&amp;Y_t = A_0 + A_1 Y_{t-1} + \dots + A_p Y_{t-p} + E_t\\
&amp;E_{t}| Y_{t-1} \dots Y_{t-p} \sim _{iid} ( 0_N, \Sigma)
\end{align}
\]</span> where <span class="math inline">\(A_i = B_0^{-1}B_i\)</span> and <span class="math inline">\(B_0^{-1}I_N (B_0^{-1})'\)</span>.</p>
<p>The identification in the SVAR model can be achieved either by using some exclusion restrictions, sign restrictions, instrumental variables, or prior distribution. The next section will talk about the exact composition of the structural matrix and the conditions for identification.</p>
<section id="identification" class="level2">
<h2 class="anchored" data-anchor-id="identification">Identification</h2>
<p>I plan to use exclusion-restrictions to identify the structural matrix <span class="math inline">\(B_0\)</span> using the structural form equation. In particular, I will impose a lower-triangular restriction on <span class="math inline">\(B_0\)</span> and employ the solution concept in <span class="citation" data-cites="waggoner2003b">D. Waggoner and Zha (<a href="#ref-waggoner2003b" role="doc-biblioref">2003</a>)</span> who use a normalization rule as an optimal solution to the local identification problem. I will then employ the Gibbs sampler for a SVAR model with exclusion restrictions as in <span class="citation" data-cites="waggoner2003a">D. F. Waggoner and Zha (<a href="#ref-waggoner2003a" role="doc-biblioref">2003</a>)</span> to obtain draws for <span class="math inline">\(B_0\)</span> and <span class="math inline">\(B_+\)</span>.</p>
<p>The structural form model, in matrix form, can be expressed as follows</p>
<p><span class="math display">\[ B_0 Y = B_+ X + U, \qquad \qquad U|X \sim \mathcal{MN}_{N \times T}(\textbf{0}_{N \times T}, I_T, I_N) \]</span> where</p>
<p><span class="math inline">\(B_0\)</span> is a <span class="math inline">\(N \times N\)</span> contemporaneous effects matrix.</p>
<p><span class="math inline">\(Y = [y_1, \dots, y_T]\)</span> is a <span class="math inline">\(N \times T\)</span> matrix of observations.</p>
<p><span class="math inline">\(B_+ = [B_d, B_1, \dots, B_p]\)</span> is a <span class="math inline">\(N \times K\)</span> matrix of autoregressive parameters, where <span class="math inline">\(K = Np + d\)</span> (<span class="math inline">\(d\)</span> is the number of deterministic terms; <span class="math inline">\(p\)</span> is the number of lags).</p>
<p><span class="math inline">\(X = [x_1, \dots, x_T]\)</span> is a <span class="math inline">\(K \times T\)</span> matrix of lagged observations where each <span class="math inline">\(x_t = (1, y_{t-1}, \dots, y_{t-p})'\)</span>.</p>
<p><span class="math inline">\(U = [u_1, \dots, u_T]\)</span> is a <span class="math inline">\(N \times T\)</span> matrix of structural shocks.</p>
<p>For convenience of coding and inference purposes, we consider a row-wise equation form as follows: <span class="math display">\[ B_{0[n.\cdot]} Y = B_{+n} X + U_n, \qquad \qquad U_n|X \sim \mathcal{N}(\mathbf{0}_T, I_T) \]</span></p>
<p>If <span class="math inline">\(r_n\)</span> denotes the number of elements in the <span class="math inline">\(n^{th}\)</span> row of <span class="math inline">\(B_0\)</span> that stay unrestricted, then we can further decompose <span class="math inline">\(B_{0[n.\cdot]}\)</span> into <span class="math inline">\(b_n\)</span> and <span class="math inline">\(V_n\)</span>.</p>
<p><span class="math inline">\(b_n\)</span> is a <span class="math inline">\(1 \times r_n\)</span> vector of unrestricted elements in the <span class="math inline">\(n^{th}\)</span> row of <span class="math inline">\(B_0\)</span>.</p>
<p><span class="math inline">\(V_n\)</span> is a <span class="math inline">\(r_n \times N\)</span> matrix which places elements of <span class="math inline">\(b_n\)</span> in the appropriate positions to impose the restrictions on <span class="math inline">\(B_0\)</span>.</p>
<p>Then, the row-wise equation form can be written as follows: <span class="math display">\[ b_n V_n Y = B_{+n} X + U_n, \qquad \qquad U_n|X \sim \mathcal{N}(\mathbf{0}_T, I_T) \]</span> Following <span class="citation" data-cites="waggoner2003a">D. F. Waggoner and Zha (<a href="#ref-waggoner2003a" role="doc-biblioref">2003</a>)</span> and <span class="citation" data-cites="arias2018a">Arias, Rubio‐Ramírez, and Waggoner (<a href="#ref-arias2018a" role="doc-biblioref">2018</a>)</span>, we define that <span class="math inline">\((B_+, B_0)\)</span> follow jointly a Normal-Generalised Normal (NGN) distribution denoted as <span class="math display">\[ p(B_+, B_0) \sim \mathcal{NGN}(B, \Omega, S, \nu)\]</span></p>
<p>if <span class="math inline">\(B_{+n}\)</span> follows a K-variate normal distribution given <span class="math inline">\(b_n\)</span> <span class="math display">\[ p(B_{+n}|b_n) = \mathcal{N}_k(b_nV_nB, \Omega) \]</span> with kernel <span class="math display">\[ p(B_{+n}|b_n) \propto \exp \left\{  -\frac{1}{2} \left( B_{+n} - b_nV_nB \right) \Omega^{-1}  \left( B_{+n} - b_nV_nB \right)' \right\} \]</span></p>
<p>for <span class="math inline">\(n = 1, \dots, N\)</span> and <span class="math inline">\(b_1, \dots, b_N\)</span> jointly have a distribution whose kernel is specified by <span class="math display">\[ p(b_1, \dots, b_N) \propto | \det(B_0) |^{\nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n S^{-1} V_n' b_n'  \right\} \]</span></p>
<p>The joint-distribution of <span class="math inline">\((B_+, B_0)\)</span> can then be written as <span class="math display">\[ p(B_0, B_+) = \left( \prod_{n=1}^N p(B_{+n}|b_n)\right) p(b_1, \dots, b_N) \]</span></p>
<p>This classification of the joint-distribution allows us to obtain natural-conjugate prior and corresponding posterior distributions.</p>
<p>Moreover, the following <code>ltexclusion</code> function imposes a lower-triangular restriction on <span class="math inline">\(B_0\)</span> and creates a list containing a matrix of <span class="math inline">\(b_n\)</span> and corresponding <span class="math inline">\(V_n\)</span> row vectors.</p>
<div class="cell">
<details>
<summary>Code: Imposing lower-triangular exclusion restrictions</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ltexclusion <span class="ot">=</span> <span class="cf">function</span>(usedata){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  BM.V        <span class="ot">=</span> <span class="fu">vector</span>(<span class="st">"list"</span>,usedata<span class="sc">$</span>N)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>usedata<span class="sc">$</span>N){</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  BM.V[[n]]   <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">diag</span>(n),<span class="fu">matrix</span>(<span class="dv">0</span>,n,usedata<span class="sc">$</span>N<span class="sc">-</span>n))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>B0.initial    <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,usedata<span class="sc">$</span>N,usedata<span class="sc">$</span>N)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>usedata<span class="sc">$</span>N){</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  unrestricted               <span class="ot">=</span> <span class="fu">apply</span>(BM.V[[n]],<span class="dv">2</span>,sum)<span class="sc">==</span><span class="dv">1</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  B0.initial[n,unrestricted] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="fu">sum</span>(unrestricted))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>B0Vlist       <span class="ot">=</span> <span class="fu">list</span>(<span class="at">B0.initial =</span> B0.initial, <span class="at">V =</span> BM.V)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="baseline-model" class="level2">
<h2 class="anchored" data-anchor-id="baseline-model">Baseline Model</h2>
<section id="prior-distribution" class="level3">
<h3 class="anchored" data-anchor-id="prior-distribution">Prior distribution</h3>
<p>Given this parameterisation, we can write down the kernel of the <strong>prior</strong> given hyperparameters <span class="math inline">\((\underline B, \underline \Omega, \underline S, \underline \nu)\)</span> as follows: <span class="math display">\[
| \det(B_0) |^{\underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n \underline S^{-1} V_n' b_n'  \right\}  \exp \left\{  -\frac{1}{2}  \sum_{n=1}^N  \left( B_{+n} - b_nV_n \underline B \right) \underline \Omega^{-1}  \left( B_{+n} - b_nV_n \underline B \right)' \right\}  
\]</span></p>
<p>This prior distribution has two key advantages. Firstly, it leads to a full-conditional posterior distributions that allow efficient sampling. This allows us to estimate the structural parameters of the SVAR model.</p>
<p>Secondly, it belongs to a class of reference prior distributions that are invariant to the pre-multiplication of the parameter matrices by a rotation matrix up to which the system is identified (see <span class="citation" data-cites="rr2010">Rubio-Ramirez, Waggoner, and Zha (<a href="#ref-rr2010" role="doc-biblioref">2010</a>)</span>). This allows us to conduct a proper Bayesian treatment of this model given the identification above.</p>
<div class="cell">

</div>
<section id="calibration-of-the-prior" class="level4">
<h4 class="anchored" data-anchor-id="calibration-of-the-prior">Calibration of the prior</h4>
<ul>
<li><span class="math inline">\(\underline \nu = N\)</span> is a commonly chosen value as it implies that the generalised-normal part is equivalent to a <span class="math inline">\(r_n\)</span>-variate normal with the mean equal to a vector of zeros and the covariance matrix equal to <span class="math inline">\(\underline S\)</span>.</li>
<li><span class="math inline">\(\underline S = \kappa_3 I_N\)</span> implies that the covariances across the rows of <span class="math inline">\(B_0\)</span> is zero, and the variance of each row is homoskedastic (constant). <span class="math inline">\(\kappa_3\)</span> can be interpreted as a contemporaneous effects shrinkage and is set to 10.</li>
<li><span class="math inline">\(\underline B = [0_{N \times 1} \; \kappa_4 I_N \; 0_{N \times (p-1)N}]\)</span> implies an AR1 process for the structural VAR at the prior mean. In this calibration, <span class="math inline">\(\kappa_4 = 1\)</span>, the AR1 process is a random walk process.</li>
<li><span class="math inline">\(\underline \Omega = \begin{pmatrix} \kappa_2 &amp; 0\\ 0 &amp; \kappa_1 I_{Np} \end{pmatrix}\)</span> is the prior covariance matrix. It is taken to be a diagonal matrix with the diagonal elements set as the Litterman prior. <span class="math inline">\(\kappa_2\)</span> represents the constant term shrinkage and is set to 10. <span class="math inline">\(\kappa_1\)</span> represents the autoregressive slope shrinkage and is set to 0.1.</li>
</ul>
<p>We also calibrate the number of draws <span class="math inline">\(S = 5000\)</span> for any sampling, while the <span class="math inline">\(S.burnin = 100\)</span> represents the number of draws that are sampled first and then discarded.</p>
<p>The following <code>R</code> code creates a list of model parameters with the calibration as above.</p>
<div class="cell">
<details>
<summary>Code: List of Parameters</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set the priors' parameters</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappa1    =</span> .<span class="dv">1</span>,       <span class="co"># autoregressive slope shrinkage</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappa2    =</span> <span class="dv">10</span>,       <span class="co"># constant term shrinkage</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappa3    =</span> <span class="dv">10</span>,       <span class="co"># contemporaneous effects shrinkage</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappa4    =</span> <span class="dv">1</span>,        <span class="co"># VAR prior persistence</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">S         =</span> <span class="dv">5000</span>,     <span class="co"># number of sample draws</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">S.burnin  =</span> <span class="dv">100</span>,      <span class="co"># number of initial draws that are burned-in</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">h         =</span> <span class="dv">16</span>        <span class="co"># forecast horizon</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The following <code>R</code> function takes as argument data and model parameters to compute parameters of the prior distribution and store it as a list.</p>
<div class="cell">
<details>
<summary>Code: Prior Function</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A function that computes and stores </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># all the prior distribution components given a parameter list input</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>prior     <span class="ot">=</span> <span class="cf">function</span>(parameters, usedata){</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  priors  <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">B       =</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,usedata<span class="sc">$</span>N), parameters<span class="sc">$</span>kappa4<span class="sc">*</span><span class="fu">diag</span>(usedata<span class="sc">$</span>N), <span class="fu">matrix</span>(<span class="dv">0</span>, usedata<span class="sc">$</span>N, (usedata<span class="sc">$</span>p<span class="dv">-1</span>)<span class="sc">*</span>usedata<span class="sc">$</span>N)), <span class="co"># random walk prior</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Omega   =</span> <span class="fu">diag</span>(<span class="fu">c</span>(parameters<span class="sc">$</span>kappa2,parameters<span class="sc">$</span>kappa1<span class="sc">*</span>((<span class="dv">1</span><span class="sc">:</span>usedata<span class="sc">$</span>p)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">2</span>))<span class="sc">%x%</span><span class="fu">rep</span>(<span class="dv">1</span>,usedata<span class="sc">$</span>N))),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Omega = diag(c(parameters$kappa2,parameters$kappa1*rep(1,usedata$N*usedata$p))),</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">S       =</span> parameters<span class="sc">$</span>kappa3<span class="sc">*</span><span class="fu">diag</span>(usedata<span class="sc">$</span>N),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">nu      =</span> usedata<span class="sc">$</span>N</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="likelihood-function" class="level3">
<h3 class="anchored" data-anchor-id="likelihood-function">Likelihood Function</h3>
<p>The conditional normality of the error term allows us to write the kernel of the likelihood function and show that it can be expressed as a NGN distribution. <span class="math display">\[
\begin{align*}
    &amp;L(B_+, B_0|Y,X) \propto | \det(B_0^{-1}B_0^{-1'})|^{-\frac{T}{2}} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left(b_n V_n Y - B_{+n} X \right) \left( b_n V_n Y - B_{+n} X  \right)' \right\}\\
    &amp; = | \det(B_0)|^{T} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left( b_n V_n Y Y' V_n' b_n' - 2 b_n V_n Y X' B_{+n}' + B_{+n} X X' B_{+n}' \right) \right\}\\
    &amp; = | \det(B_0)|^{T} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left( b_n V_n Y Y' V_n' b_n' + B_{+n} X X' B_{+n}' - 2 b_n V_n Y X' (XX')^{-1} (XX') B_{+n}' \right. \right. \\
    &amp; \left. \left. + b_n V_n Y X' (XX')^{-1} (XX') (XX')^{-1} XY'V_n'b_n' - b_n V_n Y X' (XX')^{-1} (XX') (XX')^{-1} XY'V_n'b_n' \right) \right\}\\
    &amp; = | \det(B_0)|^{T} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left( b_n V_n [ YY' - YX'(XX')^{-1}XY'] V_n' b_n'  + B_{+n} X X' B_{+n}' \right. \right. \\
    &amp; \left. \left. - 2 b_n V_n Y X' (XX')^{-1} (XX') B_{+n}' + b_n V_n Y X' (XX')^{-1} XY' V_n' b_n' \right) \right\}\\
    &amp; \text{}\\
    &amp; \text{Let $\hat A = YX' (XX')^{-1} $, then we can simplify}\\
    &amp; \text{}\\
    &amp; =  | \det(B_0)|^{T} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left( b_n V_n [ YY' - \hat A XY'] V_n' b_n'  + B_{+n} X X' B_{+n}' - 2 b_n V_n \hat A (XX') B_{+n}' \right. \right.\\ &amp; \left. \left. + b_n V_n \hat A XY' V_n' b_n' \right) \right\}\\
    &amp; =  | \det(B_0)|^{T} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left( b_n V_n [ YY' - \hat A XY'] V_n' b_n'  + (B_{+n} - b_n V_n \hat A) X X' (B_{+n} - b_n V_n \hat A)' \right) \right\}\\
    &amp; =  | \det(B_0)|^{T} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n [ YY' - \hat A XY'] V_n' b_n' \right\} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N (B_{+n} - b_n V_n \hat A) X X' (B_{+n} - b_n V_n \hat A)' \right\}
\end{align*}
\]</span></p>
<p>Comparing this with the general NGN kernel, we can write that</p>
<p><span class="math display">\[
L(B_+, B_0|Y, X) = \mathcal{NGN}(\tilde B, \tilde \Omega, \tilde S, \tilde \nu)
\]</span> where</p>
<p><span class="math display">\[
\tilde B = \hat A, \quad \tilde \Omega = (XX')^{-1}, \quad \tilde S = ( YY' - \hat A XY')^{-1}, \quad \tilde \nu = T + N.
\]</span> Hence, we have shown that the likelihood function follows a NGN distribution.</p>
</section>
<section id="posterior-distribution" class="level3">
<h3 class="anchored" data-anchor-id="posterior-distribution">Posterior Distribution</h3>
<p>The prior and the likelihood can be used to obtain the posterior as follows:</p>
<p><span class="math display">\[
\begin{align*}
    &amp; p(B_+, B_0|Y, X)  \propto L(B_+, B_0|Y, X) p(B_0, B_+)\\
    &amp; = | \det(B_0)|^{T} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left(b_n V_n Y - B_{+n} X \right) \left( b_n V_n Y - B_{+n} X  \right)' \right\}\\
    &amp; \times | \det(B_0) |^{\underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n \underline S^{-1} V_n' b_n'  \right\}  \exp \left\{  -\frac{1}{2}  \sum_{n=1}^N  \left( B_{+n} - b_nV_n \underline B \right) \underline \Omega^{-1}  \left( B_{+n} - b_nV_n \underline B \right)' \right\} \\
    &amp; =  | \det(B_0) |^{T + \underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N \left(b_n V_n Y Y' V_n' b_n' - 2 b_n V_n Y X' B_{+n}' + B_{+n} X X' B_{+n}' \right) \right.\\
    &amp; \left. + b_n V_n \underline S^{-1} V_n' b_n' + B_{+n} \underline \Omega^{-1} B_{+n}' - 2 b_n V_n \underline B \underline \Omega^{-1} B_{+n}' + b_n V_n \underline B \underline \Omega^{-1} \underline B' V_n' b_n' \right\}\\
    &amp; =  | \det(B_0) |^{T + \underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n [ YY' + \underline S^{-1} + \underline B \underline \Omega^{-1} \underline B'] V_n' b_n' - 2 b_n V_n [ YX' + \underline B \underline \Omega^{-1} ] B_{+n}' \right.\\
    &amp; \left. + B_{+n} [ XX' + \underline \Omega^{-1} ] B_{+n}' \right\}\\ &amp; \text{}\\
    &amp; \text{ Let $ \bar \Omega = (XX' + \underline \Omega^{-1})^{-1} $, then we can write}\\ &amp; \text{}\\
    &amp; =  | \det(B_0) |^{T + \underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n [ YY' + \underline S^{-1} + \underline B \underline \Omega^{-1} \underline B'] V_n' b_n' - 2 b_n V_n [ YX' + \underline B \underline \Omega^{-1} ] \bar \Omega \bar \Omega^{-1} B_{+n}' \right.\\
    &amp; \left. + B_{+n} \bar \Omega^{-1} B_{+n}' \right\}\\
    &amp; \text{}\\
    &amp; \text{ Let $ \bar B = (YX' + \underline B \underline \Omega^{-1}) \bar \Omega $, then we can write}\\ &amp; \text{}\\
    &amp; =  | \det(B_0) |^{T + \underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n [ YY' + \underline S^{-1} + \underline B \underline \Omega^{-1} \underline B' - \bar B \bar \Omega^{-1} \bar B' ] V_n' b_n'  \right.\\
    &amp; \left.  + b_n V_n  \bar B \bar \Omega^{-1} \bar B' V_n' b_n' - 2 b_n V_n \bar B \bar \Omega^{-1} B_{+n}' + B_{+n} \bar \Omega^{-1} B_{+n}' \right\}\\
    &amp; \text{}\\
    &amp; \text{ Define $ \bar S = (YY' + \underline S^{-1} + \underline B \underline \Omega^{-1} \underline B' - \bar B \bar \Omega^{-1} \bar B')^{-1} $, then we can write}\\ &amp; \text{}\\
    &amp; =  | \det(B_0) |^{T + \underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n \bar S^{-1} V_n' b_n'  + (B_{+n} - b_n V_n \bar B) \bar \Omega^{-1} (B_{+n} - b_n V_n \bar B)' \right\}\\
    &amp;  = | \det(B_0) |^{T + \underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n \bar S^{-1} V_n' b_n'  \right\} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N (B_{+n} - b_n V_n \bar B) \bar \Omega^{-1} (B_{+n} - b_n V_n \bar B)' \right\}
\end{align*}
\]</span> Thus, <span class="math display">\[ p(B_+, B_0|Y,X) \sim \mathcal{NGN}(\bar B, \bar \Omega, \bar S, \bar \nu) \]</span> where the posterior parameters are as follows <span class="math display">\[
\begin{align*}
&amp;\bar B = (YX' + \underline B \underline \Omega^{-1}) \bar \Omega\\
&amp; \bar \Omega = (XX' + \underline \Omega^{-1})^{-1} \\
&amp; \bar S = (YY' + \underline S^{-1} + \underline B \underline \Omega^{-1} \underline B' - \bar B \bar \Omega^{-1} \bar B')^{-1}\\
&amp;\bar \nu = T + \underline \nu
\end{align*}
\]</span></p>
<p>The following <code>R</code> function uses the prior and information contained in data to compute and store (as a list) the set of posterior parameters for our model.</p>
<div class="cell">
<details>
<summary>Code: Posterior Function</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>posterior     <span class="ot">=</span> <span class="cf">function</span>(priors, usedata){</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  Omega.inv   <span class="ot">=</span> <span class="fu">solve</span>(priors<span class="sc">$</span>Omega)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  Omega.post.inv <span class="ot">=</span> usedata<span class="sc">$</span>X<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>X) <span class="sc">+</span> Omega.inv</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  Omega.post  <span class="ot">=</span> <span class="fu">solve</span>( Omega.post.inv )</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  B.post      <span class="ot">=</span> (usedata<span class="sc">$</span>Y<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>X) <span class="sc">+</span> priors<span class="sc">$</span>B<span class="sc">%*%</span>Omega.inv) <span class="sc">%*%</span> Omega.post</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  S.inv.post      <span class="ot">=</span> usedata<span class="sc">$</span>Y<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>Y) <span class="sc">+</span> <span class="fu">solve</span>(priors<span class="sc">$</span>S) <span class="sc">+</span> priors<span class="sc">$</span>B<span class="sc">%*%</span>Omega.inv<span class="sc">%*%</span><span class="fu">t</span>(priors<span class="sc">$</span>B) <span class="sc">-</span> B.post<span class="sc">%*%</span>Omega.post.inv<span class="sc">%*%</span><span class="fu">t</span>(B.post)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  nu.post     <span class="ot">=</span> <span class="fu">ncol</span>(usedata<span class="sc">$</span>Y) <span class="sc">+</span> priors<span class="sc">$</span>nu</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  posteriors  <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">B           =</span> B.post,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Omega       =</span> Omega.post,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">S.inv       =</span> S.inv.post,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">nu          =</span> nu.post</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="gibbs-sampling" class="level3">
<h3 class="anchored" data-anchor-id="gibbs-sampling">(Gibbs) Sampling</h3>
<p>The sampling algorithm follows the derivation by <span class="citation" data-cites="waggoner2003a">D. F. Waggoner and Zha (<a href="#ref-waggoner2003a" role="doc-biblioref">2003</a>)</span>. The algorithm first samples <span class="math inline">\(b_1, \dots, b_n\)</span> independent of <span class="math inline">\(B_+\)</span> in a serial, iterative fashion. Then, the sampled <span class="math inline">\(b_1, \dots, b_n\)</span> are normalised. Using the normalised <span class="math inline">\(b_1, \dots, b_n\)</span> and data, <span class="math inline">\(B_{+n}\)</span> can be drawn independently.</p>
<section id="sample-b_1-dots-b_n-iteratively" class="level4">
<h4 class="anchored" data-anchor-id="sample-b_1-dots-b_n-iteratively">Sample <span class="math inline">\(b_1, \dots, b_n\)</span> iteratively</h4>
<p>Recall that the marginal posterior distribution of <span class="math inline">\(b_1, \dots, b_n\)</span> is proportional to <span class="math display">\[
| \det(B_0) |^{\underline \nu - N} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n \underline S^{-1} V_n' b_n'  \right\}
\]</span> The Gibbs sampler draws from the full conditional posterior distribution of vector <span class="math inline">\(b_n\)</span> given data as well as parameters from other rows of contemporaneous effects matrix, that is, <span class="math inline">\(b_1, \dots, b_{n-1}, b_{n+1}, \dots, b_{N}\)</span>. The full conditional posterior is denoted as <span class="math display">\[
p(b_n|Y, X, b_1, \dots,  b_{n-1}, b_{n+1}, \dots, b_{N})
\]</span> To sample from the full conditional posterior <span class="math inline">\(p(b_n^{(s)}|Y, X, b_1^{(s)}, \dots, b_{n-1}^{(s)}, b_{n+1}^{(s-1)}, \dots, b_{N}^{(s-1)})\)</span> at each iteration <span class="math inline">\(s\)</span> and at each row <span class="math inline">\(n\)</span>, the following steps are undertaken:</p>
<p><strong>Step 1:</strong> define and compute the following values</p>
<ul>
<li><p><span class="math inline">\(U_n = chol \left( \bar \nu (V_n \bar S^{-1}V_n')^{-1} \right)\)</span> – an <span class="math inline">\(r_n \times r_n\)</span> upper-triangular matrix;</p></li>
<li><p><span class="math inline">\(w = B_{0[-n.\cdot]\perp}^{(s)}\)</span> – a <span class="math inline">\(1 \times N\)</span> matrix;</p></li>
<li><p><span class="math inline">\(w_1 = wV_n'U-n' \cdot \left( w V_n'U_n'U_n V_n w' \right)^{-\frac{1}{2}}\)</span> – a <span class="math inline">\(1 \times r_n\)</span> vector;</p></li>
<li><p><span class="math inline">\(W_n = [w_1' \quad w_{1 \perp}']'\)</span> – a <span class="math inline">\(r_n \times r_n\)</span> matrix.</p></li>
</ul>
<p><strong>Step 2:</strong> draw the elements of a <span class="math inline">\(1 \times r_n\)</span> vector <span class="math inline">\(\alpha_n\)</span> defined as follows: - draw the first element by drawing <span class="math inline">\(u \sim \mathcal{N}(\textbf{0}_{\nu+1}, \bar \nu^{-1}I_{\nu+1})\)</span> and setting <span class="math display">\[
\alpha_{n[\cdot.1]} =
\begin{cases}
\sqrt{u'u} &amp; \text{ with probability } 0.5\\
-\sqrt{u'u} &amp; \text{ with probability } 0.5
\end{cases}
\]</span> - draw the remaining <span class="math inline">\(r_n-1\)</span> element of <span class="math inline">\(\alpha_n\)</span> from <span class="math inline">\(\mathcal{N}(\textbf{0}_{r_n-1}, \bar \nu^{-1} I_{r_n-1})\)</span>.</p>
<p><strong>Step3:</strong> compute the draw from the full-conditional posterior distribution of <span class="math inline">\(b_n\)</span> by <span class="math display">\[
b_n^{(s)} = \alpha_n W_n U_n
\]</span></p>
<p>Note that <span class="math inline">\(X\perp\)</span> refers to the orthogonal-complement matrix of <span class="math inline">\(X\)</span>. And, <span class="math inline">\(B_{0[-n.\cdot]}\)</span> refers to the matrix <span class="math inline">\(B_{0}\)</span> without its n<span class="math inline">\(^{th}\)</span> row.</p>
</section>
<section id="normalise-b_1-dots-b_n" class="level4">
<h4 class="anchored" data-anchor-id="normalise-b_1-dots-b_n">Normalise <span class="math inline">\(b_1, \dots, b_n\)</span></h4>
<p><span class="citation" data-cites="waggoner2003b">D. Waggoner and Zha (<a href="#ref-waggoner2003b" role="doc-biblioref">2003</a>)</span> provide a normalising rule that preserves the shape of the likelihood function. These normalised draws from the normal-generalised-normal posterior distribution are free of the local identification problem and hence the estimates post-normalisation are meaningful and appropriate for statistical inference.</p>
<p><strong>Step 1:</strong> normalise with respect to one mode <span class="math inline">\(\hat B_0\)</span> of the posterior distribution. Let <span class="math inline">\(\hat B_0\)</span> be defined as <span class="math display">\[
  \hat B_0 = chol((\bar\nu-N) \times \bar S)'
\]</span></p>
<p><strong>Step 2:</strong> define scaling matrices <span class="math inline">\(D_i\)</span> for <span class="math inline">\(i=1,\dots,2^N\)</span>.</p>
<p>These <span class="math inline">\(N \times N\)</span> matrices <span class="math inline">\(D_i\)</span> are diagonal matrices with diagonal elements equal to -1 or 1. Thus, <span class="math inline">\(2^N\)</span> set of <span class="math inline">\(D_i\)</span> matrices cover all possible combinations of -1 and 1 on the diagonal.</p>
<p><strong>Step 3:</strong> compute the distance between <span class="math inline">\(D_i B_0^{(s)}\)</span> and <span class="math inline">\(\hat B_0\)</span>.</p>
<p><span class="math display">\[
d \left( \left[ \left( D_i B_0^{(s)} \right)^{-1'} - \hat B_0^{-1'}   \right] | (\hat B_0' \hat B_0)^{-1}   \right) = \sum_{n=1}^N \left[ \left( D_i B_0^{(s)} \right)^{-1'} - \hat B_0^{-1'}   \right]_{[n. \cdot]} (\hat B_0' \hat B_0)^{-1}  \left[ \left( D_i B_0^{(s)} \right)^{-1'} - \hat B_0^{-1'}   \right]_{[n. \cdot]}'
\]</span></p>
<p>The choice of <span class="math inline">\(D_i\)</span> that minimises this distance is used to create the normalised draw <span class="math inline">\(D_{i*(s)}B_0^{(s)}\)</span> after applying it to all of the <span class="math inline">\(S\)</span> draws.</p>
</section>
<section id="sample-b_n-independently" class="level4">
<h4 class="anchored" data-anchor-id="sample-b_n-independently">Sample <span class="math inline">\(B_{+n}\)</span> independently</h4>
<p>For each draw of <span class="math inline">\(b_n^{(s)}\)</span>, a corresponding draw of <span class="math inline">\(B_{+n}^{(s)}\)</span> is directly sampled from the normal distribution below: <span class="math display">\[
B_{+n}^{(s)} \sim \mathcal{N}(b_n^{(s)}V_n \bar B_n, \bar \Omega)
\]</span></p>
<p>The <code>posteriorSimuations</code> function below takes model parameters, the posterior parameters, the exclusion restriction and the number of variables as given to sample draws using the Gibbs sampler. The functions <code>rgn</code>, <code>normalize.Gibbs.output.parallel</code> and <code>rnorm.ngn</code> are obtained from <a href="https://github.com/donotdespair">Tomasz Woźniak</a>’s lecture notes. These functions are provided in the <a href="#appendix">Appendix</a>.</p>
<div class="cell">
<details>
<summary>Code: Sample B0 and Bplus Posteriors Function, Baseline Model</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>posteriorSimulations  <span class="ot">=</span> <span class="cf">function</span>(parameters, posteriors, B0Vlist, N){</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  t0                  <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  B0.posterior        <span class="ot">=</span> <span class="fu">rgn</span>(<span class="at">n=</span>parameters<span class="sc">$</span>S.burnin, <span class="at">S.inv=</span>posteriors<span class="sc">$</span>S.inv, <span class="at">nu=</span>posteriors<span class="sc">$</span>nu, <span class="at">V=</span>B0Vlist<span class="sc">$</span>V, <span class="at">B0.initial=</span>B0Vlist<span class="sc">$</span>B0.initial)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  t1                  <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  (t1<span class="sc">-</span>t0)<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sampling B0 from the posterior distribution using Gibbs</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  t0                  <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  B0.posterior        <span class="ot">=</span> <span class="fu">rgn</span>(<span class="at">n=</span>parameters<span class="sc">$</span>S, <span class="at">S.inv=</span>posteriors<span class="sc">$</span>S.inv, <span class="at">nu=</span>posteriors<span class="sc">$</span>nu, <span class="at">V=</span>B0Vlist<span class="sc">$</span>V, <span class="at">B0.initial=</span>B0.posterior[,,parameters<span class="sc">$</span>S.burnin])</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  t1                  <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  (t1<span class="sc">-</span>t0)<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># normalisation</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  B0.hat              <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>((posteriors<span class="sc">$</span>nu<span class="sc">-</span>N)<span class="sc">*</span>posteriors<span class="sc">$</span>S))                   <span class="co"># normalisation using this B0.hat should work</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  BM.B0.posterior     <span class="ot">=</span> <span class="fu">normalize.Gibbs.output.parallel</span>(B0.posterior,<span class="at">B0.hat=</span>B0.hat)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  t2                  <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  (t2<span class="sc">-</span>t1)<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sample B+ from the normal conditional posterior</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  t2                  <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  BM.Bp.posterior     <span class="ot">=</span> <span class="fu">rnorm.ngn</span>(BM.B0.posterior, <span class="at">B=</span>posteriors<span class="sc">$</span>B,<span class="at">Omega=</span>posteriors<span class="sc">$</span>Omega)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  t3                  <span class="ot">=</span> <span class="fu">proc.time</span>()</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  (t3<span class="sc">-</span>t2)<span class="sc">/</span><span class="dv">60</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">B0.posterior   =</span> BM.B0.posterior, <span class="at">Bp.posterior =</span> BM.Bp.posterior)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The <code>posteriorMeans</code> function below computes the sample average of the posterior draws of <span class="math inline">\(B_0\)</span> and <span class="math inline">\(B_+\)</span> matrices obtained from each sampling step.</p>
<div class="cell">
<details>
<summary>posteriorMeans Function</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>posteriorMeans <span class="ot">=</span> <span class="cf">function</span>(Bposteriors){</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  Bposteriors.means <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">B0 =</span> <span class="fu">rowMeans</span>(Bposteriors<span class="sc">$</span>B0.posterior, <span class="at">dims =</span> <span class="dv">2</span>),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bp =</span> <span class="fu">rowMeans</span>(Bposteriors<span class="sc">$</span>Bp.posterior, <span class="at">dims =</span> <span class="dv">2</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The <code>pmatrix</code> function below prints the matrices in <code>R</code> in LaTeX form.</p>
<div class="cell">
<details>
<summary>Function to print matrix in LaTeX format</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pmatrix <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.matrix</span>(x)) {</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">"$$</span><span class="sc">\\</span><span class="st">begin{equation*}</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>          <span class="st">"</span><span class="sc">\\</span><span class="st">left("</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>          knitr<span class="sc">::</span><span class="fu">kable</span>(x, <span class="at">format =</span> <span class="st">"latex"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">tabular =</span> <span class="st">"array"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">vline =</span> <span class="st">""</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">align =</span> <span class="st">"c"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">linesep =</span> <span class="st">""</span>,</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">toprule =</span> <span class="cn">NULL</span>,</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                       <span class="at">bottomrule =</span> <span class="cn">NULL</span>),</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">"</span><span class="sc">\\</span><span class="st">right)</span><span class="sc">\\</span><span class="st">, .</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>          <span class="st">"</span><span class="sc">\\</span><span class="st">end{equation*}$$</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">"$$</span><span class="sc">\\</span><span class="st">begin{equation*}</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>          x,</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>          <span class="st">"</span><span class="sc">\\</span><span class="st">end{equation*}$$</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="simulation-run" class="level3">
<h3 class="anchored" data-anchor-id="simulation-run">Simulation Run</h3>
<p>The purpose of this simulation run is to verify whether the model and corresponding code can replicate the true parameters of a data-generating process. To do this, I create artificial data containing 1000 observations simulated from a bi-variate Gaussian random walk process with the covariance matrix equal to the identity matrix of order 2. Then, I estimate a model with a constant term and 1 lag with the artificial data. And I show that the posterior mean of the autoregressive and the covariance matrices are close to an identity matrix and that the posterior mean of the constant term is close to a vector of zeros.</p>
<p>This process is laid out in steps below:</p>
<p><strong><em>Step 1:</em></strong> The following code generates artificial data containing 1000 observations from a bi-variate Gaussian random walk process with the covariance matrix equal to the identity matrix of order 2.</p>
<div class="cell">
<details>
<summary>Code: Generate artificial data</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>sim.p <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>sim.T <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>sim.N <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>sim.K <span class="ot">=</span> <span class="dv">1</span> <span class="sc">+</span> sim.N<span class="sc">*</span>sim.p</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>sim.Y           <span class="ot">=</span> <span class="fu">arima.sim</span>(<span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)), <span class="at">n =</span> sim.T <span class="sc">+</span> sim.p<span class="dv">-1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span><span class="dv">1</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>sim.N){</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  sim.Y         <span class="ot">=</span> <span class="fu">rbind</span>(sim.Y, <span class="fu">arima.sim</span>(<span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>)), <span class="at">n =</span> sim.T <span class="sc">+</span> sim.p<span class="dv">-1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>sim.X           <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="dv">1</span>,sim.T)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>sim.p){</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  sim.X         <span class="ot">=</span> <span class="fu">rbind</span>(sim.X, sim.Y[,(sim.p<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>i)<span class="sc">:</span>(<span class="fu">ncol</span>(sim.Y)<span class="sc">-</span>i)])</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>sim.Y           <span class="ot">=</span> sim.Y[,<span class="sc">-</span>sim.p]</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>artificialdata  <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p =</span> sim.p, <span class="at">N =</span> sim.N, <span class="at">K =</span> sim.K, <span class="at">Y =</span> sim.Y, <span class="at">X =</span> sim.X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong><em>Step 2:</em></strong> We obtain a list of simulation priors and posteriors using the <code>prior</code> and <code>posterior</code> functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sim.priors      <span class="ot">=</span> <span class="fu">prior</span>(parameters, artificialdata)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>sim.posteriors  <span class="ot">=</span> <span class="fu">posterior</span>(sim.priors, artificialdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong><em>Step 3:</em></strong> We create a list of <span class="math inline">\(V_n\)</span> and <span class="math inline">\(b_n\)</span> corresponding to a lower triangular exclusion restriction on <span class="math inline">\(B_0\)</span> using the <code>ltexclusion</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sim.B0Vlist   <span class="ot">=</span> <span class="fu">ltexclusion</span>(artificialdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong><em>Step 4:</em></strong> We sample the <span class="math inline">\(B_0\)</span> and <span class="math inline">\(B_+\)</span> posteriors with the Gibbs sampler using the <code>posteriorSimulations</code> function, and save the results for future use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>sim.Bposteriors       <span class="ot">=</span> <span class="fu">posteriorSimulations</span>(parameters, sim.posteriors, sim.B0Vlist, artificialdata<span class="sc">$</span>N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p><strong><em>Step 5:</em></strong> We compute the sample averages of our posterior <span class="math inline">\(B_0\)</span> and <span class="math inline">\(B_+\)</span>. We use the <code>pmatrix</code> function to display the results as a matrix.</p>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>sim.Bposteriors.means <span class="ot">=</span> <span class="fu">posteriorMeans</span>(sim.Bposteriors)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sim_B0 <span class="ot">=</span> <span class="fu">pmatrix</span>(sim.Bposteriors.means<span class="sc">$</span>B0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{cc}
1.007094 &amp; 0.000000\\
-0.037662 &amp; 1.000047\\
\end{array} \right)\, .
\end{equation*}\]</span></p>
<p>We can see that the computed <span class="math inline">\(B_0\)</span> covariance matrix is numerically identical to an identity matrix.</p>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sim_Bp <span class="ot">=</span> <span class="fu">pmatrix</span>(sim.Bposteriors.means<span class="sc">$</span>Bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccc}
0.2276255 &amp; 0.9989406 &amp; -0.0071993\\
-0.1389968 &amp; -0.0461782 &amp; 0.9791025\\
\end{array} \right)\, .
\end{equation*}\]</span></p>
<p>The first column of <span class="math inline">\(B_+\)</span> represents the posterior mean of the constant term. The values are small and close to zero. The rest of the <span class="math inline">\(B_+\)</span> matrix represents the autoregressive matrix. Its posterior mean is numerically equal to an identity matrix.</p>
</section>
<section id="data-results" class="level3">
<h3 class="anchored" data-anchor-id="data-results">Data Results</h3>
<p><strong><em>Step 1:</em></strong> I set the desired number of lags in the model and use the data to create matrices <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. I store my data as a list named <code>mydata</code>.</p>
<div class="cell">
<details>
<summary>Code: List of Data Matrices</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Y is N by T; X is K by T</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="dv">4</span>                                   <span class="co"># set a number of lags included</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">ncol</span>(df)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>K <span class="ot">=</span> <span class="dv">1</span> <span class="sc">+</span> N<span class="sc">*</span>p</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">=</span> <span class="fu">t</span>(df[(p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(df),])</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fu">ncol</span>(Y))</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>p){</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  X    <span class="ot">=</span> <span class="fu">rbind</span>(X,<span class="fu">t</span>(df[((p<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(df))<span class="sc">-</span>i,]))</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">=</span> <span class="fu">list</span>(<span class="at">p=</span>p,<span class="at">N=</span>N,<span class="at">K=</span>K,<span class="at">Y=</span>Y,<span class="at">X=</span>X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong><em>Step 2:</em></strong> We obtain a list of data priors and posteriors using the <code>prior</code> and <code>posterior</code> functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>priors     <span class="ot">=</span> <span class="fu">prior</span>(parameters, mydata)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>posteriors <span class="ot">=</span> <span class="fu">posterior</span>(priors, mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong><em>Step 3:</em></strong> We create a list of <span class="math inline">\(V_n\)</span> and <span class="math inline">\(b_n\)</span> corresponding to a lower triangular exclusion restriction on <span class="math inline">\(B_0\)</span> using the <code>ltexclusion</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>B0Vlist       <span class="ot">=</span> <span class="fu">ltexclusion</span>(mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong><em>Step 4:</em></strong> We sample the <span class="math inline">\(B_0\)</span> and <span class="math inline">\(B_p\)</span> posteriors with the Gibbs sampler using the <code>posteriorSimulations</code> function, and save the results for future use.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Bposteriors           <span class="ot">=</span> <span class="fu">posteriorSimulations</span>(parameters, posteriors, B0Vlist, mydata<span class="sc">$</span>N)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p><strong><em>Step 5:</em></strong> We compute the sample averages of our posterior <span class="math inline">\(B_0\)</span> and <span class="math inline">\(B_+\)</span>. We use the <code>pmatrix</code> function to display the results as a matrix.</p>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>Bposterior.means <span class="ot">=</span> <span class="fu">posteriorMeans</span>(Bposteriors)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>data_B0 <span class="ot">=</span> <span class="fu">pmatrix</span>(Bposterior.means<span class="sc">$</span>B0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccccccccc}
2.7194046 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.0000\\
-0.0083644 &amp; 26.4727032 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.0000\\
0.0008651 &amp; -3.3422037 &amp; 25.2345905 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.0000\\
-0.1828049 &amp; -0.7020495 &amp; 1.3466381 &amp; 1.7545424 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.0000\\
-0.0860228 &amp; 0.8414400 &amp; -0.5550294 &amp; -0.3932550 &amp; 2.7677422 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.0000\\
-0.0356738 &amp; -0.0524865 &amp; 0.4328343 &amp; -0.0207150 &amp; 0.7724282 &amp; 23.5464079 &amp; 0.0000000 &amp; 0.000000 &amp; 0.0000\\
0.0564714 &amp; -0.0591610 &amp; -1.1540135 &amp; -0.1889706 &amp; -11.7074445 &amp; 0.5748700 &amp; 12.5986869 &amp; 0.000000 &amp; 0.0000\\
-0.0350259 &amp; 1.0455056 &amp; -0.4176768 &amp; 0.2197704 &amp; -0.7367318 &amp; -0.7794951 &amp; 0.5702032 &amp; 18.973736 &amp; 0.0000\\
-0.1514784 &amp; -0.5314789 &amp; -0.8653124 &amp; -0.2656810 &amp; -0.1211242 &amp; -1.7226130 &amp; 0.0432794 &amp; -1.088046 &amp; 25.4726\\
\end{array} \right)\, .
\end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>data_Bp <span class="ot">=</span> <span class="fu">pmatrix</span>(Bposterior.means<span class="sc">$</span>Bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccccccccccccccccccccccccccccccccccccc}
4.0648312 &amp; 2.8851434 &amp; -0.0720763 &amp; 0.0543550 &amp; -0.1063726 &amp; 0.1452214 &amp; -0.2101715 &amp; -0.3061815 &amp; 0.1386728 &amp; -0.0491164 &amp; -0.0825012 &amp; -0.0205374 &amp; 0.0198261 &amp; 0.0963603 &amp; 0.0343161 &amp; -0.0529068 &amp; -0.0654098 &amp; 0.0386580 &amp; -0.0022661 &amp; -0.1084682 &amp; -0.0085254 &amp; 0.0067943 &amp; -0.0118303 &amp; 0.0085827 &amp; -0.0164046 &amp; -0.0325035 &amp; 0.0195501 &amp; -0.0021792 &amp; -0.1311530 &amp; -0.0044261 &amp; 0.0038886 &amp; -0.0031745 &amp; 0.0019857 &amp; -0.0107474 &amp; -0.0170848 &amp; 0.0107877 &amp; 0.0008287\\
-0.2029448 &amp; 0.0354287 &amp; 26.4521943 &amp; -0.0219235 &amp; 0.1490847 &amp; 0.0251019 &amp; 0.0267879 &amp; 0.0546776 &amp; 0.0632533 &amp; 0.0058823 &amp; 0.0088559 &amp; -0.0042048 &amp; -0.0085999 &amp; -0.1017568 &amp; 0.0058958 &amp; 0.0119987 &amp; 0.0077623 &amp; 0.0098798 &amp; 0.0011410 &amp; -0.0204612 &amp; -0.0007752 &amp; -0.0035664 &amp; -0.0191747 &amp; -0.0096680 &amp; 0.0051670 &amp; -0.0031704 &amp; 0.0043929 &amp; -0.0018771 &amp; -0.0091002 &amp; -0.0005856 &amp; 0.0006959 &amp; -0.0103657 &amp; -0.0142938 &amp; 0.0018546 &amp; -0.0118245 &amp; 0.0000619 &amp; 0.0009664\\
0.1940443 &amp; 0.0467739 &amp; -3.3574638 &amp; 25.2143267 &amp; 0.0714187 &amp; 0.0251060 &amp; -0.0184962 &amp; -0.0075943 &amp; 0.0571311 &amp; -0.0033328 &amp; 0.0101925 &amp; -0.0018344 &amp; -0.0042200 &amp; -0.1498857 &amp; 0.0103576 &amp; -0.0018948 &amp; 0.0028173 &amp; 0.0031057 &amp; 0.0030597 &amp; -0.0430409 &amp; 0.0032038 &amp; 0.0035788 &amp; 0.0149999 &amp; -0.0016695 &amp; -0.0021676 &amp; 0.0047587 &amp; -0.0035240 &amp; 0.0001813 &amp; -0.0177420 &amp; 0.0012195 &amp; 0.0023508 &amp; 0.0207860 &amp; 0.0052478 &amp; -0.0001616 &amp; 0.0072795 &amp; 0.0007489 &amp; 0.0024354\\
-0.2994919 &amp; -0.1046635 &amp; -0.7076678 &amp; 1.3192450 &amp; 1.2545097 &amp; 0.2219172 &amp; 0.0819993 &amp; 0.2342432 &amp; 0.1860287 &amp; 0.0134389 &amp; -0.0665931 &amp; -0.0068933 &amp; -0.0133227 &amp; -0.1690935 &amp; -0.0475242 &amp; 0.0273171 &amp; -0.0270672 &amp; 0.0256128 &amp; -0.0012948 &amp; 0.0172428 &amp; -0.0052248 &amp; -0.0089509 &amp; -0.1366887 &amp; -0.0386805 &amp; 0.0055421 &amp; -0.0350628 &amp; 0.0032266 &amp; -0.0056818 &amp; -0.0058723 &amp; 0.0006462 &amp; -0.0025096 &amp; -0.0743186 &amp; -0.0082846 &amp; 0.0046185 &amp; -0.0024328 &amp; -0.0073177 &amp; -0.0046012\\
2.5585255 &amp; -0.0066754 &amp; 0.8288711 &amp; -0.5020729 &amp; -0.4568230 &amp; 3.0138531 &amp; -0.1564680 &amp; -0.1677028 &amp; 0.1617219 &amp; 0.0217405 &amp; 0.0475507 &amp; -0.0020607 &amp; 0.0101789 &amp; -0.0737170 &amp; -0.0415982 &amp; -0.0306631 &amp; -0.1287063 &amp; 0.0263266 &amp; -0.0050378 &amp; 0.0155091 &amp; -0.0015822 &amp; 0.0057429 &amp; -0.0500014 &amp; -0.0438827 &amp; -0.0135053 &amp; -0.0733431 &amp; 0.0057693 &amp; -0.0068353 &amp; -0.0591949 &amp; -0.0020136 &amp; -0.0005626 &amp; 0.0232184 &amp; 0.0027831 &amp; -0.0094360 &amp; -0.0070513 &amp; 0.0012375 &amp; -0.0054753\\
0.7397746 &amp; 0.0137152 &amp; -0.0229393 &amp; 0.4558805 &amp; -0.0193145 &amp; 0.7315018 &amp; 23.5552900 &amp; -0.0139548 &amp; -0.0115209 &amp; -0.0265769 &amp; 0.0120738 &amp; 0.0050422 &amp; 0.0078787 &amp; -0.0125916 &amp; -0.0357843 &amp; 0.0066207 &amp; -0.0293907 &amp; -0.0039903 &amp; -0.0101668 &amp; 0.0358080 &amp; 0.0064970 &amp; -0.0007591 &amp; 0.0043771 &amp; 0.0026772 &amp; 0.0002161 &amp; 0.0047751 &amp; 0.0003684 &amp; -0.0044988 &amp; 0.0193735 &amp; 0.0015446 &amp; 0.0000531 &amp; -0.0130743 &amp; -0.0050762 &amp; 0.0030893 &amp; -0.0074677 &amp; 0.0011153 &amp; -0.0027520\\
-0.8698116 &amp; -0.0773580 &amp; -0.0332854 &amp; -1.1619398 &amp; -0.2286229 &amp; -11.6541655 &amp; 0.6447739 &amp; 12.6408380 &amp; -0.0523751 &amp; 0.0345840 &amp; 0.0138937 &amp; 0.0141900 &amp; 0.0009504 &amp; -0.0940291 &amp; -0.0251588 &amp; 0.0188155 &amp; -0.0237115 &amp; -0.0096623 &amp; 0.0090631 &amp; 0.0862063 &amp; 0.0056785 &amp; 0.0018945 &amp; 0.0153264 &amp; 0.0233680 &amp; 0.0061449 &amp; 0.0209966 &amp; -0.0069842 &amp; 0.0019724 &amp; 0.0578864 &amp; 0.0006781 &amp; -0.0005237 &amp; -0.0000858 &amp; 0.0155333 &amp; 0.0049881 &amp; 0.0147274 &amp; -0.0012528 &amp; 0.0030459\\
1.6144229 &amp; -0.0908928 &amp; 1.0580411 &amp; -0.4165733 &amp; -0.3273910 &amp; -0.8469357 &amp; -0.7737012 &amp; 0.3943126 &amp; 18.8998265 &amp; -0.0680833 &amp; 0.0039033 &amp; 0.0073150 &amp; 0.0052320 &amp; 0.0100443 &amp; 0.0334497 &amp; 0.0002363 &amp; 0.0119692 &amp; -0.0546084 &amp; -0.0228015 &amp; 0.0312552 &amp; 0.0059630 &amp; 0.0084129 &amp; 0.0467699 &amp; 0.0723329 &amp; -0.0096091 &amp; 0.0632058 &amp; -0.0246182 &amp; -0.0107407 &amp; 0.0388868 &amp; 0.0037111 &amp; 0.0053680 &amp; 0.0654332 &amp; 0.0740202 &amp; -0.0081970 &amp; 0.0648373 &amp; -0.0110446 &amp; -0.0038691\\
0.6191889 &amp; -0.1450130 &amp; -0.5229711 &amp; -0.8750196 &amp; -0.2189709 &amp; -0.1517908 &amp; -1.6845184 &amp; -0.0784696 &amp; -0.9996365 &amp; 25.4435492 &amp; 0.0072336 &amp; -0.0021376 &amp; -0.0053391 &amp; -0.0242130 &amp; -0.0060620 &amp; 0.0054626 &amp; -0.0154996 &amp; 0.0136988 &amp; -0.0144934 &amp; 0.0000250 &amp; -0.0001331 &amp; -0.0019112 &amp; 0.0093214 &amp; 0.0214501 &amp; 0.0022844 &amp; 0.0144202 &amp; 0.0005166 &amp; -0.0132830 &amp; 0.0128877 &amp; -0.0033314 &amp; -0.0028081 &amp; 0.0272992 &amp; 0.0229197 &amp; 0.0021625 &amp; 0.0178043 &amp; -0.0034796 &amp; -0.0063407\\
\end{array} \right)\, .
\end{equation*}\]</span></p>
</section>
</section>
</section>
<section id="extended-model" class="level1">
<h1>Extended Model</h1>
<p>In the extended model, I will estimate the hyperparameters rather than setting them exogenously. Such estimation procedure often improves the fit of the model especially because the results can be sensitive to the parameterisation of the hyperparameters. In particular, I estimate <span class="math inline">\((\kappa_0, \kappa_+)\)</span> such that <span class="math inline">\(\underline S = \kappa_0 I_N\)</span> and <span class="math inline">\(\underline \Omega = \kappa_+ I_K\)</span>. I assume</p>
<section id="analysis-of-priors" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-priors">Analysis of priors</h2>
<p>In my extensions, I will assume the priors of hyperparameters <span class="math inline">\((\kappa_0, \kappa_+)\)</span> to follow either an Inverse-Gamma 2 <span class="math inline">\((\mathcal{IG}2)\)</span> or a Gamma <span class="math inline">\((\mathcal{G})\)</span> distribution. In this section, I want to illustrate the properties of these distributions. Suppose that <span class="math display">\[
\begin{align*}
    \kappa_0 | \underline s_{\kappa_0}, \underline \nu_{\kappa_0} \sim \mathcal{IG}2(\underline s_{\kappa_0}, \underline \nu_{\kappa_0})  &amp;&amp; \kappa_1 | \underline s_{\kappa_1}, \underline \nu_{\kappa_1} \sim \mathcal{G}(2 \underline s_{\kappa_1}, \frac{1}{2} \underline \nu_{\kappa_1})
  \end{align*}
\]</span></p>
<div class="cell">
<details>
<summary>Code: Analysis of Priors</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>kappa0.s <span class="ot">=</span> .<span class="dv">1</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>kappa0.nu <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>kappap.s <span class="ot">=</span> .<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>kappap.nu <span class="ot">=</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>nDraws <span class="ot">=</span> <span class="dv">5000</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>kappa0.priorDraws <span class="ot">=</span> kappa0.s <span class="sc">/</span> <span class="fu">rchisq</span>(nDraws, <span class="at">df =</span> kappa0.nu)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>kappap.priorDraws <span class="ot">=</span> <span class="fu">rgamma</span>(nDraws, <span class="at">shape =</span> kappap.s, <span class="at">scale =</span> kappap.nu)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(kappa0.priorDraws,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">100</span>,</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"deepskyblue2"</span>,</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">'black'</span>,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Distribution of "</span>, kappa[<span class="dv">0</span>], <span class="st">" draws"</span>)),</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">""</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(kappap.priorDraws,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">100</span>,</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">'deepskyblue2'</span>,</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">'black'</span>,</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Distribution of "</span>, kappa[<span class="st">"+"</span>], <span class="st">" draws"</span>)),</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">""</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>     )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/analysis of priors-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that the draws from the <span class="math inline">\(\mathcal{IG}2\)</span> are more positively skewed, have greater dispersion but thinner tails compared to draws from the <span class="math inline">\(\mathcal{G}\)</span> distribution. The dispersion is orders of magnitude higher for the <span class="math inline">\(\mathcal{IG}2\)</span> draws.</p>
</section>
<section id="extension-1-normal-gamma-prior-hyperparameter-estimation" class="level2">
<h2 class="anchored" data-anchor-id="extension-1-normal-gamma-prior-hyperparameter-estimation">Extension 1: Normal-Gamma Prior Hyperparameter Estimation</h2>
<section id="prior-distribution-1" class="level3">
<h3 class="anchored" data-anchor-id="prior-distribution-1">Prior Distribution</h3>
<p>I postulate the following prior distributions for the hyperparameters: <span class="math display">\[
\begin{align*}
    \kappa_0 | \underline s_{\kappa_0}, \underline \nu_{\kappa_0} \sim \mathcal{IG}2(\underline s_{\kappa_0}, \underline \nu_{\kappa_0})  &amp;&amp; \kappa_+ | \underline s_{\kappa_+}, \underline \nu_{\kappa_+} \sim \mathcal{G}(2 \underline s_{\kappa_+}, \frac{1}{2} \underline \nu_{\kappa_+})
  \end{align*}
\]</span></p>
<p>The <code>ext.priors</code> function creates a list containing all the elements of the prior.</p>
<div class="cell">
<details>
<summary>Extension Model Priors Function</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>ext.priors <span class="ot">=</span> <span class="cf">function</span>(parameters,usedata){</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  ext.prior <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappa0.s =</span> .<span class="dv">1</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappa0.nu =</span> <span class="dv">1</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappap.s =</span> .<span class="dv">1</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappap.nu =</span> <span class="dv">1</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">B       =</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,usedata<span class="sc">$</span>N), <span class="fu">diag</span>(usedata<span class="sc">$</span>N), <span class="fu">matrix</span>(<span class="dv">0</span>, usedata<span class="sc">$</span>N, (usedata<span class="sc">$</span>p<span class="dv">-1</span>)<span class="sc">*</span>usedata<span class="sc">$</span>N)), <span class="co"># random walk prior</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Omega   =</span> parameters<span class="sc">$</span>kappa2 <span class="sc">*</span> <span class="fu">diag</span>(usedata<span class="sc">$</span>K),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">S       =</span> parameters<span class="sc">$</span>kappa3<span class="sc">*</span><span class="fu">diag</span>(usedata<span class="sc">$</span>N),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">nu      =</span> usedata<span class="sc">$</span>N</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Moreover, we have <span class="math display">\[
  \begin{align*}
    p(B_{+n}|b_n, \kappa_+) = \mathcal{N}_k (b_n V_n B, \kappa_+ \Omega) &amp;&amp; p(b_n| \kappa_0) = \mathcal{N}_{r_n}(0, \kappa_0 S)
  \end{align*}
\]</span></p>
</section>
<section id="posterior-distribution-1" class="level3">
<h3 class="anchored" data-anchor-id="posterior-distribution-1">Posterior Distribution</h3>
<p>Thus, posteriors can be written as <span class="math display">\[
  \begin{align*}
    &amp; p(\kappa_0 | Y, X, B_0) \propto p(B_0|\kappa_0) p(\kappa_0 | \underline s_{\kappa_0}, \underline \nu_{\kappa_0} )\\
    &amp; \propto \prod_{n=1}^{N}\left(\kappa_0^{-\frac{1}{2}}\right)^{r_n} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n (\kappa_0 I_N)^{-1} V_n' b_n'  \right\} \cdot \kappa_0^{-\frac{\underline \nu_{\kappa_0}+2}{2}} \exp \left\{  -\frac{\underline s_{\kappa_0}}{2 \kappa_0} \right\}\\
    &amp; \propto \kappa_0^{ -\frac{\underline \nu_{\kappa_0} + 2 + \sum_{n=1}^{N}r_n}{2}} \cdot \exp \left\{  -\frac{1}{2 \kappa_0} \sum_{n=1}^N b_n V_n V_n' b_n' + \underline s_{\kappa_0} \right\}\\
  \end{align*}
\]</span> This gives <span class="math display">\[\bar s_{\kappa_0} =  \sum_{n=1}^N b_n V_n V_n' b_n' + \underline s_{\kappa_0}.\]</span> <span class="math display">\[\bar \nu_{\kappa_0} = \underline \nu_{\kappa_0} +\sum_{n=1}^{N}r_n\]</span> Also, <span class="math display">\[
  \begin{align*}
    &amp; p(\kappa_+ | Y, X, B_+, B_0) \propto p(B_+|\kappa_+, B_0) p(\kappa_+ | \underline s_{\kappa_+}, \underline \nu_{\kappa_+} )\\
    &amp; \propto \kappa_+^{-\frac{KN}{2}} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N (B_{+n} - b_n V_n \underline B) (\kappa_+ I_{K})^{-1} (B_{+n} - b_n V_n \underline B)'  \right\} \cdot \kappa_+^{\frac{\underline \nu_{\kappa_+} - 2}{2}} \exp \left\{  -\frac{ \kappa_+}{2 \underline s_{\kappa_+}} \right\}\\
    &amp; = \kappa_+^{-\frac{-\underline \nu_{\kappa_+} + KN}{2} - 1} \cdot \exp \left\{  -\frac{1}{2} \left( (B_{+n} - b_n V_n \underline B)  (B_{+n} - b_n V_n \underline B)' \cdot \frac{1}{\kappa_+} + \frac{1}{\underline s_{\kappa_+}} \kappa_+  \right) \right\}\\
  \end{align*}
\]</span> This gives <span class="math display">\[\bar\lambda = -\frac{-\underline \nu_{\kappa_+} + KN}{2}\]</span> <span class="math display">\[\bar \chi =  \sum_{n=1}^N  (B_{+n} - b_n V_n \underline B)  (B_{+n} - b_n V_n \underline B)'\]</span> <span class="math display">\[\bar \Psi = \frac{1}{\underline s_{\kappa_+}}\]</span></p>
<p>The <code>init.struct</code> function creates and initialise a list that contains matrices to store draws of <span class="math inline">\(\{\kappa_0^{(s)}, \kappa_+^{(s)}, B_0^{(s)}, B_+^{(s)}\}_{s =1}^{S}\)</span>.</p>
<div class="cell">
<details>
<summary>Code: Create structure to store results</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>  init.struct <span class="ot">=</span> <span class="cf">function</span>(usedata,S){</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    kappa0 <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(<span class="dv">1</span>,S))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    kappa0[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    kappap <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, S)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    kappap[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    B0.posterior <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(usedata<span class="sc">$</span>N,usedata<span class="sc">$</span>N,S))</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    Bp.posterior <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(usedata<span class="sc">$</span>N,usedata<span class="sc">$</span>K,S))</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(<span class="at">kappa0 =</span> kappa0, <span class="at">kappap =</span> kappap, <span class="at">B0.posterior =</span> B0.posterior, <span class="at">Bp.posterior =</span> Bp.posterior)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="gibbs-sampling-1" class="level3">
<h3 class="anchored" data-anchor-id="gibbs-sampling-1">(Gibbs) Sampling</h3>
<p>Given the full conditional posteriors of both <span class="math inline">\((\kappa_0,\kappa_+)\)</span> and <span class="math inline">\((B_0, B_+)\)</span>, we can implement the Gibbs sampler as follows:</p>
<ul>
<li><p>Step 1: Initialise <span class="math inline">\((\kappa_0^{(0)},\kappa_+^{(0)})\)</span>.</p></li>
<li><p>Step 2: Use <span class="math inline">\((\kappa_0^{(s-1)},\kappa_+^{(s-1)})\)</span> values to compute posterior parameters for each draw <span class="math inline">\((\bar B, \bar \Omega, \bar s, \bar \nu)^{(s)}\)</span>.</p></li>
<li><p>Step 3: draw <span class="math inline">\((B_0, B_+)^{(s)} \sim \mathcal{NGN}(\bar B, \bar \Omega, \bar s, \bar \nu)^{(s)}\)</span> using the sampling procedure presented in the baseline model.</p></li>
<li><p>Step 4: draw <span class="math inline">\(\kappa_0^{(s)} \sim p(\kappa_0 | Y, X, B_0^{(s)}) = \mathcal{IG2}(\bar s_{\kappa_0}, \bar \nu_{\kappa_0})\)</span> and <span class="math inline">\(\kappa_+^{(s)} \sim p(\kappa_+ | Y, X, B_0^{(s)}, B_+^{(s)}) = \mathcal{GIG}(\bar \lambda, \bar \chi, \bar \Psi)\)</span>.</p></li>
</ul>
<p>Repeat steps 2-4 to get desired sample size and burn in some initial sample observations as needed.</p>
<p>The sampling function <code>ext.sampling</code> is given below.</p>
<div class="cell">
<details>
<summary>Code: Sampler for Extension 1</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>ext.sampling <span class="ot">=</span> <span class="cf">function</span>(parameters, struct, priors, usedata){</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  B0Vlist.initial <span class="ot">=</span> <span class="fu">ltexclusion</span>(usedata)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  B0.initial <span class="ot">=</span> B0Vlist.initial<span class="sc">$</span>B0</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(parameters<span class="sc">$</span>S <span class="sc">+</span> parameters<span class="sc">$</span>S.burnin)){</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Computing posterior parameters for each draw</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    Omega.inv      <span class="ot">=</span> <span class="fu">solve</span>(struct<span class="sc">$</span>kappap[i] <span class="sc">*</span> priors<span class="sc">$</span>Omega)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    Omega.post.inv <span class="ot">=</span> usedata<span class="sc">$</span>X<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>X) <span class="sc">+</span> Omega.inv</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    Omega.post     <span class="ot">=</span> <span class="fu">solve</span>(Omega.post.inv)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    B.post         <span class="ot">=</span> (usedata<span class="sc">$</span>Y<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>X) <span class="sc">+</span> priors<span class="sc">$</span>B<span class="sc">%*%</span>Omega.inv) <span class="sc">%*%</span> Omega.post</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    S.post         <span class="ot">=</span> usedata<span class="sc">$</span>Y<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>Y) <span class="sc">+</span> <span class="fu">solve</span>(struct<span class="sc">$</span>kappa0[i] <span class="sc">*</span> priors<span class="sc">$</span>S) <span class="sc">+</span> priors<span class="sc">$</span>B<span class="sc">%*%</span>Omega.inv<span class="sc">%*%</span><span class="fu">t</span>(priors<span class="sc">$</span>B) <span class="sc">-</span> B.post<span class="sc">%*%</span>Omega.post.inv<span class="sc">%*%</span><span class="fu">t</span>(B.post) </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    nu.post        <span class="ot">=</span> <span class="fu">ncol</span>(usedata<span class="sc">$</span>Y) <span class="sc">+</span> priors<span class="sc">$</span>nu</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    B0.initial <span class="ot">=</span> struct<span class="sc">$</span>B0.post[,,i<span class="dv">-1</span>]</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  B0.i <span class="ot">=</span> <span class="fu">rgn</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">S.inv =</span> S.post, <span class="at">nu =</span> nu.post, <span class="at">V =</span> B0Vlist.initial<span class="sc">$</span>V, <span class="at">B0.initial =</span> B0.initial)</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B0.hat = t(chol((nu.post - usedata$N)*solve(S.post)))</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B0.norm.i = normalize.Gibbs.output.parallel(B0.i, B0.hat)</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  Bp.i <span class="ot">=</span> <span class="fu">rnorm.ngn</span>(B0.i, B.post, Omega.post)</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>B0.posterior[,,i] <span class="ot">=</span> B0.i</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>Bp.posterior[,,i] <span class="ot">=</span> Bp.i</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now, update kappa</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  kappa0.nu.post <span class="ot">=</span> priors<span class="sc">$</span>kappa0.nu <span class="sc">+</span> (usedata<span class="sc">$</span>N<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  kappap.lambda.post <span class="ot">=</span> <span class="sc">-</span>(<span class="sc">-</span>priors<span class="sc">$</span>kappap.nu <span class="sc">+</span> usedata<span class="sc">$</span>K <span class="sc">*</span> usedata<span class="sc">$</span>N)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  kappap.psi.post <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>priors<span class="sc">$</span>kappap.s</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  kappa0.s.post <span class="ot">=</span> priors<span class="sc">$</span>kappa0.s</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>usedata<span class="sc">$</span>N){</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>    kappa0.s.post <span class="ot">=</span> kappa0.s.post <span class="sc">+</span> <span class="fu">sum</span>(B0.i[n,,<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>    kappap.chi.post <span class="ot">=</span> (Bp.i[n,,<span class="dv">1</span>] <span class="sc">-</span> B0.i[n,,<span class="dv">1</span>] <span class="sc">%*%</span> B.post) <span class="sc">%*%</span> <span class="fu">t</span>(Bp.i[n,,<span class="dv">1</span>] <span class="sc">-</span> B0.i[n,,<span class="dv">1</span>] <span class="sc">%*%</span> B.post)</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">!=</span> (parameters<span class="sc">$</span>S <span class="sc">+</span> parameters<span class="sc">$</span>S.burnin)){</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>    struct<span class="sc">$</span>kappa0[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> kappa0.s.post <span class="sc">/</span> <span class="fu">rchisq</span>(<span class="at">n=</span><span class="dv">1</span>,<span class="at">df =</span> kappa0.nu.post)</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>    struct<span class="sc">$</span>kappap[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> GIGrvg<span class="sc">::</span><span class="fu">rgig</span>(<span class="at">n=</span><span class="dv">1</span>, kappap.lambda.post, kappap.chi.post, kappap.psi.post)</span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>kappa0 <span class="ot">=</span> struct<span class="sc">$</span>kappa0[(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>kappap <span class="ot">=</span> struct<span class="sc">$</span>kappap[(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>B0.posterior <span class="ot">=</span> struct<span class="sc">$</span>B0.posterior[,,(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>Bp.posterior <span class="ot">=</span> struct<span class="sc">$</span>Bp.posterior[,,(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set normalising matrix</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>  B0.last_draw <span class="ot">=</span> struct<span class="sc">$</span>B0.posterior[,,parameters<span class="sc">$</span>S]</span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>  B0_hat <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">sign</span>(<span class="fu">diag</span>(B0.last_draw))) <span class="sc">%*%</span> B0.last_draw</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute normalised B0</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>  B0.norm <span class="ot">=</span> <span class="fu">normalize.Gibbs.output.parallel</span>(struct<span class="sc">$</span>B0.posterior, B0_hat)</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute and save normalised BP</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>parameters<span class="sc">$</span>S){</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>    struct<span class="sc">$</span>Bp.posterior[,,i] <span class="ot">=</span> B0.norm[,,i] <span class="sc">%*%</span> <span class="fu">solve</span>(struct<span class="sc">$</span>B0.posterior[,,i]) <span class="sc">%*%</span> struct<span class="sc">$</span>Bp.posterior[,,i]</span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save normalised B0</span></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>B0.posterior <span class="ot">=</span> B0.norm</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(struct)</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code: Compute Posterior Means Function</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>structPosteriorMeans <span class="ot">=</span> <span class="cf">function</span>(struct){</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  struct.means <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappa0 =</span> <span class="fu">mean</span>(struct<span class="sc">$</span>kappa0),</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">kappap =</span> <span class="fu">mean</span>(struct<span class="sc">$</span>kappap),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">B0 =</span> <span class="fu">rowMeans</span>(struct<span class="sc">$</span>B0.posterior, <span class="at">dims =</span> <span class="dv">2</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bp =</span> <span class="fu">rowMeans</span>(struct<span class="sc">$</span>Bp.posterior, <span class="at">dims =</span> <span class="dv">2</span>)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="simulation-run-1" class="level3">
<h3 class="anchored" data-anchor-id="simulation-run-1">Simulation Run</h3>
<p><strong><em>Step 1:</em></strong> The following code computes the prior, initialises matrices to store results, and samples the draws for the simulated data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ext.sim.prior <span class="ot">=</span> <span class="fu">ext.priors</span>(parameters, artificialdata)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>ext.sim.struct <span class="ot">=</span> <span class="fu">init.struct</span>(artificialdata, parameters<span class="sc">$</span>S <span class="sc">+</span> parameters<span class="sc">$</span>S.burnin)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>ext.sim.struct <span class="ot">&lt;-</span> <span class="fu">ext.sampling</span>(parameters, ext.sim.struct, ext.sim.prior, artificialdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p><strong><em>Step 2:</em></strong> The following code computes and stores the posterior means of <span class="math inline">\(\{\kappa_0^{(s)}, \kappa_+^{(s)}, B_0^{(s)}, B_+^{(s)}\}_{s =1}^{S}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>ext.sim.struct.means <span class="ot">=</span> <span class="fu">structPosteriorMeans</span>(ext.sim.struct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong><em>Step 3:</em></strong> The code snippets below display the sample posterior means of the estimated objects using simulated data.</p>
<p>The following code computes the posterior mean of <span class="math inline">\(B_0\)</span>.</p>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ext.sim.data_B0 <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.sim.struct.means<span class="sc">$</span>B0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{cc}
1.0031219 &amp; 0.0000000\\
-0.0354609 &amp; 0.9974601\\
\end{array} \right)\, .
\end{equation*}\]</span></p>
<p>We can see that the posterior <span class="math inline">\(B_0\)</span> matrix is numerically equal to an identity matrix.</p>
<p>The following code computes the posterior mean of <span class="math inline">\(B_+\)</span>.</p>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ext.sim.data_Bp <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.sim.struct.means<span class="sc">$</span>Bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccc}
0.0194938 &amp; 0.9996890 &amp; -0.0063959\\
-0.0120185 &amp; -0.0422528 &amp; 0.9847704\\
\end{array} \right)\, .
\end{equation*}\]</span></p>
<p>Here, as well, we can see that the first column of the autoregressive matrix is close to zero, while the rest of the matrix is numerically close to an identity matrix. Thus, we can see that the sampler works as the posterior draws replicate the data-generating process.</p>
<p>The following code computes the posterior mean of <span class="math inline">\(\kappa_0\)</span>.</p>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ext.sim.data_kappa0 <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.sim.struct.means<span class="sc">$</span>kappa0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
12.17840829711 \end{equation*}\]</span></p>
<p>The following code computes the posterior mean of <span class="math inline">\(\kappa_+\)</span>.</p>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>ext.sim.data_kappap <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.sim.struct.means<span class="sc">$</span>kappap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
0.000120567572554392 \end{equation*}\]</span></p>
<p>The following graphs plot the histogram of kappa draws for the simulated data. The draws are concentrated towards zero with fat tails with <span class="math inline">\(\kappa_0\)</span> dispersed much more than <span class="math inline">\(\kappa_+\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/ext histogram of kappa draws simulated data-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="data-results-1" class="level3">
<h3 class="anchored" data-anchor-id="data-results-1">Data Results</h3>
<p><strong><em>Step 1:</em></strong> The following code computes the prior, initialises matrices to store results, and samples the draws for the actual data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ext.prior  <span class="ot">=</span> <span class="fu">ext.priors</span>(parameters, mydata)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>ext.struct <span class="ot">=</span> <span class="fu">init.struct</span>(mydata, parameters<span class="sc">$</span>S <span class="sc">+</span> parameters<span class="sc">$</span>S.burnin)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>ext.struct <span class="ot">=</span> <span class="fu">ext.sampling</span>(parameters, ext.struct, ext.prior, mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p><strong><em>Step 2:</em></strong> The following code computes and stores the posterior means of <span class="math inline">\(\{\kappa_0^{(s)}, \kappa_+^{(s)}, B_0^{(s)}, B_+^{(s)}\}_{s =1}^{S}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ext.struct.means <span class="ot">=</span> <span class="fu">structPosteriorMeans</span>(ext.struct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong><em>Step 3:</em></strong> The code snippets below display the sample posterior means of the estimated objects using actual data.</p>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>ext.data_B0 <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.struct.means<span class="sc">$</span>B0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccccccccc}
2.5426454 &amp; 0.000000 &amp; 0.000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.00000 &amp; 0.00000\\
-0.0467928 &amp; 68.985259 &amp; 0.000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.00000 &amp; 0.00000\\
-0.0309508 &amp; -85.047580 &amp; 81.570248 &amp; 0.0000000 &amp; 0.000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.00000 &amp; 0.00000\\
-0.1054099 &amp; -17.805953 &amp; 12.885819 &amp; 1.5961946 &amp; 0.000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.00000 &amp; 0.00000\\
-0.0561666 &amp; 19.716723 &amp; -15.501387 &amp; -0.5463961 &amp; 2.609329 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.00000 &amp; 0.00000\\
-0.1735837 &amp; -9.515250 &amp; 9.437039 &amp; -0.0262121 &amp; 1.260644 &amp; 41.1893080 &amp; 0.0000000 &amp; 0.00000 &amp; 0.00000\\
0.5262144 &amp; 12.626177 &amp; -14.015561 &amp; -0.2664081 &amp; -15.595301 &amp; 0.8564079 &amp; 16.5275013 &amp; 0.00000 &amp; 0.00000\\
-0.2095568 &amp; 63.554687 &amp; -37.368868 &amp; -0.0775998 &amp; -1.396175 &amp; -6.7756121 &amp; 1.4040936 &amp; 24.17670 &amp; 0.00000\\
-0.3271498 &amp; 3.507358 &amp; -14.264172 &amp; -0.6190129 &amp; -1.149085 &amp; -15.3758027 &amp; 0.6811854 &amp; -4.65554 &amp; 61.11232\\
\end{array} \right)\, .
\end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>ext.data_Bp <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.struct.means<span class="sc">$</span>Bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccccccccccccccccccccccccccccccccccccc}
0.0042846 &amp; 2.5627141 &amp; 0.0020106 &amp; 0.0091262 &amp; -0.0129644 &amp; 0.0046316 &amp; -0.0027168 &amp; -0.0122809 &amp; 0.0082589 &amp; 0.0020016 &amp; -0.0072525 &amp; 0.0023557 &amp; 0.0068450 &amp; 0.0091787 &amp; 0.0028864 &amp; -0.0024247 &amp; -0.0117266 &amp; 0.0071120 &amp; 0.0025134 &amp; -0.0346938 &amp; 0.0011385 &amp; 0.0082329 &amp; -0.0007284 &amp; 0.0032610 &amp; -0.0016242 &amp; -0.0116933 &amp; 0.0090980 &amp; 0.0042989 &amp; -0.0757975 &amp; 0.0008009 &amp; 0.0076792 &amp; 0.0030215 &amp; 0.0055552 &amp; -0.0014717 &amp; -0.0053877 &amp; 0.0085691 &amp; 0.0035057\\
0.0019600 &amp; -0.0193976 &amp; 68.9895816 &amp; 0.0024680 &amp; 0.0492101 &amp; 0.0360928 &amp; 0.0049132 &amp; 0.0336695 &amp; 0.0080066 &amp; 0.0035811 &amp; 0.0243152 &amp; 0.0006357 &amp; 0.0014017 &amp; -0.0363329 &amp; 0.0246920 &amp; 0.0064776 &amp; 0.0231545 &amp; 0.0081192 &amp; 0.0044664 &amp; -0.0040587 &amp; 0.0028950 &amp; 0.0033724 &amp; -0.0230345 &amp; 0.0049378 &amp; 0.0081324 &amp; 0.0050949 &amp; 0.0078230 &amp; 0.0051856 &amp; 0.0015064 &amp; 0.0043831 &amp; 0.0043503 &amp; -0.0284443 &amp; -0.0153867 &amp; 0.0079690 &amp; -0.0156489 &amp; 0.0033031 &amp; 0.0045355\\
-0.0013357 &amp; -0.0325770 &amp; -85.0520047 &amp; 81.5662779 &amp; -0.0368089 &amp; -0.0146915 &amp; -0.0103782 &amp; -0.0255875 &amp; -0.0014522 &amp; -0.0057914 &amp; -0.0058940 &amp; -0.0033694 &amp; -0.0013822 &amp; -0.0481718 &amp; -0.0098803 &amp; -0.0111480 &amp; -0.0176665 &amp; -0.0064103 &amp; -0.0064373 &amp; -0.0293940 &amp; -0.0021697 &amp; -0.0010157 &amp; 0.0301017 &amp; 0.0025584 &amp; -0.0104949 &amp; -0.0012315 &amp; -0.0097102 &amp; -0.0050797 &amp; -0.0220407 &amp; -0.0014219 &amp; -0.0024283 &amp; 0.0617079 &amp; 0.0320318 &amp; -0.0132876 &amp; 0.0301315 &amp; -0.0074330 &amp; -0.0028204\\
-0.0002470 &amp; -0.0874258 &amp; -17.8023451 &amp; 12.8901531 &amp; 1.5339513 &amp; 0.0181372 &amp; 0.0032764 &amp; 0.0134782 &amp; 0.0094655 &amp; 0.0032537 &amp; -0.0022668 &amp; 0.0025343 &amp; 0.0023343 &amp; -0.0574902 &amp; -0.0042872 &amp; 0.0036297 &amp; -0.0065671 &amp; 0.0043763 &amp; 0.0005087 &amp; 0.0040175 &amp; 0.0022565 &amp; 0.0008974 &amp; -0.0451420 &amp; -0.0109037 &amp; 0.0042512 &amp; -0.0139335 &amp; 0.0012462 &amp; 0.0000972 &amp; -0.0085726 &amp; 0.0026344 &amp; 0.0043427 &amp; -0.0200519 &amp; 0.0041236 &amp; 0.0040206 &amp; 0.0027081 &amp; -0.0028989 &amp; 0.0008647\\
0.0026115 &amp; -0.0268954 &amp; 19.7197923 &amp; -15.4938081 &amp; -0.5425375 &amp; 2.6289139 &amp; -0.0007355 &amp; 0.0018482 &amp; 0.0089505 &amp; 0.0033771 &amp; 0.0281023 &amp; 0.0029267 &amp; 0.0052289 &amp; -0.0101604 &amp; -0.0034705 &amp; -0.0002265 &amp; -0.0162369 &amp; 0.0072229 &amp; 0.0027654 &amp; 0.0207186 &amp; 0.0026975 &amp; 0.0051488 &amp; -0.0246713 &amp; -0.0137250 &amp; 0.0019969 &amp; -0.0258032 &amp; 0.0076127 &amp; 0.0026118 &amp; -0.0191153 &amp; 0.0036539 &amp; 0.0037529 &amp; 0.0015184 &amp; -0.0045807 &amp; -0.0014300 &amp; -0.0108968 &amp; 0.0035568 &amp; 0.0001801\\
0.0025968 &amp; -0.1525231 &amp; -9.5018498 &amp; 9.4497421 &amp; -0.0335578 &amp; 1.2439949 &amp; 41.2060295 &amp; -0.0064235 &amp; 0.0046869 &amp; 0.0083752 &amp; 0.0170112 &amp; 0.0155463 &amp; 0.0129467 &amp; -0.0115942 &amp; -0.0232625 &amp; 0.0175711 &amp; -0.0124603 &amp; 0.0032826 &amp; 0.0082966 &amp; 0.0303202 &amp; 0.0134353 &amp; 0.0105910 &amp; 0.0022489 &amp; -0.0110610 &amp; 0.0161007 &amp; 0.0010693 &amp; 0.0024537 &amp; 0.0077860 &amp; 0.0277456 &amp; 0.0153405 &amp; 0.0119923 &amp; -0.0068362 &amp; -0.0134922 &amp; 0.0170592 &amp; -0.0018748 &amp; 0.0027227 &amp; 0.0084220\\
0.0010517 &amp; 0.5057888 &amp; 12.6293088 &amp; -14.0147823 &amp; -0.2683598 &amp; -15.5920122 &amp; 0.8639460 &amp; 16.5355933 &amp; -0.0005531 &amp; 0.0020717 &amp; -0.0098602 &amp; 0.0057048 &amp; 0.0019093 &amp; -0.0083492 &amp; -0.0001931 &amp; 0.0062877 &amp; 0.0017033 &amp; -0.0017835 &amp; 0.0023888 &amp; 0.0293790 &amp; 0.0046382 &amp; 0.0008096 &amp; 0.0023579 &amp; 0.0130645 &amp; 0.0049006 &amp; 0.0144078 &amp; 0.0006077 &amp; 0.0034099 &amp; 0.0337168 &amp; 0.0028954 &amp; 0.0017419 &amp; -0.0073439 &amp; 0.0107007 &amp; 0.0048309 &amp; 0.0084793 &amp; 0.0008905 &amp; 0.0042877\\
0.0002310 &amp; -0.2184608 &amp; 63.5594125 &amp; -37.3653775 &amp; -0.1325225 &amp; -1.4269214 &amp; -6.7655254 &amp; 1.3798237 &amp; 24.1742455 &amp; 0.0022982 &amp; -0.0025456 &amp; 0.0044425 &amp; 0.0029149 &amp; -0.0123566 &amp; -0.0128789 &amp; 0.0073494 &amp; -0.0084578 &amp; -0.0083804 &amp; 0.0017961 &amp; 0.0159315 &amp; 0.0064605 &amp; 0.0063121 &amp; 0.0083350 &amp; 0.0147830 &amp; 0.0039980 &amp; 0.0189172 &amp; -0.0084698 &amp; 0.0015786 &amp; 0.0319811 &amp; 0.0066043 &amp; 0.0063728 &amp; 0.0412761 &amp; 0.0327070 &amp; 0.0030349 &amp; 0.0327398 &amp; -0.0064866 &amp; 0.0008587\\
0.0003281 &amp; -0.3325473 &amp; 3.5124310 &amp; -14.2603446 &amp; -0.6129486 &amp; -1.1729924 &amp; -15.3618699 &amp; 0.6572818 &amp; -4.6482752 &amp; 61.1171556 &amp; -0.0036593 &amp; 0.0041819 &amp; 0.0014351 &amp; 0.0028151 &amp; -0.0172025 &amp; 0.0106496 &amp; -0.0128482 &amp; 0.0061165 &amp; 0.0016028 &amp; -0.0013972 &amp; 0.0051489 &amp; 0.0024681 &amp; 0.0006219 &amp; 0.0039639 &amp; 0.0076145 &amp; 0.0055314 &amp; 0.0018970 &amp; -0.0003616 &amp; 0.0101892 &amp; 0.0033006 &amp; 0.0023159 &amp; 0.0292805 &amp; 0.0179816 &amp; 0.0093114 &amp; 0.0179902 &amp; 0.0004080 &amp; -0.0012725\\
\end{array} \right)\, .
\end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ext.data_kappa0 <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.struct.means<span class="sc">$</span>kappa0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
10041.4514444079 \end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>ext.data_kappap <span class="ot">=</span> <span class="fu">pmatrix</span>(ext.struct.means<span class="sc">$</span>kappap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
0.000335382176058349 \end{equation*}\]</span></p>
<p>I plot the histogram of posterior kappa draws. <span class="math inline">\(\kappa_0\)</span> is drawn from an <span class="math inline">\(\mathcal{IG}2\)</span> distribution while <span class="math inline">\(\kappa_+\)</span> is drawn from a <span class="math inline">\(\mathcal{GIG}\)</span> distribution. Both draws are positively skewed with fat tails, with <span class="math inline">\(\kappa_0\)</span> having orders of magnitude higher dispersion.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/ext histogram of kappa draws-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="extension-2-inverse-normal-gamma-prior-hyperparameter-estimation" class="level2">
<h2 class="anchored" data-anchor-id="extension-2-inverse-normal-gamma-prior-hyperparameter-estimation">Extension 2: Inverse Normal Gamma Prior Hyperparameter Estimation</h2>
<section id="prior-distribution-2" class="level3">
<h3 class="anchored" data-anchor-id="prior-distribution-2">Prior Distribution</h3>
<p>Alternatively, I estimate <span class="math inline">\((\kappa_0, \kappa_+)\)</span> assuming that these shrinkage parameters follow an inverse gamma 2 <span class="math inline">\((\mathcal{IG}2)\)</span> distribution. <span class="math display">\[
\begin{align*}
    \kappa_0 | \underline s_{\kappa_0}, \underline \nu_{\kappa_0} \sim \mathcal{IG}2(\underline s_{\kappa_0}, \underline \nu_{\kappa_0})  &amp;&amp; \kappa_+ | \underline s_{\kappa_+}, \underline \nu_{\kappa_+} \sim \mathcal{IG2}(\underline s_{\kappa_+},\underline \nu_{\kappa_+})
  \end{align*}
\]</span> The <code>ext.priors</code> function can be used to initialise these priors as well.</p>
</section>
<section id="posterior-distribution-2" class="level3">
<h3 class="anchored" data-anchor-id="posterior-distribution-2">Posterior Distribution</h3>
<p>Thus, posteriors can be written as <span class="math display">\[
  \begin{align*}
    &amp; p(\kappa_0 | Y, X, B_0) \propto p(B_0|\kappa_0) p(\kappa_0 | \underline s_{\kappa_0}, \underline \nu_{\kappa_0} )\\
    &amp; \propto \prod_{n=1}^{N}\left(\kappa_0^{-\frac{1}{2}}\right)^{r_n} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N b_n V_n (\kappa_0 I_N)^{-1} V_n' b_n'  \right\} \cdot \kappa_0^{-\frac{\underline \nu_{\kappa_0}+2}{2}} \exp \left\{  -\frac{\underline s_{\kappa_0}}{2 \kappa_0} \right\}\\
    &amp; \propto \kappa_0^{ -\frac{\underline \nu_{\kappa_0} + 2 + \sum_{n=1}^{N}r_n}{2}} \cdot \exp \left\{  -\frac{1}{2 \kappa_0} \sum_{n=1}^N b_n V_n V_n' b_n' + \underline s_{\kappa_0} \right\}\\
  \end{align*}
\]</span> This gives <span class="math display">\[\bar s_{\kappa_0} =  \sum_{n=1}^N b_n V_n V_n' b_n' + \underline s_{\kappa_0}.\]</span> <span class="math display">\[\bar \nu_{\kappa_0} = \underline \nu_{\kappa_0} +\sum_{n=1}^{N}r_n\]</span> Also, <span class="math display">\[
  \begin{align*}
    &amp; p(\kappa_+ | Y, X, B_+, B_0, \kappa_0) \propto p(B_+|\kappa_+, B_0, \kappa_0) p(\kappa_+ | \underline s_{\kappa_+}, \underline \nu_{\kappa_+} )\\
    &amp; \propto \kappa_+^{-\frac{KN}{2}} \exp \left\{  -\frac{1}{2} \sum_{n=1}^N (B_{+n} - b_n V_n \underline B) (\kappa_+ I_{K})^{-1} (B_{+n} - b_n V_n \underline B)'  \right\} \cdot \kappa_+^{-\frac{\underline \nu_{\kappa_+} + 2}{2}} \exp \left\{-\frac{\underline s_{\kappa_+}}{2\kappa_+} \right\}\\
    &amp; = \kappa_+^{-\frac{\underline \nu_{\kappa_+} + KN +2}{2}} \cdot \exp \left\{  -\frac{1}{2\kappa_+} \left(\sum_{n=1}^N (B_{+n} - b_n V_n \underline B)  (B_{+n} - b_n V_n \underline B)' + \underline s_{\kappa_+}   \right) \right\}\\
  \end{align*}
\]</span> This gives <span class="math display">\[\bar s_{\kappa_+} = \sum_{n=1}^N (B_{+n} - b_n V_n \underline B)  (B_{+n} - b_n V_n \underline B)'  + \underline s_{\kappa_+}.\]</span> <span class="math display">\[\bar \nu_{\kappa_+} = \underline \nu_{\kappa_+} +KN\]</span></p>
</section>
<section id="gibbs-sampling-2" class="level3">
<h3 class="anchored" data-anchor-id="gibbs-sampling-2">(Gibbs) Sampling</h3>
<p>Given the full conditional posteriors of both <span class="math inline">\((\kappa_0,\kappa_+)\)</span> and <span class="math inline">\((B_0, B_+)\)</span>, we can implement the Gibbs sampler as follows:</p>
<ul>
<li><p>Step 1: Initialise <span class="math inline">\((\kappa_0^{(0)},\kappa_+^{(0)})\)</span>.</p></li>
<li><p>Step 2: Use <span class="math inline">\((\kappa_0^{(s-1)},\kappa_+^{(s-1)})\)</span> values to compute posterior parameters for each draw <span class="math inline">\((\bar B, \bar \Omega, \bar s, \bar \nu)^{(s)}\)</span>.</p></li>
<li><p>Step 3: draw <span class="math inline">\((B_0, B_+)^{(s)} \sim \mathcal{NGN}(\bar B, \bar \Omega, \bar s, \bar \nu)^{(s)}\)</span> using the sampling procedure presented in the baseline model.</p></li>
<li><p>Step 4: draw <span class="math inline">\(\kappa_0^{(s)} \sim p(\kappa_0 | Y, X, B_0^{(s)}) = \mathcal{IG2}(\bar s_{\kappa_0}, \bar \nu_{\kappa_0})\)</span> and <span class="math inline">\(\kappa_+^{(s)} \sim p(\kappa_+ | Y, X, B_0^{(s)}, B_+^{(s)}) = \mathcal{IG2}(\bar s_{\kappa_+}, \bar \nu_{\kappa_+})\)</span>.</p></li>
</ul>
<p>Repeat steps 2-4 to get desired sample size and burn in some initial sample observations as needed.</p>
<p>The sampling function <code>ext2.sampling</code> is given below.</p>
<div class="cell">
<details>
<summary>Code: Sampler for Extension 2</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>ext2.sampling <span class="ot">=</span> <span class="cf">function</span>(parameters, struct, priors, usedata){</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  B0Vlist.initial <span class="ot">=</span> <span class="fu">ltexclusion</span>(usedata)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  B0.initial <span class="ot">=</span> B0Vlist.initial<span class="sc">$</span>B0</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(parameters<span class="sc">$</span>S <span class="sc">+</span> parameters<span class="sc">$</span>S.burnin)){</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Computing posterior parameters for each draw</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    Omega.inv      <span class="ot">=</span> <span class="fu">solve</span>(struct<span class="sc">$</span>kappap[i] <span class="sc">*</span> priors<span class="sc">$</span>Omega)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    Omega.post.inv <span class="ot">=</span> usedata<span class="sc">$</span>X<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>X) <span class="sc">+</span> Omega.inv</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    Omega.post     <span class="ot">=</span> <span class="fu">solve</span>(Omega.post.inv)</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    B.post         <span class="ot">=</span> (usedata<span class="sc">$</span>Y<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>X) <span class="sc">+</span> priors<span class="sc">$</span>B<span class="sc">%*%</span>Omega.inv) <span class="sc">%*%</span> Omega.post</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    S.post         <span class="ot">=</span> usedata<span class="sc">$</span>Y<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>Y) <span class="sc">+</span> <span class="fu">solve</span>(struct<span class="sc">$</span>kappa0[i] <span class="sc">*</span> priors<span class="sc">$</span>S) <span class="sc">+</span> priors<span class="sc">$</span>B<span class="sc">%*%</span>Omega.inv<span class="sc">%*%</span><span class="fu">t</span>(priors<span class="sc">$</span>B) <span class="sc">-</span> B.post<span class="sc">%*%</span>Omega.post.inv<span class="sc">%*%</span><span class="fu">t</span>(B.post)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    nu.post        <span class="ot">=</span> <span class="fu">ncol</span>(usedata<span class="sc">$</span>Y) <span class="sc">+</span> priors<span class="sc">$</span>nu</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    B0.initial <span class="ot">=</span> struct<span class="sc">$</span>B0.post[,,i<span class="dv">-1</span>]</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  B0.i <span class="ot">=</span> <span class="fu">rgn</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">S.inv =</span> S.post, <span class="at">nu =</span> nu.post, <span class="at">V =</span> B0Vlist.initial<span class="sc">$</span>V, <span class="at">B0.initial =</span> B0.initial)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B0.hat = t(chol((nu.post - usedata$N)*S.post))</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B0.norm.i = normalize.Gibbs.output.parallel(B0.i, B0.hat)</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a>  Bp.i <span class="ot">=</span> <span class="fu">rnorm.ngn</span>(B0.i, B.post, Omega.post)</span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>B0.posterior[,,i] <span class="ot">=</span> B0.i</span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>Bp.posterior[,,i] <span class="ot">=</span> Bp.i</span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Now, update kappa</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>  kappa0.nu.post <span class="ot">=</span> priors<span class="sc">$</span>kappa0.nu <span class="sc">+</span> (usedata<span class="sc">$</span>N<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a>  kappap.nu.post <span class="ot">=</span> priors<span class="sc">$</span>kappap.nu <span class="sc">+</span> usedata<span class="sc">$</span>K <span class="sc">*</span> usedata<span class="sc">$</span>N</span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>  kappa0.s.post  <span class="ot">=</span> priors<span class="sc">$</span>kappa0.s</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a>  kappap.s.post  <span class="ot">=</span> priors<span class="sc">$</span>kappap.s</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># kappap.chi.post = 0</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>usedata<span class="sc">$</span>N){</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a>    kappa0.s.post <span class="ot">=</span> kappa0.s.post <span class="sc">+</span> <span class="fu">sum</span>(B0.i[n,,<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a>    kappap.s.post <span class="ot">=</span> kappap.s.post <span class="sc">+</span> (Bp.i[n,,<span class="dv">1</span>] <span class="sc">-</span> B0.i[n,,<span class="dv">1</span>] <span class="sc">%*%</span> priors<span class="sc">$</span>B)<span class="sc">%*%</span><span class="fu">t</span>(Bp.i[n,,<span class="dv">1</span>] <span class="sc">-</span> B0.i[n,,<span class="dv">1</span>] <span class="sc">%*%</span> priors<span class="sc">$</span>B)</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">!=</span> (parameters<span class="sc">$</span>S <span class="sc">+</span> parameters<span class="sc">$</span>S.burnin)){</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a>    struct<span class="sc">$</span>kappa0[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> kappa0.s.post <span class="sc">/</span> <span class="fu">rchisq</span>(<span class="at">n=</span><span class="dv">1</span>,<span class="at">df =</span> kappa0.nu.post)</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a>    struct<span class="sc">$</span>kappap[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">=</span> kappap.s.post <span class="sc">/</span> <span class="fu">rchisq</span>(<span class="at">n=</span><span class="dv">1</span>,<span class="at">df =</span> kappap.nu.post)</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>kappa0 <span class="ot">=</span> struct<span class="sc">$</span>kappa0[(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>kappap <span class="ot">=</span> struct<span class="sc">$</span>kappap[(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>B0.posterior <span class="ot">=</span> struct<span class="sc">$</span>B0.posterior[,,(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>Bp.posterior <span class="ot">=</span> struct<span class="sc">$</span>Bp.posterior[,,(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set normalising matrix</span></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a>  B0.last_draw <span class="ot">=</span> struct<span class="sc">$</span>B0.posterior[,,parameters<span class="sc">$</span>S]</span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a>  B0_hat <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">sign</span>(<span class="fu">diag</span>(B0.last_draw))) <span class="sc">%*%</span> B0.last_draw</span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute normalised B0</span></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a>  B0.norm <span class="ot">=</span> <span class="fu">normalize.Gibbs.output.parallel</span>(struct<span class="sc">$</span>B0.posterior, B0_hat)</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute normalised BP</span></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>parameters<span class="sc">$</span>S){</span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a>    struct<span class="sc">$</span>Bp.posterior[,,i] <span class="ot">=</span> B0.norm[,,i] <span class="sc">%*%</span> <span class="fu">solve</span>(struct<span class="sc">$</span>B0.posterior[,,i]) <span class="sc">%*%</span> struct<span class="sc">$</span>Bp.posterior[,,i]</span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save normalised B0</span></span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>B0.posterior <span class="ot">=</span> B0.norm</span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(struct)</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="simulation-run-2" class="level3">
<h3 class="anchored" data-anchor-id="simulation-run-2">Simulation Run</h3>
<p><strong><em>Step 1:</em></strong> The following code computes the prior, initialises matrices to store results, and samples the draws for the simulated data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ext2.sim.prior <span class="ot">=</span> <span class="fu">ext.priors</span>(parameters, artificialdata)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>ext2.sim.struct <span class="ot">=</span> <span class="fu">init.struct</span>(artificialdata, parameters<span class="sc">$</span>S <span class="sc">+</span> parameters<span class="sc">$</span>S.burnin)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>ext2.sim.struct <span class="ot">&lt;-</span> <span class="fu">ext2.sampling</span>(parameters, ext2.sim.struct, ext2.sim.prior, artificialdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p><strong><em>Step 2:</em></strong> The following code computes and stores the posterior means of <span class="math inline">\(\{\kappa_0^{(s)}, \kappa_+^{(s)}, B_0^{(s)}, B_+^{(s)}\}_{s =1}^{S}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>ext2.sim.struct.means <span class="ot">=</span> <span class="fu">structPosteriorMeans</span>(ext2.sim.struct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong><em>Step 3:</em></strong> The code snippets below display the sample posterior means of the estimated objects using simulated data.</p>
<p>The following code computes the posterior mean of <span class="math inline">\(B_0\)</span>.</p>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>ext2.sim.data_B0 <span class="ot">=</span> <span class="fu">pmatrix</span>(ext2.sim.struct.means<span class="sc">$</span>B0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{cc}
1.0073681 &amp; 0.0000000\\
-0.0376612 &amp; 0.9998389\\
\end{array} \right)\, .
\end{equation*}\]</span></p>
<p>The following code computes the posterior mean of <span class="math inline">\(B_+\)</span>.</p>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>ext2.sim.data_Bp <span class="ot">=</span> <span class="fu">pmatrix</span>(ext2.sim.struct.means<span class="sc">$</span>Bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccc}
0.2204220 &amp; 0.9993695 &amp; -0.0071743\\
-0.1337387 &amp; -0.0462213 &amp; 0.9789904\\
\end{array} \right)\, .
\end{equation*}\]</span></p>
<p>Again, we can see that the first column of the autoregressive matrix is close to zero, while the rest of the <span class="math inline">\(B_+\)</span> matrix and the <span class="math inline">\(B_0\)</span> matrix both are numerically close to an identity matrix. Thus, we can see that this sampler also works since the posterior draws replicate the data-generating process.</p>
<p>The following code computes the posterior mean of <span class="math inline">\(\kappa_0\)</span>.</p>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>ext2.sim.data_kappa0 <span class="ot">=</span> <span class="fu">pmatrix</span>(ext2.sim.struct.means<span class="sc">$</span>kappa0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
11.4691748966645 \end{equation*}\]</span></p>
<p>The following code computes the posterior mean of <span class="math inline">\(\kappa_+\)</span>.</p>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>ext2.sim.data_kappap <span class="ot">=</span> <span class="fu">pmatrix</span>(ext2.sim.struct.means<span class="sc">$</span>kappap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
0.0363343747034034 \end{equation*}\]</span></p>
<p>I plot the histogram of posterior kappa draws. both <span class="math inline">\(\kappa_0\)</span> and <span class="math inline">\(\kappa_+\)</span> are drawn from an <span class="math inline">\(\mathcal{IG}2\)</span> distribution. <span class="math inline">\(\kappa_0\)</span> draws are more positively skewed while <span class="math inline">\(\kappa_+\)</span> draws have fatter tails, with <span class="math inline">\(\kappa_0\)</span> having orders of magnitude higher dispersion.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/ext2 histogram of kappa draws simulated data-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="data-results-2" class="level3">
<h3 class="anchored" data-anchor-id="data-results-2">Data Results</h3>
<p><strong><em>Step 1:</em></strong> The following code computes the prior, initialises matrices to store results, and samples the draws for the actual data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>ext2.prior  <span class="ot">=</span> <span class="fu">ext.priors</span>(parameters, mydata)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>ext2.struct <span class="ot">=</span> <span class="fu">init.struct</span>(mydata, parameters<span class="sc">$</span>S <span class="sc">+</span> parameters<span class="sc">$</span>S.burnin)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>ext2.struct <span class="ot">=</span> <span class="fu">ext2.sampling</span>(parameters, ext2.struct, ext2.prior, mydata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p><strong><em>Step 2:</em></strong> The following code computes and stores the posterior means of <span class="math inline">\(\{\kappa_0^{(s)}, \kappa_+^{(s)}, B_0^{(s)}, B_+^{(s)}\}_{s =1}^{S}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>ext2.struct.means <span class="ot">=</span> <span class="fu">structPosteriorMeans</span>(ext2.struct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong><em>Step 3:</em></strong> The code snippets below display the sample posterior means of the estimated objects using actual data.</p>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>ext2.data_B0 <span class="ot">=</span> <span class="fu">pmatrix</span>(ext2.struct.means<span class="sc">$</span>B0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccccccccc}
5.6718944 &amp; 0.000000 &amp; 0.000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.00000 &amp; 0.000000 &amp; 0.000000 &amp; 0.000\\
-0.0273124 &amp; 157.488453 &amp; 0.000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.00000 &amp; 0.000000 &amp; 0.000000 &amp; 0.000\\
-0.0461100 &amp; -156.977931 &amp; 177.963457 &amp; 0.0000000 &amp; 0.000000 &amp; 0.00000 &amp; 0.000000 &amp; 0.000000 &amp; 0.000\\
-1.2969752 &amp; -41.140138 &amp; 68.143455 &amp; 3.0467691 &amp; 0.000000 &amp; 0.00000 &amp; 0.000000 &amp; 0.000000 &amp; 0.000\\
-0.3818882 &amp; -11.357059 &amp; 49.698205 &amp; 1.0293569 &amp; 7.681123 &amp; 0.00000 &amp; 0.000000 &amp; 0.000000 &amp; 0.000\\
-0.8197342 &amp; 23.421987 &amp; -30.102558 &amp; 0.0444387 &amp; 2.958030 &amp; 71.07923 &amp; 0.000000 &amp; 0.000000 &amp; 0.000\\
0.1443461 &amp; 12.118407 &amp; -45.706646 &amp; -0.6425245 &amp; -27.857916 &amp; 17.96374 &amp; 30.232042 &amp; 0.000000 &amp; 0.000\\
0.2652278 &amp; 3.283602 &amp; 9.517422 &amp; -0.5261508 &amp; -13.151384 &amp; -14.25740 &amp; 11.923988 &amp; 84.069764 &amp; 0.000\\
-0.6212226 &amp; 37.757027 &amp; -48.500160 &amp; -0.5844651 &amp; -2.836866 &amp; -18.56573 &amp; 1.651438 &amp; 9.427724 &amp; 131.247\\
\end{array} \right)\, .
\end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>ext2.data_Bp <span class="ot">=</span> <span class="fu">pmatrix</span>(ext2.struct.means<span class="sc">$</span>Bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccccccccccccccccccccccccccccccccccccc}
148.83839 &amp; 5.3309888 &amp; -16.5399816 &amp; -65.139975 &amp; -0.8184171 &amp; -16.9082769 &amp; 18.454651 &amp; 18.8524738 &amp; 10.377678 &amp; -43.430458 &amp; 0.1767701 &amp; 4.897775 &amp; 68.700152 &amp; 1.8279261 &amp; 3.8148051 &amp; -48.00301 &amp; -7.0593136 &amp; 13.027840 &amp; 82.96147 &amp; 4.3850084 &amp; -95.042513 &amp; 43.399231 &amp; -0.8480066 &amp; 1.536322 &amp; 26.7680606 &amp; -0.7497490 &amp; -9.506794 &amp; -68.906575 &amp; -3.4920268 &amp; 42.075190 &amp; -27.496283 &amp; 1.4879248 &amp; -6.6471632 &amp; -2.657105 &amp; 8.5334864 &amp; -0.5403699 &amp; 42.497880\\
173.98857 &amp; -0.4355099 &amp; 119.4288546 &amp; -28.955304 &amp; 1.4683824 &amp; -3.9377585 &amp; -3.054198 &amp; 5.3969891 &amp; -9.602811 &amp; 38.900258 &amp; 1.2929133 &amp; 44.662539 &amp; -64.476567 &amp; -1.8933480 &amp; -3.9389449 &amp; -14.72159 &amp; 3.2700886 &amp; 16.392721 &amp; -9.39083 &amp; 0.8966464 &amp; -84.582249 &amp; 36.793230 &amp; 1.2396985 &amp; -4.186261 &amp; 8.3715664 &amp; 4.6853446 &amp; 3.890398 &amp; -57.687904 &amp; -0.3776933 &amp; 67.093179 &amp; 12.889412 &amp; -0.4350543 &amp; 0.5629730 &amp; -2.054345 &amp; 0.2746982 &amp; -0.1022587 &amp; 55.574511\\
77.46888 &amp; -0.2752492 &amp; -105.7500716 &amp; 94.348470 &amp; -0.0399379 &amp; -0.9415106 &amp; -17.726319 &amp; -0.9814657 &amp; 5.282810 &amp; 39.724128 &amp; 1.8318689 &amp; -9.697084 &amp; -10.929341 &amp; -1.3059432 &amp; 4.9134854 &amp; 15.02808 &amp; -4.7788873 &amp; 14.462009 &amp; -63.10994 &amp; -1.9805265 &amp; 22.998928 &amp; 21.731501 &amp; 0.9989375 &amp; 9.191216 &amp; -7.8715702 &amp; -9.1679089 &amp; -21.933442 &amp; 46.365522 &amp; 0.6594339 &amp; 16.954386 &amp; -20.971842 &amp; -1.2648226 &amp; -8.7677199 &amp; -16.696077 &amp; 9.5130383 &amp; 15.7274966 &amp; 1.720153\\
-16.61318 &amp; -0.4373317 &amp; 0.2768244 &amp; 8.031851 &amp; 2.1410145 &amp; 0.2792470 &amp; -9.101319 &amp; -0.0058920 &amp; 20.183303 &amp; 37.835615 &amp; -1.7039023 &amp; 10.728812 &amp; 9.447569 &amp; -1.3486034 &amp; 2.3169971 &amp; 14.17427 &amp; 0.0235370 &amp; -18.247401 &amp; -48.40851 &amp; 1.7198763 &amp; 47.964260 &amp; -46.221512 &amp; -0.7450552 &amp; -2.266951 &amp; -23.9435479 &amp; -0.3361125 &amp; 22.760023 &amp; -8.161729 &amp; -0.6389818 &amp; -48.392359 &amp; 49.029764 &amp; -0.7671451 &amp; 1.8196467 &amp; 2.768817 &amp; -0.1850121 &amp; -6.4154614 &amp; 26.438087\\
240.36225 &amp; -2.1621400 &amp; 9.5975552 &amp; -30.939133 &amp; 0.9303763 &amp; 8.2217405 &amp; -1.055747 &amp; 1.3220532 &amp; 25.220516 &amp; 18.432606 &amp; -1.1775696 &amp; 90.794148 &amp; -50.021979 &amp; -1.8986220 &amp; 1.4891556 &amp; -18.19382 &amp; -1.1106618 &amp; -30.083022 &amp; 21.96696 &amp; 9.6532433 &amp; -75.874111 &amp; 27.604014 &amp; -0.4615813 &amp; -7.979546 &amp; 4.1705353 &amp; 0.7003847 &amp; 27.796161 &amp; -38.164767 &amp; -5.7677260 &amp; 15.141673 &amp; -6.521052 &amp; 0.5438016 &amp; 1.0691022 &amp; -13.873838 &amp; 3.7315832 &amp; -6.3966803 &amp; 37.913107\\
85.12668 &amp; 0.0672991 &amp; 6.9247644 &amp; -1.258260 &amp; 0.0287063 &amp; -2.6013603 &amp; 34.878551 &amp; 3.1024440 &amp; 12.069626 &amp; -3.340036 &amp; -2.8299914 &amp; 37.239501 &amp; -18.318571 &amp; -0.2295618 &amp; 8.3344360 &amp; 11.83161 &amp; -5.7001635 &amp; -23.824327 &amp; 41.90223 &amp; 1.2297163 &amp; 26.489306 &amp; -24.084121 &amp; -0.1493415 &amp; -7.365010 &amp; -0.0911076 &amp; 7.6457160 &amp; -8.070990 &amp; -63.439662 &amp; 1.9670759 &amp; -26.784691 &amp; 2.860494 &amp; -0.3845171 &amp; 0.0757078 &amp; 26.281401 &amp; -2.5442732 &amp; 23.5453781 &amp; -10.380211\\
-66.04262 &amp; -0.3593826 &amp; -1.8979333 &amp; -25.953600 &amp; 0.0112414 &amp; -10.3505388 &amp; 15.905061 &amp; 12.1186792 &amp; -32.300597 &amp; -9.262573 &amp; -2.2241537 &amp; 60.239550 &amp; -59.437456 &amp; -1.2207345 &amp; -0.6870882 &amp; 12.59403 &amp; 0.2727016 &amp; 19.760702 &amp; 15.15272 &amp; 1.2994895 &amp; -3.860637 &amp; -5.885231 &amp; 0.5892055 &amp; 3.571515 &amp; -12.4100622 &amp; -4.6780836 &amp; -18.421432 &amp; 3.718812 &amp; -0.1750160 &amp; 10.119309 &amp; 17.081426 &amp; -1.2902187 &amp; 1.0004806 &amp; 18.121703 &amp; -1.1713467 &amp; 11.2164120 &amp; -22.032515\\
76.00441 &amp; -0.3726850 &amp; 22.9648116 &amp; -44.437732 &amp; -2.0928754 &amp; -9.2502618 &amp; -2.909927 &amp; 6.5037015 &amp; 86.909936 &amp; 8.603577 &amp; 1.2656742 &amp; -89.390870 &amp; -28.814648 &amp; 0.5433249 &amp; -0.3571768 &amp; 10.08736 &amp; -1.3008940 &amp; -11.992170 &amp; 13.31016 &amp; -1.4022971 &amp; 69.383448 &amp; 77.326834 &amp; 0.9982241 &amp; -1.512581 &amp; -13.1338044 &amp; 4.4437500 &amp; -10.777119 &amp; 18.442003 &amp; 0.8410054 &amp; -20.783491 &amp; 8.393031 &amp; -0.4907697 &amp; -2.4312918 &amp; -5.815070 &amp; 2.7427959 &amp; -2.2651916 &amp; -26.365750\\
-60.47481 &amp; -1.7630355 &amp; 38.4082900 &amp; -12.476770 &amp; -1.2031900 &amp; 6.0642918 &amp; -10.857455 &amp; -6.6125142 &amp; 13.232256 &amp; 172.226706 &amp; 1.6707359 &amp; -50.033183 &amp; -5.945496 &amp; -0.1645032 &amp; -16.5319944 &amp; 17.84582 &amp; 15.8421405 &amp; -4.538808 &amp; -51.45014 &amp; -1.4629407 &amp; -3.106570 &amp; 32.815059 &amp; 0.6550867 &amp; -3.381337 &amp; -33.9301527 &amp; 4.4163894 &amp; 23.023952 &amp; -18.270955 &amp; 1.2748915 &amp; -9.565553 &amp; 12.402129 &amp; 1.0338064 &amp; 1.2905485 &amp; 24.312014 &amp; -0.1135499 &amp; -16.2761077 &amp; -1.512115\\
\end{array} \right)\, .
\end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>ext2.data_kappa0 <span class="ot">=</span> <span class="fu">pmatrix</span>(ext2.struct.means<span class="sc">$</span>kappa0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
39566.4973894281 \end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>ext2.data_kappap <span class="ot">=</span> <span class="fu">pmatrix</span>(ext2.struct.means<span class="sc">$</span>kappap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
1403.70139144985 \end{equation*}\]</span></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/ext2 histogram of kappa draws-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="extension-3-stochastic-volatility" class="level2">
<h2 class="anchored" data-anchor-id="extension-3-stochastic-volatility">Extension 3: Stochastic Volatility</h2>
<p>Next, I introduce stochastic volatility in the form of common conditional heteroskedasticity of the structural errors. We assume that <span class="math display">\[
u_t|X \sim N_N(0_N, diag(\sigma^2_t I_n))
\]</span> where <span class="math inline">\(\sigma^2 = (\exp(h_1), \dots, \exp(h_T))\)</span> is the <span class="math inline">\(T-\)</span>vector. This introduction of stochastic volatility transforms the posterior parameters of <span class="math inline">\((B_+,B_0)\)</span> as follows: <span class="math display">\[
\begin{align*}
&amp;\bar \Omega = (X diag(\sigma^2)^{-1} X' + \underline \Omega^{-1})^{-1}\\
&amp;\bar B = (Ydiag(\sigma^2)^{-1}X' + \underline B \underline \Omega^{-1}) \bar \Omega\\
&amp;\bar S = (Ydiag(\sigma^2)^{-1}Y' + \underline S^{-1} + \underline B \underline \Omega^{-1} \underline B' - \bar B \bar \Omega^{-1} \bar B')^{-1}
\end{align*}
\]</span> while <span class="math inline">\(\bar \nu = T + \underline \nu\)</span> updates the same way as before.</p>
<section id="gibbs-sampling-3" class="level3">
<h3 class="anchored" data-anchor-id="gibbs-sampling-3">(Gibbs) Sampling</h3>
<div class="cell">

</div>
<div class="cell">

</div>
<p>The Gibbs sampler for the stochastic volatility component is implemented in the <code>SVcommonSF.Gibbs.iteration</code> function below.</p>
<div class="cell">
<details>
<summary>Common SV component sampler</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># prepared by Tomasz Woźniak</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="do">############################################################</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>SVcommonSF.Gibbs.iteration <span class="ot">=</span> <span class="cf">function</span>(aux, priors){</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># A single iteration of the Gibbs sampler for the SV component</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># aux is a list containing:</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   Y - a NxT matrix</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   X - a KxT matrix</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   H - a Tx1 matrix</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   h0 - a scalar</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   sigma.v2 - a scalar</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   s - a Tx1 matrix</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   Bplus - a NxK matrix</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   B0 - an NxN matrix</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   sigma2 - a T-vector</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># priors is a list containing:</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   h0.v - a positive scalar</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   h0.m - a scalar</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   sigmav.s - a positive scalar</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   sigmav.nu - a positive scalar</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   HH - a TxT matrix</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>  T             <span class="ot">=</span> <span class="fu">dim</span>(aux<span class="sc">$</span>Y)[<span class="dv">2</span>]</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>  N             <span class="ot">=</span> <span class="fu">dim</span>(aux<span class="sc">$</span>Y)[<span class="dv">1</span>]</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>  alpha.st      <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.92677</span>,<span class="fl">1.34744</span>,<span class="fl">0.73504</span>,<span class="fl">0.02266</span>,<span class="dv">0</span><span class="fl">-0.85173</span>,<span class="sc">-</span><span class="fl">1.97278</span>,<span class="sc">-</span><span class="fl">3.46788</span>,<span class="sc">-</span><span class="fl">5.55246</span>,<span class="sc">-</span><span class="fl">8.68384</span>,<span class="sc">-</span><span class="fl">14.65000</span>)</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>  sigma.st      <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.11265</span>,<span class="fl">0.17788</span>,<span class="fl">0.26768</span>,<span class="fl">0.40611</span>,<span class="fl">0.62699</span>,<span class="fl">0.98583</span>,<span class="fl">1.57469</span>,<span class="fl">2.54498</span>,<span class="fl">4.16591</span>,<span class="fl">7.33342</span>)</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>  pi.st         <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.00609</span>,<span class="fl">0.04775</span>,<span class="fl">0.13057</span>,<span class="fl">0.20674</span>,<span class="fl">0.22715</span>,<span class="fl">0.18842</span>,<span class="fl">0.12047</span>,<span class="fl">0.05591</span>,<span class="fl">0.01575</span>,<span class="fl">0.00115</span>)</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>  Z             <span class="ot">=</span> <span class="fu">rowSums</span>( <span class="fu">t</span>( aux<span class="sc">$</span>B0 <span class="sc">%*%</span> aux<span class="sc">$</span>Y <span class="sc">-</span> aux<span class="sc">$</span>Bplus <span class="sc">%*%</span> aux<span class="sc">$</span>X ) ) <span class="sc">/</span> <span class="fu">sqrt</span>(N)</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>  Y.tilde       <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">log</span>((Z <span class="sc">+</span> <span class="fl">0.0000001</span>)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>  Ytilde.alpha  <span class="ot">=</span> <span class="fu">as.matrix</span>(Y.tilde <span class="sc">-</span> alpha.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s)])</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sampling initial condition</span></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>  V.h0.bar      <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>((<span class="dv">1</span> <span class="sc">/</span> priors<span class="sc">$</span>h0.v) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2))</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>  m.h0.bar      <span class="ot">=</span> V.h0.bar<span class="sc">*</span>((priors<span class="sc">$</span>h0.m <span class="sc">/</span> priors<span class="sc">$</span>h0.v) <span class="sc">+</span> (aux<span class="sc">$</span>H[<span class="dv">1</span>] <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2))</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>  h0.draw       <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> m.h0.bar, <span class="at">sd =</span> <span class="fu">sqrt</span>(V.h0.bar))</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>h0        <span class="ot">=</span> h0.draw</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sampling sigma.v2</span></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>  sigma.v2.s    <span class="ot">=</span> priors<span class="sc">$</span>sigmav.s <span class="sc">+</span> <span class="fu">sum</span>(<span class="fu">c</span>(aux<span class="sc">$</span>H[<span class="dv">1</span>] <span class="sc">-</span> aux<span class="sc">$</span>h0, <span class="fu">diff</span>(aux<span class="sc">$</span>H))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>  sigma.v2.draw <span class="ot">=</span> sigma.v2.s <span class="sc">/</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, priors<span class="sc">$</span>sigmav.nu <span class="sc">+</span> T)</span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>sigma.v2  <span class="ot">=</span> sigma.v2.draw</span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sampling auxiliary states</span></span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>  Pr.tmp        <span class="ot">=</span> <span class="fu">simplify2array</span>(<span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,<span class="cf">function</span>(x){</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dnorm</span>(Y.tilde, <span class="at">mean =</span> <span class="fu">as.vector</span>(aux<span class="sc">$</span>H <span class="sc">+</span> alpha.st[x]), <span class="at">sd =</span> <span class="fu">sqrt</span>(sigma.st[x]), <span class="at">log =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> <span class="fu">log</span>(pi.st[x])</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>  Pr            <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(Pr.tmp, <span class="dv">1</span>, <span class="cf">function</span>(x){<span class="fu">exp</span>(x <span class="sc">-</span> <span class="fu">max</span>(x)) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">exp</span>(x <span class="sc">-</span> <span class="fu">max</span>(x)))}))</span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>  s.cum         <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(Pr, <span class="dv">1</span>, cumsum))</span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a>  r             <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">runif</span>(T), <span class="dv">10</span>), <span class="at">ncol =</span> <span class="dv">10</span>)</span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a>  ss            <span class="ot">=</span> <span class="fu">apply</span>(s.cum <span class="sc">&lt;</span> r, <span class="dv">1</span>, sum) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>s         <span class="ot">=</span> <span class="fu">as.matrix</span>(ss)</span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sampling log-volatilities using functions for tridiagonal precision matrix</span></span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################</span></span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a>  Sigma.s.inv   <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">1</span> <span class="sc">/</span> sigma.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s)])</span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a>  D.inv         <span class="ot">=</span> Sigma.s.inv <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> aux<span class="sc">$</span>sigma.v2) <span class="sc">*</span> priors<span class="sc">$</span>HH</span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a>  b             <span class="ot">=</span> <span class="fu">as.matrix</span>(Ytilde.alpha <span class="sc">/</span> sigma.st[<span class="fu">as.vector</span>(aux<span class="sc">$</span>s)] <span class="sc">+</span> (aux<span class="sc">$</span>h0<span class="sc">/</span>aux<span class="sc">$</span>sigma.v2)<span class="sc">*</span><span class="fu">diag</span>(T)[,<span class="dv">1</span>])</span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a>  lead.diag     <span class="ot">=</span> <span class="fu">diag</span>(D.inv)</span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a>  sub.diag      <span class="ot">=</span> mgcv<span class="sc">::</span><span class="fu">sdiag</span>(D.inv, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb51-68"><a href="#cb51-68" aria-hidden="true" tabindex="-1"></a>  D.chol        <span class="ot">=</span> mgcv<span class="sc">::</span><span class="fu">trichol</span>(<span class="at">ld =</span> lead.diag, <span class="at">sd =</span> sub.diag)</span>
<span id="cb51-69"><a href="#cb51-69" aria-hidden="true" tabindex="-1"></a>  D.L           <span class="ot">=</span> <span class="fu">diag</span>(D.chol<span class="sc">$</span>ld)</span>
<span id="cb51-70"><a href="#cb51-70" aria-hidden="true" tabindex="-1"></a>  mgcv<span class="sc">::</span><span class="fu">sdiag</span>(D.L,<span class="sc">-</span><span class="dv">1</span>) <span class="ot">=</span> D.chol<span class="sc">$</span>sd</span>
<span id="cb51-71"><a href="#cb51-71" aria-hidden="true" tabindex="-1"></a>  x             <span class="ot">=</span> <span class="fu">as.matrix</span>(<span class="fu">rnorm</span>(T))</span>
<span id="cb51-72"><a href="#cb51-72" aria-hidden="true" tabindex="-1"></a>  a             <span class="ot">=</span> <span class="fu">forwardsolve</span>(D.L, b)</span>
<span id="cb51-73"><a href="#cb51-73" aria-hidden="true" tabindex="-1"></a>  draw          <span class="ot">=</span> <span class="fu">backsolve</span>(<span class="fu">t</span>(D.L), a <span class="sc">+</span> x)</span>
<span id="cb51-74"><a href="#cb51-74" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>H         <span class="ot">=</span> <span class="fu">as.matrix</span>(draw)</span>
<span id="cb51-75"><a href="#cb51-75" aria-hidden="true" tabindex="-1"></a>  aux<span class="sc">$</span>sigma2    <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">exp</span>(draw))</span>
<span id="cb51-76"><a href="#cb51-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-77"><a href="#cb51-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(aux)</span>
<span id="cb51-78"><a href="#cb51-78" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code: Gibbs Sampler for Extension 3</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>ext3.sampling <span class="ot">=</span> <span class="cf">function</span>(parameters, struct, priors, usedata){</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  T <span class="ot">=</span> <span class="fu">ncol</span>((usedata<span class="sc">$</span>Y))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 0: initialize B_0 and B_+</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  B0Vlist.initial     <span class="ot">=</span> <span class="fu">ltexclusion</span>(usedata)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  Omega.inv           <span class="ot">=</span> <span class="fu">solve</span>(priors<span class="sc">$</span>Omega)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  Omega.post.inv <span class="ot">=</span> usedata<span class="sc">$</span>X<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>X) <span class="sc">+</span> Omega.inv</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  Omega.post     <span class="ot">=</span> <span class="fu">solve</span>(Omega.post.inv)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  B.post         <span class="ot">=</span> (usedata<span class="sc">$</span>Y<span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>X) <span class="sc">+</span> priors<span class="sc">$</span>B<span class="sc">%*%</span>Omega.inv) <span class="sc">%*%</span> Omega.post</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  nu.post        <span class="ot">=</span> <span class="fu">ncol</span>(usedata<span class="sc">$</span>Y) <span class="sc">+</span> priors<span class="sc">$</span>nu</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(parameters<span class="sc">$</span>S <span class="sc">+</span> parameters<span class="sc">$</span>S.burnin)){</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set in-loop definition of B0.post and Bp.post</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    B0.post <span class="ot">=</span> B0Vlist.initial<span class="sc">$</span>B0</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>    Bp.post <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">array</span>(<span class="dv">0</span>,<span class="fu">c</span>(N,<span class="dv">1</span>)), <span class="fu">array</span>(<span class="fu">diag</span>(N),<span class="fu">c</span>(usedata<span class="sc">$</span>N, usedata<span class="sc">$</span>N <span class="sc">*</span> usedata<span class="sc">$</span>p))) </span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    B0.post <span class="ot">=</span> struct<span class="sc">$</span>B0.posterior[,,i<span class="dv">-1</span>]</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    Bp.post <span class="ot">=</span> struct<span class="sc">$</span>Bp.posterior[,,i<span class="dv">-1</span>]</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 1a: Now, update kappa0 and kappa_+ posteriors</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  kappa0.nu.post <span class="ot">=</span> priors<span class="sc">$</span>kappa0.nu <span class="sc">+</span> (usedata<span class="sc">$</span>N<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>  kappap.lambda.post <span class="ot">=</span> <span class="sc">-</span>(<span class="sc">-</span>priors<span class="sc">$</span>kappap.nu <span class="sc">+</span> usedata<span class="sc">$</span>K <span class="sc">*</span> usedata<span class="sc">$</span>N)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>  kappap.psi.post <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>priors<span class="sc">$</span>kappap.s</span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>  kappa0.s.post <span class="ot">=</span> priors<span class="sc">$</span>kappa0.s</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>usedata<span class="sc">$</span>N){</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>    kappa0.s.post <span class="ot">=</span> kappa0.s.post <span class="sc">+</span> <span class="fu">sum</span>(B0.post<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>    kappap.chi.post <span class="ot">=</span> (Bp.post <span class="sc">-</span> B0.post <span class="sc">%*%</span> B.post) <span class="sc">%*%</span> <span class="fu">t</span>(Bp.post <span class="sc">-</span> B0.post <span class="sc">%*%</span> B.post)</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 1b: draw kappa0 from IG2 and kappa_+ from GIG distributions</span></span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>kappa0[i] <span class="ot">=</span> kappa0.s.post <span class="sc">/</span> <span class="fu">rchisq</span>(<span class="at">n=</span><span class="dv">1</span>,<span class="at">df =</span> kappa0.nu.post)</span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>kappap[i] <span class="ot">=</span> GIGrvg<span class="sc">::</span><span class="fu">rgig</span>(<span class="at">n=</span><span class="dv">1</span>, kappap.lambda.post, kappap.chi.post, kappap.psi.post)</span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Step 2a: initialise inputs aux and prior</span></span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>  aux <span class="ot">=</span> <span class="fu">SVaux</span>(usedata<span class="sc">$</span>Y, usedata<span class="sc">$</span>X, B0.post, Bp.post, T)</span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>  SVprior <span class="ot">=</span> <span class="fu">SVpriors</span>(T)</span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 2b: draw the common heteroskedastic sigma2</span></span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>  aux <span class="ot">=</span> <span class="fu">SVcommonSF.Gibbs.iteration</span>(aux,SVprior)</span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>  sigma2 <span class="ot">=</span> aux<span class="sc">$</span>sigma2</span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 3a: compute posterior parameters for B0, B_+</span></span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a>  Omega.inv      <span class="ot">=</span> <span class="fu">solve</span>(struct<span class="sc">$</span>kappap[i] <span class="sc">*</span> priors<span class="sc">$</span>Omega)</span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a>  Omega.post.inv <span class="ot">=</span> usedata<span class="sc">$</span>X<span class="sc">%*%</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>sigma2) <span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>X) <span class="sc">+</span> Omega.inv</span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a>  Omega.post     <span class="ot">=</span> <span class="fu">solve</span>(Omega.post.inv)</span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a>  B.post         <span class="ot">=</span> (usedata<span class="sc">$</span>Y<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>sigma2) <span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>X) <span class="sc">+</span> priors<span class="sc">$</span>B<span class="sc">%*%</span>Omega.inv) <span class="sc">%*%</span> Omega.post</span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a>  S.inv.post     <span class="ot">=</span> usedata<span class="sc">$</span>Y<span class="sc">%*%</span><span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span>sigma2) <span class="sc">%*%</span><span class="fu">t</span>(usedata<span class="sc">$</span>Y) <span class="sc">+</span> <span class="fu">solve</span>(struct<span class="sc">$</span>kappa0[i] <span class="sc">*</span> priors<span class="sc">$</span>S) <span class="sc">+</span> priors<span class="sc">$</span>B<span class="sc">%*%</span>Omega.inv<span class="sc">%*%</span><span class="fu">t</span>(priors<span class="sc">$</span>B) <span class="sc">-</span> B.post<span class="sc">%*%</span>Omega.post.inv<span class="sc">%*%</span><span class="fu">t</span>(B.post)</span>
<span id="cb52-52"><a href="#cb52-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-53"><a href="#cb52-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Step 3b: draw non-normalised B0 and B_+</span></span>
<span id="cb52-54"><a href="#cb52-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-55"><a href="#cb52-55" aria-hidden="true" tabindex="-1"></a>  B0.i <span class="ot">=</span> <span class="fu">rgn</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">S.inv =</span> S.inv.post, <span class="at">nu =</span> nu.post, <span class="at">V =</span> B0Vlist.initial<span class="sc">$</span>V, <span class="at">B0.initial =</span> B0.post)</span>
<span id="cb52-56"><a href="#cb52-56" aria-hidden="true" tabindex="-1"></a>  Bp.i <span class="ot">=</span> <span class="fu">rnorm.ngn</span>(B0.i, B.post, Omega.post)</span>
<span id="cb52-57"><a href="#cb52-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-58"><a href="#cb52-58" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>B0.posterior[,,i] <span class="ot">=</span> B0.i</span>
<span id="cb52-59"><a href="#cb52-59" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>Bp.posterior[,,i] <span class="ot">=</span> Bp.i</span>
<span id="cb52-60"><a href="#cb52-60" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-61"><a href="#cb52-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-62"><a href="#cb52-62" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Discard the burn-in results</span></span>
<span id="cb52-63"><a href="#cb52-63" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>kappa0 <span class="ot">=</span> struct<span class="sc">$</span>kappa0[(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb52-64"><a href="#cb52-64" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>kappap <span class="ot">=</span> struct<span class="sc">$</span>kappap[(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb52-65"><a href="#cb52-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-66"><a href="#cb52-66" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>B0.posterior <span class="ot">=</span> struct<span class="sc">$</span>B0.posterior[,,(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb52-67"><a href="#cb52-67" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>Bp.posterior <span class="ot">=</span> struct<span class="sc">$</span>Bp.posterior[,,(parameters<span class="sc">$</span>S.burnin<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(parameters<span class="sc">$</span>S.burnin <span class="sc">+</span> parameters<span class="sc">$</span>S)]</span>
<span id="cb52-68"><a href="#cb52-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-69"><a href="#cb52-69" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set normalising matrix</span></span>
<span id="cb52-70"><a href="#cb52-70" aria-hidden="true" tabindex="-1"></a>  B0.last_draw <span class="ot">=</span> struct<span class="sc">$</span>B0.posterior[,,parameters<span class="sc">$</span>S]</span>
<span id="cb52-71"><a href="#cb52-71" aria-hidden="true" tabindex="-1"></a>  B0_hat <span class="ot">=</span> <span class="fu">diag</span>(<span class="fu">sign</span>(<span class="fu">diag</span>(B0.last_draw))) <span class="sc">%*%</span> B0.last_draw</span>
<span id="cb52-72"><a href="#cb52-72" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-73"><a href="#cb52-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute normalised B0</span></span>
<span id="cb52-74"><a href="#cb52-74" aria-hidden="true" tabindex="-1"></a>  B0.norm <span class="ot">=</span> <span class="fu">normalize.Gibbs.output.parallel</span>(struct<span class="sc">$</span>B0.posterior, B0_hat)</span>
<span id="cb52-75"><a href="#cb52-75" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-76"><a href="#cb52-76" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compute normalised BP</span></span>
<span id="cb52-77"><a href="#cb52-77" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>parameters<span class="sc">$</span>S){</span>
<span id="cb52-78"><a href="#cb52-78" aria-hidden="true" tabindex="-1"></a>    struct<span class="sc">$</span>Bp.posterior[,,i] <span class="ot">=</span> B0.norm[,,i] <span class="sc">%*%</span> <span class="fu">solve</span>(struct<span class="sc">$</span>B0.posterior[,,i]) <span class="sc">%*%</span> struct<span class="sc">$</span>Bp.posterior[,,i]</span>
<span id="cb52-79"><a href="#cb52-79" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb52-80"><a href="#cb52-80" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-81"><a href="#cb52-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Save normalised B0</span></span>
<span id="cb52-82"><a href="#cb52-82" aria-hidden="true" tabindex="-1"></a>  struct<span class="sc">$</span>B0.posterior <span class="ot">=</span> B0.norm</span>
<span id="cb52-83"><a href="#cb52-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(struct)</span>
<span id="cb52-84"><a href="#cb52-84" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-85"><a href="#cb52-85" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-results-3" class="level3">
<h3 class="anchored" data-anchor-id="data-results-3">Data Results</h3>
<p><strong><em>Step 1:</em></strong> The following code computes the prior, initialises matrices to store results, and samples the draws for the actual data.</p>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p><strong><em>Step 2:</em></strong> The following code computes and stores the posterior means of <span class="math inline">\(\{\kappa_0^{(s)}, \kappa_+^{(s)}, B_0^{(s)}, B_+^{(s)}\}_{s =1}^{S}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>ext3.struct.means <span class="ot">=</span> <span class="fu">structPosteriorMeans</span>(ext3.struct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong><em>Step 3:</em></strong> The code snippets below display the sample posterior means of the estimated objects using actual data.</p>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>ext3.data_B0 <span class="ot">=</span> <span class="fu">pmatrix</span>(ext3.struct.means<span class="sc">$</span>B0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccccccccc}
0.5823611 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.00000\\
-0.0180063 &amp; 10.9522165 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.00000\\
-0.0002969 &amp; -14.5310230 &amp; 13.8577332 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.00000\\
-0.0381754 &amp; -4.4947108 &amp; 3.3257862 &amp; 0.2948792 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.00000\\
0.1879166 &amp; 0.7736402 &amp; -0.5940286 &amp; -0.0476320 &amp; 0.5006034 &amp; 0.0000000 &amp; 0.0000000 &amp; 0.000000 &amp; 0.00000\\
-0.1895460 &amp; -2.0354190 &amp; 1.7853922 &amp; -0.0217214 &amp; 0.3356582 &amp; 6.2090215 &amp; 0.0000000 &amp; 0.000000 &amp; 0.00000\\
0.1307165 &amp; 2.0987027 &amp; -2.9794234 &amp; -0.0446472 &amp; -3.1844378 &amp; -0.3054704 &amp; 3.4140320 &amp; 0.000000 &amp; 0.00000\\
-0.0620510 &amp; 9.7670606 &amp; -5.7577762 &amp; -0.0249257 &amp; -0.1018675 &amp; -1.5088591 &amp; 0.1010540 &amp; 4.072628 &amp; 0.00000\\
-0.0231079 &amp; -1.7292859 &amp; -1.1856634 &amp; -0.1260452 &amp; -0.3162180 &amp; -3.2090627 &amp; 0.2410888 &amp; -0.663222 &amp; 11.13832\\
\end{array} \right)\, .
\end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>ext3.data_Bp <span class="ot">=</span> <span class="fu">pmatrix</span>(ext3.struct.means<span class="sc">$</span>Bp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
\left(
\begin{array}{ccccccccccccccccccccccccccccccccccccc}
0.0000473 &amp; 0.5819035 &amp; -0.0000898 &amp; 0.0002721 &amp; -0.0008776 &amp; 0.0000839 &amp; -0.0002470 &amp; -0.0002229 &amp; 0.0004714 &amp; 0.0003853 &amp; -0.0012357 &amp; -0.0001520 &amp; 0.0002044 &amp; 0.0001417 &amp; -0.0006046 &amp; -0.0003269 &amp; -0.0007165 &amp; 0.0004750 &amp; 0.0007465 &amp; -0.0032997 &amp; -0.0000942 &amp; 0.0001016 &amp; -0.0000724 &amp; -0.0004745 &amp; 0.0002454 &amp; -0.0008343 &amp; 0.0005156 &amp; 0.0007105 &amp; -0.0042996 &amp; -0.0000733 &amp; 0.0001222 &amp; 0.0005070 &amp; -0.0005230 &amp; 0.0002818 &amp; -0.0006285 &amp; 0.0005601 &amp; 0.0006233\\
0.0002879 &amp; -0.0163118 &amp; 10.9526226 &amp; 0.0001817 &amp; 0.0036114 &amp; 0.0014587 &amp; 0.0009472 &amp; 0.0018018 &amp; 0.0010182 &amp; 0.0005687 &amp; 0.0021601 &amp; 0.0005868 &amp; 0.0004061 &amp; -0.0044312 &amp; 0.0014935 &amp; 0.0011725 &amp; 0.0017627 &amp; 0.0007278 &amp; 0.0004480 &amp; -0.0021838 &amp; 0.0005056 &amp; 0.0004350 &amp; -0.0016261 &amp; -0.0000792 &amp; 0.0013877 &amp; 0.0009847 &amp; 0.0003851 &amp; 0.0004163 &amp; -0.0003229 &amp; 0.0006547 &amp; 0.0008417 &amp; -0.0009343 &amp; -0.0007030 &amp; 0.0010720 &amp; 0.0001360 &amp; 0.0002695 &amp; 0.0008103\\
-0.0001134 &amp; -0.0001229 &amp; -14.5318261 &amp; 13.8569808 &amp; -0.0011952 &amp; 0.0001937 &amp; -0.0012418 &amp; -0.0011270 &amp; -0.0002486 &amp; -0.0006643 &amp; -0.0002779 &amp; -0.0007175 &amp; -0.0005115 &amp; -0.0034934 &amp; 0.0006020 &amp; -0.0011619 &amp; -0.0008720 &amp; -0.0006406 &amp; -0.0008361 &amp; -0.0018379 &amp; -0.0004972 &amp; -0.0002683 &amp; 0.0022818 &amp; 0.0004092 &amp; -0.0014965 &amp; -0.0002979 &amp; -0.0008543 &amp; -0.0006342 &amp; -0.0008244 &amp; -0.0006315 &amp; -0.0004919 &amp; 0.0031894 &amp; 0.0014382 &amp; -0.0016836 &amp; 0.0008347 &amp; -0.0007224 &amp; -0.0007678\\
-0.0000967 &amp; -0.0370685 &amp; -4.4946094 &amp; 3.3257093 &amp; 0.2901747 &amp; 0.0003551 &amp; 0.0003068 &amp; 0.0002101 &amp; 0.0006158 &amp; -0.0002503 &amp; -0.0016009 &amp; -0.0001047 &amp; -0.0001700 &amp; -0.0023332 &amp; -0.0007094 &amp; 0.0003010 &amp; -0.0002893 &amp; 0.0001457 &amp; -0.0004353 &amp; -0.0000746 &amp; -0.0000384 &amp; -0.0001950 &amp; -0.0016596 &amp; -0.0005384 &amp; -0.0000640 &amp; -0.0001756 &amp; -0.0001376 &amp; -0.0004169 &amp; -0.0006422 &amp; 0.0001531 &amp; 0.0001138 &amp; -0.0015843 &amp; -0.0001122 &amp; 0.0000656 &amp; 0.0004243 &amp; -0.0005121 &amp; -0.0003246\\
0.0000866 &amp; 0.1883226 &amp; 0.7734930 &amp; -0.5940426 &amp; -0.0482910 &amp; 0.5011590 &amp; -0.0004500 &amp; -0.0005670 &amp; 0.0008017 &amp; 0.0003622 &amp; -0.0008023 &amp; -0.0000424 &amp; 0.0002968 &amp; -0.0007362 &amp; -0.0004342 &amp; -0.0003369 &amp; -0.0014351 &amp; 0.0005701 &amp; 0.0004657 &amp; -0.0020289 &amp; -0.0001424 &amp; 0.0001555 &amp; -0.0003763 &amp; -0.0012348 &amp; -0.0000968 &amp; -0.0020754 &amp; 0.0003417 &amp; 0.0003219 &amp; -0.0032221 &amp; -0.0000534 &amp; 0.0000803 &amp; 0.0004477 &amp; -0.0003544 &amp; -0.0002650 &amp; -0.0009463 &amp; 0.0000851 &amp; 0.0001664\\
0.0003219 &amp; -0.1900672 &amp; -2.0339231 &amp; 1.7865225 &amp; -0.0198788 &amp; 0.3340966 &amp; 6.2105101 &amp; -0.0001814 &amp; 0.0000211 &amp; 0.0007159 &amp; 0.0012983 &amp; 0.0012884 &amp; 0.0010517 &amp; -0.0007041 &amp; -0.0006789 &amp; 0.0015234 &amp; 0.0004396 &amp; 0.0000836 &amp; 0.0004880 &amp; 0.0031897 &amp; 0.0013009 &amp; 0.0010143 &amp; -0.0004349 &amp; -0.0009122 &amp; 0.0015933 &amp; 0.0003730 &amp; 0.0001222 &amp; 0.0003116 &amp; 0.0030695 &amp; 0.0013568 &amp; 0.0010378 &amp; -0.0007659 &amp; -0.0009316 &amp; 0.0014063 &amp; 0.0005571 &amp; 0.0000822 &amp; 0.0004391\\
0.0000778 &amp; 0.1304895 &amp; 2.0993104 &amp; -2.9789137 &amp; -0.0452291 &amp; -3.1841112 &amp; -0.3042989 &amp; 3.4142124 &amp; -0.0000721 &amp; 0.0003995 &amp; 0.0005404 &amp; 0.0007518 &amp; 0.0005311 &amp; -0.0004814 &amp; 0.0001109 &amp; 0.0009721 &amp; 0.0000022 &amp; 0.0001905 &amp; 0.0003942 &amp; 0.0022671 &amp; 0.0005755 &amp; 0.0006292 &amp; 0.0002499 &amp; 0.0009462 &amp; 0.0008216 &amp; 0.0010546 &amp; 0.0003724 &amp; 0.0004860 &amp; 0.0029828 &amp; 0.0005241 &amp; 0.0005296 &amp; 0.0001220 &amp; 0.0008046 &amp; 0.0010033 &amp; 0.0007237 &amp; 0.0003511 &amp; 0.0007030\\
0.0002788 &amp; -0.0638934 &amp; 9.7674282 &amp; -5.7575627 &amp; -0.0292385 &amp; -0.1033291 &amp; -1.5079585 &amp; 0.1004006 &amp; 4.0722142 &amp; 0.0002107 &amp; -0.0015136 &amp; 0.0006069 &amp; 0.0003871 &amp; -0.0007925 &amp; -0.0007284 &amp; 0.0007810 &amp; -0.0001518 &amp; -0.0011905 &amp; 0.0002039 &amp; 0.0004763 &amp; 0.0008920 &amp; 0.0009181 &amp; -0.0009357 &amp; 0.0002824 &amp; 0.0004239 &amp; 0.0010467 &amp; -0.0011090 &amp; 0.0002887 &amp; 0.0029099 &amp; 0.0008848 &amp; 0.0009068 &amp; 0.0026838 &amp; 0.0016959 &amp; 0.0003344 &amp; 0.0019841 &amp; -0.0008226 &amp; 0.0002046\\
0.0001573 &amp; -0.0265485 &amp; -1.7286463 &amp; -1.1853250 &amp; -0.1244460 &amp; -0.3176151 &amp; -3.2079750 &amp; 0.2396646 &amp; -0.6623632 &amp; 11.1386235 &amp; -0.0022746 &amp; 0.0004374 &amp; 0.0003866 &amp; 0.0001775 &amp; -0.0008317 &amp; 0.0009392 &amp; -0.0004865 &amp; 0.0007112 &amp; -0.0001093 &amp; -0.0018223 &amp; 0.0004625 &amp; 0.0004152 &amp; -0.0015188 &amp; 0.0001630 &amp; 0.0006610 &amp; 0.0004757 &amp; 0.0004523 &amp; -0.0000956 &amp; -0.0010717 &amp; 0.0004025 &amp; 0.0003419 &amp; 0.0012240 &amp; 0.0006039 &amp; 0.0007910 &amp; 0.0009191 &amp; 0.0001727 &amp; -0.0001384\\
\end{array} \right)\, .
\end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>ext3.data_kappa0 <span class="ot">=</span> <span class="fu">pmatrix</span>(ext3.struct.means<span class="sc">$</span>kappa0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
5123.96111738475 \end{equation*}\]</span></p>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>ext3.data_kappap <span class="ot">=</span> <span class="fu">pmatrix</span>(ext3.struct.means<span class="sc">$</span>kappap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span class="math display">\[\begin{equation*}
2.6055895621501e-06 \end{equation*}\]</span></p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/ext3 histogram of kappa draws-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="analysis-of-posteriors" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-posteriors">Analysis of Posteriors</h2>
<p>The following graph plots the histogram of posterior <span class="math inline">\((\kappa_0, \kappa_+)\)</span> draws for each of the model extensions implemented above.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/histogram of kappa draws all extensions-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Extension 3 posits the same priors as Extension 1, but is enriched by inclusion of common stochastic volatility component in the structural shocks. As a result, we see that the <span class="math inline">\(\kappa_0\)</span> draws become more positively skewed with even higher dispersion. However, the effect is reverse for the <span class="math inline">\(\kappa_+\)</span> draws. In extension 3, these draws are more dispersed and exhibit fatter tails.</p>
<p>Interestingly, the <span class="math inline">\(\kappa_+\)</span> draws under the <span class="math inline">\(\mathcal{IG}2\)</span> prior lead to posterior draws that exhibit a bell curve structure with much lower positive skewness that than in other extensions. Moreover, the mode is also around 3 orders of magnitude higher. Predictably such difference in draws lead to much different looking impulse response functions shown in the next section.</p>
</section>
</section>
<section id="empirical-investigation" class="level1">
<h1>Empirical Investigation</h1>
<p>In this section, I explore how the variables in my data respond to a domestic monetary policy shock (i.e.&nbsp;a 25 basis points cash rate shock) and a foreign monetary policy shock (i.e.&nbsp;a 25 basis points US Federal Funds Rate shock) using Impulse Response Function (IRF) graphs. I also plot the Forecast Error Variance Decomposition (FEVD) plots to illustrate what extent of the variability of my variables are explained by the structural shocks the model, and how these explainability evolves over time.</p>
<p>The <code>irf_fevd</code> function below computes and stores the posterior IRF and FEVD values for each variable and each shock. The implementation follows closely from <a href="https://github.com/donotdespair">Tomasz Woźniak</a>’s lecture notes.</p>
<div class="cell">
<details>
<summary>Code: Compute IRF/FEVD Function</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>irf_fevd <span class="ot">=</span> <span class="cf">function</span>(parameters, usedata, Bposteriors){</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Unpack variables</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> usedata<span class="sc">$</span>N</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  K <span class="ot">=</span> usedata<span class="sc">$</span>K</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">=</span> usedata<span class="sc">$</span>p</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  S <span class="ot">=</span> parameters<span class="sc">$</span>S</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">=</span> parameters<span class="sc">$</span>h</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  B0.posterior <span class="ot">=</span> Bposteriors<span class="sc">$</span>B0.posterior</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  Bp.posterior <span class="ot">=</span> Bposteriors<span class="sc">$</span>Bp.posterior</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  B.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  A.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,K,S))</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>  B                 <span class="ot">=</span> <span class="fu">solve</span>(B0.posterior[,,s])</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>  B.posterior[,,s]  <span class="ot">=</span> B</span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  A.posterior[,,s]  <span class="ot">=</span> B <span class="sc">%*%</span> Bp.posterior[,,s]</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>IRF.posterior       <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,h<span class="sc">+</span><span class="dv">1</span>,S))</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>IRF.inf.posterior   <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,S))</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>FEVD.posterior      <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>,<span class="fu">c</span>(N,N,h<span class="sc">+</span><span class="dv">1</span>,S))</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>J                   <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">diag</span>(N),<span class="fu">matrix</span>(<span class="dv">0</span>,N,N<span class="sc">*</span>(p<span class="dv">-1</span>)))</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>  A.bold          <span class="ot">=</span> <span class="fu">rbind</span>(A.posterior[,<span class="dv">2</span><span class="sc">:</span>(<span class="dv">1</span><span class="sc">+</span>N<span class="sc">*</span>p),s],<span class="fu">cbind</span>(<span class="fu">diag</span>(N<span class="sc">*</span>(p<span class="dv">-1</span>)),<span class="fu">matrix</span>(<span class="dv">0</span>,N<span class="sc">*</span>(p<span class="dv">-1</span>),N)))</span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>  IRF.inf.posterior[,,s]          <span class="ot">=</span> J <span class="sc">%*%</span> <span class="fu">solve</span>(<span class="fu">diag</span>(N<span class="sc">*</span>p)<span class="sc">-</span>A.bold) <span class="sc">%*%</span> <span class="fu">t</span>(J) <span class="sc">%*%</span> B.posterior[,,s]</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>  A.bold.power    <span class="ot">=</span> A.bold</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(h<span class="sc">+</span><span class="dv">1</span>)){</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>      IRF.posterior[,,i,s]        <span class="ot">=</span> B.posterior[,,s]</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a>      IRF.posterior[,,i,s]        <span class="ot">=</span> J <span class="sc">%*%</span> A.bold.power <span class="sc">%*%</span> <span class="fu">t</span>(J) <span class="sc">%*%</span> B.posterior[,,s]</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a>      A.bold.power                <span class="ot">=</span> A.bold.power <span class="sc">%*%</span> A.bold</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span> (nn <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a>        FEVD.posterior[n,nn,i,s]  <span class="ot">=</span> <span class="fu">sum</span>(IRF.posterior[n,nn,<span class="dv">1</span><span class="sc">:</span>i,s]<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-39"><a href="#cb58-39" aria-hidden="true" tabindex="-1"></a>    FEVD.posterior[,,i,s]         <span class="ot">=</span> <span class="fu">diag</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">apply</span>(FEVD.posterior[,,i,s],<span class="dv">1</span>,sum))<span class="sc">%*%</span>FEVD.posterior[,,i,s]</span>
<span id="cb58-40"><a href="#cb58-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a>FEVD.posterior    <span class="ot">=</span> <span class="dv">100</span><span class="sc">*</span>FEVD.posterior</span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">IRF.posterior =</span> IRF.posterior, <span class="at">IRF.inf.posterior=</span> IRF.inf.posterior, <span class="at">FEVD.posterior =</span> FEVD.posterior)</span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The next two subsections plot and explain the IRFs and selected FEVDs for the baseline and model extensions respectively.</p>
<section id="baseline-model-1" class="level2">
<h2 class="anchored" data-anchor-id="baseline-model-1">Baseline Model</h2>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<section id="impulse-response-functions-irfs" class="level3">
<h3 class="anchored" data-anchor-id="impulse-response-functions-irfs">Impulse Response Functions (IRFs)</h3>
<p>The <code>plot_irf</code> function plots the IRF of all variables given the position of the structural shock.</p>
<div class="cell">
<details>
<summary>Code: Plot IRF Function</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>plot_irf <span class="ot">=</span> <span class="cf">function</span>(position, fevd, parameters){</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Unpack results</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>IRF.posterior <span class="ot">=</span> fevd<span class="sc">$</span>IRF.posterior</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>IRF.posterior.mps <span class="ot">=</span> IRF.posterior[,position,,]</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>IRFs.k1           <span class="ot">=</span> <span class="fu">apply</span>(IRF.posterior.mps,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,median)</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>IRF.posterior.mps <span class="ot">=</span> IRF.posterior.mps<span class="sc">*</span>(<span class="fl">0.25</span><span class="sc">/</span>IRFs.k1[position,<span class="dv">1</span>])</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>IRFs.k1           <span class="ot">=</span> <span class="fu">apply</span>(IRF.posterior.mps,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,median)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>IRFs.inf.k1       <span class="ot">=</span> <span class="fu">apply</span>(IRF.posterior.mps,<span class="dv">1</span>,mean)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>var_names         <span class="ot">=</span> <span class="fu">colnames</span>(df)</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(IRFs.k1) <span class="ot">=</span> var_names</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>IRFs.k1.hdi       <span class="ot">=</span> <span class="fu">apply</span>(IRF.posterior.mps,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, hdi, <span class="at">credMass=</span><span class="fl">0.68</span>)</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>h                 <span class="ot">=</span> parameters<span class="sc">$</span>h</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>hh                <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span>(h<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Define colours</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>mcxs1  <span class="ot">=</span> <span class="st">"#05386B"</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>mcxs2  <span class="ot">=</span> <span class="st">"#379683"</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>mcxs3  <span class="ot">=</span> <span class="st">"#5CDB95"</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>mcxs4  <span class="ot">=</span> <span class="st">"#8EE4AF"</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>mcxs5  <span class="ot">=</span> <span class="st">"#EDF5E1"</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>purple <span class="ot">=</span> <span class="st">"#b02442"</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>mcxs1.rgb   <span class="ot">=</span> <span class="fu">col2rgb</span>(mcxs1)</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>mcxs1.shade1<span class="ot">=</span> <span class="fu">rgb</span>(mcxs1.rgb[<span class="dv">1</span>],mcxs1.rgb[<span class="dv">2</span>],mcxs1.rgb[<span class="dv">3</span>], <span class="at">alpha=</span><span class="dv">120</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>)</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>mcxs2.rgb   <span class="ot">=</span> <span class="fu">col2rgb</span>(mcxs2)</span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>mcxs2.shade1<span class="ot">=</span> <span class="fu">rgb</span>(mcxs2.rgb[<span class="dv">1</span>],mcxs2.rgb[<span class="dv">2</span>],mcxs2.rgb[<span class="dv">3</span>], <span class="at">alpha=</span><span class="dv">120</span>, <span class="at">maxColorValue=</span><span class="dv">255</span>)</span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Save as pdf</span></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>  ylims     <span class="ot">=</span> <span class="fu">range</span>(IRFs.k1[n,hh],IRFs.k1.hdi[,n,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],<span class="dv">0</span>)</span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">plot</span>(hh,IRFs.k1[n,hh], <span class="at">type=</span><span class="st">"l"</span>, <span class="at">ylim=</span>ylims, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">main=</span><span class="fu">rownames</span>(IRFs.k1)[n])</span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">1</span>,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">13</span>,<span class="dv">17</span>),<span class="fu">c</span>(<span class="st">""</span>,<span class="st">"1 quarter"</span>,<span class="st">"1 year"</span>,<span class="st">"6 quarters"</span>, <span class="st">"2 years"</span>, <span class="st">"3 years"</span>, <span class="st">"4 years"</span>))</span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">axis</span>(<span class="dv">2</span>,<span class="fu">c</span>(ylims[<span class="dv">1</span>],<span class="dv">0</span>,ylims[<span class="dv">2</span>]),<span class="fu">round</span>(<span class="fu">c</span>(ylims[<span class="dv">1</span>],<span class="dv">0</span>,ylims[<span class="dv">2</span>]),<span class="dv">3</span>))</span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(hh,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>), <span class="fu">c</span>(IRFs.k1.hdi[<span class="dv">1</span>,n,hh],IRFs.k1.hdi[<span class="dv">2</span>,n,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>]), <span class="at">col=</span>mcxs1.shade1,<span class="at">border=</span>mcxs1.shade1)</span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(hh, IRFs.k1[n,hh],<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span>mcxs1)</span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(p1))</span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Using the <code>plot_irf</code> function, we plot the IRFs given a 25 basis points shock to the Australian Cash Rate below:</p>
<div class="cell fig-cap-location-top">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>cashrate.irf <span class="ot">=</span> <span class="fu">plot_irf</span>(<span class="dv">5</span>, data.irf_fevd, parameters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cashrate.irf-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">IRF plots for the AU Cash Rate Shock</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The last row of plots contain housing variables. We can see that home loan rates move almost in line with the dynamics of the effect of positive domestic monetary policy shock on cash rate itself.</p>
<p>The number of new homes built increases slightly at the time of the shock but continuously decreases after that reaching a trough in about 1.5 years. It trends upwards after that point but at a much lower rate than at which it dropped.</p>
<p>The housing price index starts from zero and trends downwards in a concave fashion over time stabilising at a lower level. This implies that a positive monetary shock reduces the House Price Index but that the magnitude of the negative effect increases but stabilises over time.</p>
<p>Now, we plot the IRFs given a +25 basis points shock to the US federal funds rate.</p>
<div class="cell fig-cap-location-top">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>usffr.irf <span class="ot">=</span> <span class="fu">plot_irf</span>(<span class="dv">1</span>, data.irf_fevd, parameters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/usffr.irf-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">IRF plots for the US Federal Funds Rate Shock</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Here, we can see that a positive US Federal Funds rate shock affects the home loan rate in a similar way that it affects the RBA target cash rate. The impulse response for home loan rate starts at a small positive value and decreases very gradually over time.</p>
<p>A positive US Federal Funds rate shock decreases the quantity of new homes. The negative effect peaks within a year and then roughly remains constant thereafter.</p>
<p>And lastly, a positive US Federal Funds rate shock increases the house price index and that effect roughly stays the same over time.</p>
<div class="cell">

</div>
</section>
<section id="forecast-error-variance-decomposition" class="level3">
<h3 class="anchored" data-anchor-id="forecast-error-variance-decomposition">Forecast Error Variance Decomposition</h3>
<p>The <code>plot_fevd</code> function plots the FEVD for a chosen variable using the <code>FEVD.posterior</code> matrices computed by the <code>irf_fevd</code> function.</p>
<div class="cell">
<details>
<summary>Code: Plot FEVD Function</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>plot_fevd <span class="ot">=</span> <span class="cf">function</span>(position, fevd, parameters){</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  FEVD.posterior <span class="ot">=</span> fevd<span class="sc">$</span>FEVD.posterior</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">=</span> parameters<span class="sc">$</span>h</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">=</span> <span class="fu">dim</span>(FEVD.posterior)[<span class="dv">1</span>]</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  ffr.pos <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">colnames</span>(df) <span class="sc">==</span> <span class="st">"US FFR Max Target Rate"</span>)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  cr.pos <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">colnames</span>(df) <span class="sc">==</span> <span class="st">"RBA Target Cash Rate"</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  hh            <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span>(h<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>fevd.mat  <span class="ot">=</span> <span class="fu">apply</span>(FEVD.posterior[position,,,],<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,mean)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>fevd.mat  <span class="ot">=</span> <span class="fu">rbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,h<span class="sc">+</span><span class="dv">1</span>),<span class="fu">apply</span>(fevd.mat,<span class="dv">2</span>,cumsum))</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"deepskyblue1"</span>,<span class="st">"deepskyblue2"</span>,<span class="st">"deepskyblue"</span>,<span class="st">"deepskyblue3"</span>,<span class="st">"deepskyblue4"</span>,<span class="st">"dodgerblue"</span>,</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>           <span class="st">"maroon1"</span>,<span class="st">"maroon"</span>,<span class="st">"maroon2"</span>,<span class="st">"magenta"</span>,<span class="st">"maroon3"</span>,<span class="st">"maroon4"</span>)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">rep</span>(<span class="dv">4</span>,<span class="dv">4</span>),<span class="at">cex.axis=</span><span class="dv">1</span>, <span class="at">cex.lab=</span><span class="fl">0.8</span>)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">plot</span>(hh,fevd.mat[<span class="dv">1</span>,], <span class="at">type=</span><span class="st">"n"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">""</span>)</span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">13</span>,<span class="dv">17</span>),<span class="fu">c</span>(<span class="st">""</span>,<span class="st">"1 quarter"</span>,<span class="st">"1 year"</span>,<span class="st">"6 quarters"</span>, <span class="st">"2 years"</span>, <span class="st">"3 years"</span>, <span class="st">"4 years"</span>))</span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>,<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">100</span>),<span class="fu">c</span>(<span class="st">""</span>,<span class="fu">colnames</span>(df)[position],<span class="st">""</span>))</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(<span class="fu">c</span>(hh,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>), <span class="fu">c</span>(fevd.mat[n,hh],fevd.mat[n<span class="sc">+</span><span class="dv">1</span>,(h<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">1</span>]), <span class="at">col=</span>colors[n],<span class="at">border=</span>colors[n])</span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">4</span>, (<span class="fl">0.5</span><span class="sc">*</span>(fevd.mat[(<span class="dv">1</span><span class="sc">:</span>N),(h<span class="sc">+</span><span class="dv">1</span>)]<span class="sc">+</span>fevd.mat[<span class="dv">2</span><span class="sc">:</span>(N<span class="sc">+</span><span class="dv">1</span>),(h<span class="sc">+</span><span class="dv">1</span>)]))[<span class="fu">c</span>(ffr.pos,position,cr.pos)], <span class="fu">c</span>(<span class="st">"us.mps"</span>,<span class="st">""</span>,<span class="st">"au.mps"</span>)) <span class="co"># fix position of terms</span></span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(p1))</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for homeloan rates-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The FEVD graph above shows that the domestic monetary policy shock is very important in explaining the variability in home loan rates. Foreign monetary policy shocks roughly maintain the same level of explanability of the variation in home loan rates. It also indicates that an inflation shock would have an increasing explanatory power over time of home loan rates.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for quantity of new homes-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The FEVD graph above shows that both domestic and foreign monetary policy shock have a greater explanatory power on the variation of the quantity of new homes built over time. It indicates that the effects of these shocks have a long lasting effect and increasing effect on the quantity of homes built.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for house price index-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The FEVD graph above shows that both domestic and foreign monetary policy shock have little explanatory power over the variation in house price index at time <span class="math inline">\(t\)</span> but that this power increases over time. This also indicates that the effects of these shocks have a long lasting effect and increasing effect on house prices.</p>
</section>
</section>
<section id="extension-1-normal-gamma-hyperparameter-prior" class="level2">
<h2 class="anchored" data-anchor-id="extension-1-normal-gamma-hyperparameter-prior">Extension 1: Normal-Gamma Hyperparameter Prior</h2>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<section id="impulse-response-functions" class="level3">
<h3 class="anchored" data-anchor-id="impulse-response-functions">Impulse Response Functions</h3>
<p>For the extended model, using the <code>plot_irf</code> function, we plot the IRFs to a +25 basis points increase in the Australian Cash Rate.</p>
<div class="cell fig-cap-location-top">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/ext.cashrate.irf-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">IRF plots for the AU Cash Rate Shock, Extended Model</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The IRF results are different compared to the baseline results. The effect of a positive domestic monetary policy shock on home loan rates seems to be more persistent as the effect erodes away at a much lower rate.</p>
<p>The quantity of new homes built is the qualitatively the same as under the baseline specification, except for the absence of an initial boost in the number of houses built. Quantitatively, the negative effect on quantity of new homes is much lower under this specification.</p>
<p>House price index results are also qualitatively the same as under the baseline specification. However, the magnitude of the reduction in house prices due to a positive monetary policy shock is also lower than under the baseline specification.</p>
<p>For the extended model, using the <code>plot_irf</code> function, we plot the IRFs to a +25 basis points increase in the US Federal Funds Rate.</p>
<div class="cell fig-cap-location-top">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/ext.usffr.irf-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">IRF plots for the US Federal Funds Rate Shock, Extended Model</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The effect of a positive foreign monetary policy shock on home loan rates appears both qualitatively and quantitatively similar as under the baseline specification.</p>
<p>However, the effect of a positive foreign monetary policy shock on quantity of homes is different. There is an immediate positive increase in the number of new homes, but this effect linearly goes dissipates away returning to zero after around 3 years.</p>
<p>The effect on house price index is similar as under the baseline specification where a postive USFFR shock increases house price index slightly and keeps them at that level.</p>
</section>
<section id="forecast-error-variance-decomposition-1" class="level3">
<h3 class="anchored" data-anchor-id="forecast-error-variance-decomposition-1">Forecast Error Variance Decomposition</h3>
<p>In the figures below, we plot the FEVDs for our selected housing variables of interest.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for homeloan rates extended model-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The FEVD graph above shows that the domestic monetary policy shock carries the bulk of the explanatory power in the variability of home loan rates. Compared to the baseline model, the shocks on real economy variables (GDP, consumption) are even less important (and carry virtually no explanatory power) while the change in CPI also become less important.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for quantity of new homes extended model-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The FEVD graph above shows that while both domestic and foreign monetary policy have little explanatory power on the variability of the quantity of new homes built, the power increases over time. However, this increase in explanatory power is lower than in the baseline model. Moreover, shocks on the real economic indicators (GDP, consumption) are relatively more important while change in inflation is less important in explaining the variability of the quantity of new homes.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for house price index extended model-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Under the extended model specification, the domestic monetary policy shock appears less important, whereas the home loan rate shock becomes much more important in explaining the variability in house price index.</p>
</section>
</section>
<section id="extension-2-inverse-normal-gamma-2-prior" class="level2">
<h2 class="anchored" data-anchor-id="extension-2-inverse-normal-gamma-2-prior">Extension 2: Inverse Normal Gamma 2 Prior</h2>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<section id="impulse-response-functions-1" class="level3">
<h3 class="anchored" data-anchor-id="impulse-response-functions-1">Impulse Response Functions</h3>
<div class="cell fig-cap-location-top">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/ext.cashrate.irf 2-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">IRF plots for the AU Cash Rate Shock, Extended Model</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Some IRF results are different compared to the baseline results. The results also exhibit greater volatility which might be the result of the particular prior selection.</p>
<p>The effect of a positive domestic monetary policy shock on home loan rates seems to be more persistent as the effect erodes away at a much lower rate. This effect essentially mirrors the effect of a positive domestic monetary policy shock on itself.</p>
<p>The quantity of new homes built is the qualitatively the same as under the baseline specification, except for the absence of an initial boost in the number of houses built. Moreover, the quantity of new homes reverts back to its original levels by 14 quarters.</p>
<p>House price index results are also qualitatively the same as under the baseline specification. However, the magnitude of the reduction in house prices due to a positive monetary policy shock is higher than under the baseline specification but reverts back to a less lower level.</p>
<p>Moreover, a positive domestic monetary policy surprisingly seems to lower the money supply under this extension, which is not quite intuitive.</p>
<p>For the extended model, using the <code>plot_irf</code> function, we plot the IRFs to a +25 basis points increase in the US Federal Funds Rate.</p>
<div class="cell fig-cap-location-top">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/ext.usffr.irf 2-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">IRF plots for the US Federal Funds Rate Shock, Extended Model</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>These results qualitatively mirror the baseline results albeit exhibit greater volatility across periods.</p>
</section>
<section id="forecast-error-variance-decomposition-2" class="level3">
<h3 class="anchored" data-anchor-id="forecast-error-variance-decomposition-2">Forecast Error Variance Decomposition</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for homeloan rates extended model 2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The FEVD graph above shows that the domestic monetary policy shock carries the bulk of the explanatory power in the variability of home loan rates at the beginning but this power wanes over time. Compared to the baseline model, the shocks on real economy variables (GDP, consumption) become more important over time.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for quantity of new homes extended model 2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The FEVD graph above shows that while both domestic and foreign monetary policy have little explanatory power on the variability of the quantity of new homes built, the power increases over time. However, this increase in explanatory power is lower than in the baseline model. Moreover, shocks on the real economic indicators (GDP, consumption) and change in inflation are relatively more important in explaining the variability of the quantity of new homes.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for house price index extended model 2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The FEVD for House Price Index shows that domestic and foreign policy shock becomes more important in explaining the variability over time as does aggregate consumption.</p>
</section>
</section>
<section id="extension-3-normal-gamma-prior-with-stochastic-volatility" class="level2">
<h2 class="anchored" data-anchor-id="extension-3-normal-gamma-prior-with-stochastic-volatility">Extension 3: Normal Gamma Prior with Stochastic Volatility</h2>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<section id="impulse-response-functions-2" class="level3">
<h3 class="anchored" data-anchor-id="impulse-response-functions-2">Impulse Response Functions</h3>
<div class="cell fig-cap-location-top">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/ext.cashrate.irf 3-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">IRF plots for the AU Cash Rate Shock, Extension 3</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The IRF results here are mostly similar to those obtained in extension 1. One key change that occurs is that the effect of domestic monetary policy shock on US FFR is now positive, much in line with expectations.</p>
<p>For the extended model, using the <code>plot_irf</code> function, we plot the IRFs to a +25 basis points increase in the US Federal Funds Rate.</p>
<div class="cell fig-cap-location-top">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/ext.usffr.irf 3-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">IRF plots for the US Federal Funds Rate Shock, Extension 3</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Again, the IRF results here are mostly similar to those obtained in extension 1. One key change that occurs is that the effect of US monetary policy shock on Australian cash rate is initially negative but bounces back to being positive within the span of 4 quarters.</p>
</section>
<section id="forecast-error-variance-decomposition-3" class="level3">
<h3 class="anchored" data-anchor-id="forecast-error-variance-decomposition-3">Forecast Error Variance Decomposition</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for homeloan rates extended model 3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The FEVD graph above shows that the domestic monetary policy shock carries the bulk of the explanatory power in the variability of home loan rates, while foreign monetary policy shock is also important.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for quantity of new homes extended model 3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The FEVD graph above shows that while both domestic and foreign monetary policy have little explanatory power on the variability of the quantity of new homes built, the power increases over time. However, this increase in explanatory power is lower than in the baseline model. House Price Index is much more important in explaining the variability of the quantity of new homes.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for house price index extended model 3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The FEVD graph above shows that domestic and foreign monetary policy shocks have little explanatory power but become slightly more important over time in explaining the variability in housing prices.</p>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>In this paper, I investigate the effects of domestic and foreign monetary policy shocks on key indicators of the housing market i.e.&nbsp;the number of new houses built, home loan rates, and housing prices. I employ a structural VAR (SVAR) model, impose exclusion restrictions for identification, and use <span class="citation" data-cites="waggoner2003a">D. F. Waggoner and Zha (<a href="#ref-waggoner2003a" role="doc-biblioref">2003</a>)</span> method of sampling for structural parameters. Further, I enrich my baseline model by incorporating hyperparameter estimations using two different set of priors, and also by enriching common stochastic volatility of structural errors. In general, I find that a positive 25 basis point increase in the Australian Cash Rate reduces both the number of new houses and housing prices over the long run, while a positive foreign (US) monetary policy shock reduces the number of new houses but increases housing prices.</p>
</section>
<section id="appendix" class="level1">
<h1>Appendix</h1>
<div class="cell" data-file="L16 codes.R">

</div>
<section id="baseline-model-2" class="level2">
<h2 class="anchored" data-anchor-id="baseline-model-2">Baseline Model</h2>
<section id="forecast-error-variance-decomposition-fevd" class="level3">
<h3 class="anchored" data-anchor-id="forecast-error-variance-decomposition-fevd">Forecast Error Variance Decomposition (FEVD)</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for nominal gdp-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for consumption-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for change in cpi-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for usffr-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for cashrate-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for m1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">

</div>
</section>
<section id="extended-model-1" class="level3">
<h3 class="anchored" data-anchor-id="extended-model-1">Extended Model</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for nominal gdp, extended model-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for consumption, extended model-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for change in cpi, extended model-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for usffr, extended model-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for cashrate, extended model-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for m1, extended model-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">

</div>
</section>
<section id="extension-2" class="level3">
<h3 class="anchored" data-anchor-id="extension-2">Extension 2</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for nominal gdp extended model 2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for consumption extended model 2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for change in cpi extended model 2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for usffr extended model 2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for cashrate extended model 2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for m1 extended model 2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">

</div>
</section>
<section id="extension-3" class="level3">
<h3 class="anchored" data-anchor-id="extension-3">Extension 3</h3>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for nominal gdp extended model 3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for consumption extended model 3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for change in cpi extended model 3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for usffr extended model 3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for cashrate extended model 3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="index_files/figure-html/fevd for m1 extended model 3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">

</div>
</section>
</section>
<section id="code-snippets" class="level2">
<h2 class="anchored" data-anchor-id="code-snippets">Code Snippets</h2>
<div class="cell">
<details>
<summary>Code: Orthogonal Complement Matrix Function</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>orthogonal.complement.matrix.TW <span class="ot">=</span> <span class="cf">function</span>(x){</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x is a mxn matrix and m&gt;n</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the function returns a mx(m-n) matrix, out, that is an orthogonal complement of x, i.e.:</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># t(x)%*%out = 0 and det(cbind(x,out))!=0</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>( <span class="fu">dim</span>(x)[<span class="dv">1</span>] <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="fu">dim</span>(x)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">2</span>){</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">=</span> <span class="fu">t</span>(x)</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># x &lt;- ifelse(dim(x)[1] == 1 &amp;&amp; dim(x)[2] == 2, t(x), x)</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>  N     <span class="ot">=</span> <span class="fu">dim</span>(x)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  tmp   <span class="ot">=</span> <span class="fu">qr.Q</span>(<span class="fu">qr</span>(x, <span class="at">tol =</span> <span class="fl">1e-10</span>),<span class="at">complete=</span><span class="cn">TRUE</span>)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  out   <span class="ot">=</span> <span class="fu">as.matrix</span>(tmp[,(N[<span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N[<span class="dv">1</span>]])</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code: Sample from Conditional Generalised Normal Dist Function</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>r.conditional.generalized.normal <span class="ot">=</span> <span class="cf">function</span>(S.inv, nu, Vn, n, B0){</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># A function to sample a random draw from a conditional generalized normal distribution</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># of the unrestricted elements of the n-th row of matrix B0 </span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># given the parameters from the remaining rows of B0</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Depends on package mvtnorm</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># use: library(rmvtnorm)</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  rn            <span class="ot">=</span> <span class="fu">nrow</span>(Vn)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  Un            <span class="ot">=</span> <span class="fu">chol</span>(nu<span class="sc">*</span><span class="fu">solve</span>(Vn<span class="sc">%*%</span>S.inv<span class="sc">%*%</span><span class="fu">t</span>(Vn)))</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  w             <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">orthogonal.complement.matrix.TW</span>(<span class="fu">t</span>(B0[<span class="sc">-</span>n,])))</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>  w1            <span class="ot">=</span> w <span class="sc">%*%</span> <span class="fu">t</span>(Vn) <span class="sc">%*%</span> <span class="fu">t</span>(Un) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">as.numeric</span>(w <span class="sc">%*%</span> <span class="fu">t</span>(Vn) <span class="sc">%*%</span> <span class="fu">t</span>(Un) <span class="sc">%*%</span> Un <span class="sc">%*%</span> Vn <span class="sc">%*%</span> <span class="fu">t</span>(w)))</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (rn<span class="sc">&gt;</span><span class="dv">1</span>){</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>    Wn          <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">t</span>(w1),<span class="fu">orthogonal.complement.matrix.TW</span>(<span class="fu">t</span>(w1)))</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>    Wn          <span class="ot">=</span> w1</span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  alpha         <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>,rn)</span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  u             <span class="ot">=</span> <span class="fu">rmvnorm</span>(<span class="dv">1</span>,<span class="fu">rep</span>(<span class="dv">0</span>,nu<span class="sc">+</span><span class="dv">1</span>),(<span class="dv">1</span><span class="sc">/</span>nu)<span class="sc">*</span><span class="fu">diag</span>(nu<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>  alpha[<span class="dv">1</span>]      <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">as.numeric</span>(u<span class="sc">%*%</span><span class="fu">t</span>(u)))</span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">&lt;</span><span class="fl">0.5</span>){</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>    alpha[<span class="dv">1</span>]    <span class="ot">=</span> <span class="sc">-</span>alpha[<span class="dv">1</span>]</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (rn<span class="sc">&gt;</span><span class="dv">1</span>){</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>    alpha[<span class="dv">2</span><span class="sc">:</span>rn] <span class="ot">=</span> <span class="fu">rmvnorm</span>(<span class="dv">1</span>,<span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(Vn)<span class="sc">-</span><span class="dv">1</span>),(<span class="dv">1</span><span class="sc">/</span>nu)<span class="sc">*</span><span class="fu">diag</span>(rn<span class="dv">-1</span>))</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>  bn            <span class="ot">=</span> alpha <span class="sc">%*%</span> Wn <span class="sc">%*%</span> Un</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>  B0n           <span class="ot">=</span> bn <span class="sc">%*%</span> Vn</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>  output        <span class="ot">=</span> <span class="fu">list</span>(<span class="at">bn=</span>bn, <span class="at">B0n=</span>B0n)</span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code: Sample B0 Function</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>rgn             <span class="ot">=</span> <span class="cf">function</span>(n,S.inv,nu,V,B0.initial){</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This function simulates draws for the unrestricted elements </span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># of the conteporaneous relationships matrix of an SVAR model</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># from a generalized-normal distribution according to algorithm </span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># by Waggoner &amp; Zha (2003, JEDC)</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># n     - a positive integer, the number of draws to be sampled</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># S     - an NxN positive definite matrix, a parameter of the generalized-normal distribution</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nu    - a positive scalar, degrees of freedom parameter</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># V     - an N-element list, with fixed matrices</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B0.initial - an NxN matrix, of initial values of the parameters</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  N             <span class="ot">=</span> <span class="fu">nrow</span>(B0.initial)</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a>  no.draws      <span class="ot">=</span> n</span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>  B0            <span class="ot">=</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(N,N,no.draws))</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>  B0.aux        <span class="ot">=</span> B0.initial</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>no.draws){</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>      rn            <span class="ot">=</span> <span class="fu">nrow</span>(V[[n]])</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>      Un            <span class="ot">=</span> <span class="fu">chol</span>(nu<span class="sc">*</span><span class="fu">solve</span>(V[[n]]<span class="sc">%*%</span>S.inv<span class="sc">%*%</span><span class="fu">t</span>(V[[n]])))</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>      w             <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">orthogonal.complement.matrix.TW</span>(<span class="fu">t</span>(B0.aux[<span class="sc">-</span>n,])))</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>      w1            <span class="ot">=</span> w <span class="sc">%*%</span> <span class="fu">t</span>(V[[n]]) <span class="sc">%*%</span> <span class="fu">t</span>(Un) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">as.numeric</span>(w <span class="sc">%*%</span> <span class="fu">t</span>(V[[n]]) <span class="sc">%*%</span> <span class="fu">t</span>(Un) <span class="sc">%*%</span> Un <span class="sc">%*%</span> V[[n]] <span class="sc">%*%</span> <span class="fu">t</span>(w)))</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (rn<span class="sc">&gt;</span><span class="dv">1</span>){</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a>        Wn          <span class="ot">=</span> <span class="fu">cbind</span>(<span class="fu">t</span>(w1),<span class="fu">orthogonal.complement.matrix.TW</span>(<span class="fu">t</span>(w1)))</span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>        Wn          <span class="ot">=</span> w1</span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a>      alpha         <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>,rn)</span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>      u             <span class="ot">=</span> <span class="fu">rmvnorm</span>(<span class="dv">1</span>,<span class="fu">rep</span>(<span class="dv">0</span>,nu<span class="sc">+</span><span class="dv">1</span>),(<span class="dv">1</span><span class="sc">/</span>nu)<span class="sc">*</span><span class="fu">diag</span>(nu<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a>      alpha[<span class="dv">1</span>]      <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="fu">as.numeric</span>(u<span class="sc">%*%</span><span class="fu">t</span>(u)))</span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>)<span class="sc">&lt;</span><span class="fl">0.5</span>){</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a>        alpha[<span class="dv">1</span>]    <span class="ot">=</span> <span class="sc">-</span>alpha[<span class="dv">1</span>]</span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (rn<span class="sc">&gt;</span><span class="dv">1</span>){</span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>        alpha[<span class="dv">2</span><span class="sc">:</span>rn] <span class="ot">=</span> <span class="fu">rmvnorm</span>(<span class="dv">1</span>,<span class="fu">rep</span>(<span class="dv">0</span>,<span class="fu">nrow</span>(V[[n]])<span class="sc">-</span><span class="dv">1</span>),(<span class="dv">1</span><span class="sc">/</span>nu)<span class="sc">*</span><span class="fu">diag</span>(rn<span class="dv">-1</span>))</span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a>      bn            <span class="ot">=</span> alpha <span class="sc">%*%</span> Wn <span class="sc">%*%</span> Un</span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a>      B0.aux[n,]    <span class="ot">=</span> bn <span class="sc">%*%</span> V[[n]]</span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a>    B0[,,i]         <span class="ot">=</span> B0.aux</span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(B0)</span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code: Normalise B0 Function</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>normalization.wz2003  <span class="ot">=</span> <span class="cf">function</span>(B0,B0.hat.inv, Sigma.inv, diag.signs){</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This function normalizes a matrix of contemporaneous effects</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># according to the algorithm by Waggoner &amp; Zha (2003, JOE)</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B0        - an NxN matrix, to be normalized</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B0.hat    - an NxN matrix, a normalized matrix</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  N                 <span class="ot">=</span> <span class="fu">nrow</span>(B0)</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  K                 <span class="ot">=</span> <span class="dv">2</span><span class="sc">^</span>N</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  distance          <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>,K)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    B0.tmp.inv      <span class="ot">=</span> <span class="fu">solve</span>(<span class="fu">diag</span>(diag.signs[k,]) <span class="sc">%*%</span> B0)</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    distance[k]     <span class="ot">=</span> <span class="fu">sum</span>(</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">unlist</span>(</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>N,</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>               <span class="cf">function</span>(n){</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">t</span>(B0.tmp.inv <span class="sc">-</span> B0.hat.inv)[n,] <span class="sc">%*%</span>Sigma.inv <span class="sc">%*%</span> <span class="fu">t</span>(B0.tmp.inv <span class="sc">-</span> B0.hat.inv)[n,]</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>               }</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>        )))</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  B0.out            <span class="ot">=</span> <span class="fu">diag</span>(diag.signs[<span class="fu">which.min</span>(distance),]) <span class="sc">%*%</span> B0</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(B0.out)</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code: Normalise B0 Parallelised Function</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>normalize.Gibbs.output.parallel          <span class="ot">=</span> <span class="cf">function</span>(B0.posterior,B0.hat){</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This function normalizes the Gibbs sampler output from function rgn</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># using function normalization.wz2003 </span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B0.posterior  - a list, output from function rgn</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B0.hat        - an NxN matrix, a normalized matrix</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  N                 <span class="ot">=</span> <span class="fu">nrow</span>(B0.hat)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  K                 <span class="ot">=</span> <span class="dv">2</span><span class="sc">^</span>N</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  B0.hat.inv        <span class="ot">=</span> <span class="fu">solve</span>(B0.hat)</span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  Sigma.inv         <span class="ot">=</span> <span class="fu">t</span>(B0.hat)<span class="sc">%*%</span>B0.hat</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>  diag.signs        <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>,<span class="dv">2</span><span class="sc">^</span>N,N)</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a>    diag.signs[,n]  <span class="ot">=</span> <span class="fu">kronecker</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="sc">^</span>(n<span class="dv">-1</span>)))</span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a>  B0.posterior.n    <span class="ot">=</span> <span class="fu">mclapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(B0.posterior)[<span class="dv">3</span>],<span class="cf">function</span>(i){</span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">normalization.wz2003</span>(<span class="at">B0=</span>B0.posterior[,,i],B0.hat.inv, Sigma.inv, diag.signs)</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>  },<span class="at">mc.cores=</span><span class="dv">6</span></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a>  B0.posterior.n  <span class="ot">=</span> <span class="fu">simplify2array</span>(B0.posterior.n)</span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(B0.posterior.n)</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">

</div>
<div class="cell">
<details>
<summary>Code: Sample Bplus Function</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>rnorm.ngn       <span class="ot">=</span> <span class="cf">function</span>(B0.posterior,B,Omega){</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This function simulates draws for the multivariate normal distribution</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># of the autoregressive slope matrix of an SVAR model</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># from a normal-generalized-normal distribution according to algorithm </span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># by Waggoner &amp; Zha (2003, JEDC)</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B0.posterior  - a list, output from function rgn</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># B             - an NxK matrix, a parameter determining the mean of the multivariate conditionally normal distribution given B0</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Omega         - a KxK positive definite matrix, a covariance matrix of the multivariate normal distribution</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  N             <span class="ot">=</span> <span class="fu">nrow</span>(B)</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>  K             <span class="ot">=</span> <span class="fu">ncol</span>(B)</span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>  no.draws      <span class="ot">=</span> <span class="fu">dim</span>(B0.posterior)[<span class="dv">3</span>]</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>  L             <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">chol</span>(Omega))</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>  Bp.posterior  <span class="ot">=</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>no.draws,<span class="cf">function</span>(i){</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    Bp          <span class="ot">=</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, N, K)</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>      Bp[n,]    <span class="ot">=</span> <span class="fu">as.vector</span>(<span class="fu">t</span>(B0.posterior[n,,i] <span class="sc">%*%</span> B) <span class="sc">+</span> L<span class="sc">%*%</span><span class="fu">rnorm</span>(K))</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(Bp)</span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>  Bp.posterior  <span class="ot">=</span> <span class="fu">simplify2array</span>(Bp.posterior)</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Bp.posterior)</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="references" class="level1 unnumbered">




</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-AK_2017" class="csl-entry" role="doc-biblioentry">
Aliber, Robert Z., and Charles P. Kindleberger. 2017. <em>Manias, Panics, and Crashes: A History of Financial Crises, Seventh Edition</em>. Springer.
</div>
<div id="ref-arias2018a" class="csl-entry" role="doc-biblioentry">
Arias, Jonas E., Juan F. Rubio‐Ramírez, and Daniel Waggoner. 2018. <span>“Inference Based on Structural Vector Autoregressions Identified with Sign and Zero Restrictions: Theory and Applications.”</span> <em>Econometrica</em> 86 (2): 685–720. <a href="https://EconPapers.repec.org/RePEc:wly:emetrp:v:86:y:2018:i:2:p:685-720">https://EconPapers.repec.org/RePEc:wly:emetrp:v:86:y:2018:i:2:p:685-720</a>.
</div>
<div id="ref-rr2010" class="csl-entry" role="doc-biblioentry">
Rubio-Ramirez, Juan F, Daniel Waggoner, and Tao Zha. 2010. <span>“Structural Vector Autoregressions: Theory of Identification and Algorithms for Inference.”</span> <em>Review of Economic Studies</em> 77 (2): 665–96. <a href="https://EconPapers.repec.org/RePEc:oup:restud:v:77:y:2010:i:2:p:665-696">https://EconPapers.repec.org/RePEc:oup:restud:v:77:y:2010:i:2:p:665-696</a>.
</div>
<div id="ref-Sweeney_2023" class="csl-entry" role="doc-biblioentry">
Sweeney, Nila. 2023. <em>Australian Financial Review</em>, January. <a href="https://www.afr.com/property/residential/australia-s-9-3-trillion-housing-question-20230111-p5cbsu">https://www.afr.com/property/residential/australia-s-9-3-trillion-housing-question-20230111-p5cbsu</a>.
</div>
<div id="ref-waggoner2003a" class="csl-entry" role="doc-biblioentry">
Waggoner, Daniel F., and Tao Zha. 2003. <span>“A Gibbs Sampler for Structural Vector Autoregressions.”</span> <em>Journal of Economic Dynamics and Control</em> 28 (2): 349–66. https://doi.org/<a href="https://doi.org/10.1016/S0165-1889(02)00168-9">https://doi.org/10.1016/S0165-1889(02)00168-9</a>.
</div>
<div id="ref-waggoner2003b" class="csl-entry" role="doc-biblioentry">
Waggoner, Daniel, and Tao Zha. 2003. <span>“Likelihood Preserving Normalization in Multiple Equation Models.”</span> <em>Journal of Econometrics</em> 114 (2): 329–47. <a href="https://EconPapers.repec.org/RePEc:eee:econom:v:114:y:2003:i:2:p:329-347">https://EconPapers.repec.org/RePEc:eee:econom:v:114:y:2003:i:2:p:329-347</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>